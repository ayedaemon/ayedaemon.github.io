<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>LUKS Disk Encryption | Connected</title>
<meta name=keywords content="linux,cryptograpy,security"><meta name=description content="
Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption
"><meta name=author content="ayedaemon"><link rel=canonical href=https://ayedaemon.github.io/post/2020/12/luks-disk-encryption/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://ayedaemon.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ayedaemon.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ayedaemon.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ayedaemon.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ayedaemon.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="LUKS Disk Encryption"><meta property="og:description" content="
Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption
"><meta property="og:type" content="article"><meta property="og:url" content="https://ayedaemon.github.io/post/2020/12/luks-disk-encryption/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-12-19T13:15:55+05:30"><meta property="article:modified_time" content="2023-11-07T00:10:13+05:30"><meta property="og:site_name" content="Connected"><meta name=twitter:card content="summary"><meta name=twitter:title content="LUKS Disk Encryption"><meta name=twitter:description content="
Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ayedaemon.github.io/post/"},{"@type":"ListItem","position":2,"name":"LUKS Disk Encryption","item":"https://ayedaemon.github.io/post/2020/12/luks-disk-encryption/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"LUKS Disk Encryption","name":"LUKS Disk Encryption","description":" Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption\n","keywords":["linux","cryptograpy","security"],"articleBody":" Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption\ncryptsetup ‚Äî manage plain dm-crypt and LUKS encrypted volumes\ncryptsetup An encrypted blockdevice is protected by a key. A key is either:\na passphrase, or a keyfile What the..? Ok.. If you are new to encryption world, then it‚Äôs time to get a bit familiar data encryption.\nThere are 2 methods to encrypt your data:\nFilesystem stacked level encryption : Form of disk encryption where individual files or directories are encrypted by the file system itself. read more here Block device level encryption : The entire partition or disk, in which the file system resides, is encrypted. Before things go really technical and scary, let me show you how your data is stored in a harddisk.\nAbove diagram shows how your data is stored in a harddisk.\nYou create files (I am calling it data chunks) and insert your data in it. These files are stored in a very systematic and managed system called File System. Partitions are formatted to carry a file system on it. Harddisks are divided into Partitions. (Wanna know why? ‚Äî ask Leo!) Now when you know how your data is exactly stored in a harddisk. Let‚Äôs see how a Block device level encryption works.\nHere, a new layer is added in the usual thing.\nWe attach a harddisk to our system. Create partitions on it. Encrypt the complete partition (make it password protected) üîê Create filesystem (NTFS, EXT4, XFS, etc) on the encrypted partition. Write/save your data chunks. Just Do It now ‚úîÔ∏è Installing required tools I am using a RHEL based OS which uses yum/dnf package managers.\nyum install cryptsetup -y or dnf install -y cryptsetup Creating the partition lsblk - check the device name for the harddisk (sdb)\nfdisk - partitioning tool\nformating with luks cryptsetup -y -v luksFormat /dev/sdb1 - encrypt the partition\nlsblk -f - check the encrypted partition\ncryptsetup -v luksOpen /dev/sdb1 myencrypt - map the encrypted partition to ‚Äòmyencrypt‚Äô.\nlsblk -f - check it\ncreating a file system mkfs.xfs /dev/mapper/myencrypt - create a file system on top of the encrypted partition.\nlsblk -f - Check the layering and filesystem associated.\ncreating a mountpoint mkdir -p /mnt/my_encrypted_backup mount -v /dev/mapper/myencrypt /mnt/my_encrypted_backup/\nIf you face such issues - SELinux lables blah blah blah\nType this on magic terminal ‚Äî restorecon -vvRF /mnt/my_encrypted_backup/ - This will restore the SELinux context back to defaults for the destination directory.\nChecking luks dumps cryptsetup luksDump /dev/sdb1 Adding new key mkdir /etc/luks-keys/; dd if=/dev/random of=/etc/luks-keys/mybackup\\_key bs=32 count=1 cryptsetup luksAddKey /dev/sdb1 /etc/luks-keys/mybackup\\_key Checking the dumps again\nNow here are 2 slots available.\none with the initial key I entered at the time of setting it up. another, just in the above step. At this particular moment, there are few questions in my mind. You should know them too.\nIf you want to unmount and remove the harddisk. You‚Äôll have to follow the steps: umount /mountpoints/sdb cryptsetup luksClose myencrypt If you want to open the luks partition with keyfile instead of the passphrase. cryptsetup -v luksOpen /dev/sdb1 myencrypt --key-file=/etc/luks-keys/mybackup\\_key What if someone changes the content of the keyfile? Creating a new key\nAdd the key to the slots\nUse key\nSo the content inside the keyfile do matter; You can‚Äôt change it and expect things to work just fine for you.\nTime for some Automation Get the UUID of the encrypted partition\nAnd make the below entry in /etc/crypttab file. (Check the UUID for your device - Don‚Äôt copy mine!!)\nmyencrypt UUID=48a20857-6f26-4352-89d5-e778f2d98950 /etc/luks-keys/mybackup\\_key luks The above line is a combination of 4 fields:\nname of the mapped device. uuid of the encrypted partition keyfile to unlock the partiotion type of encryption used ‚Äî luks And then make below entry in /etc/fstab file.\n/dev/mapper/myencrypt /mountpoints/sdb xfs defaults 0 0 Want to learn more about crypttab and fstab\nLast step to verify if the above steps worked fine or not.\nRemount and verify (using mount command with ‚Äòa‚Äô and ‚Äòv‚Äô flags for clarity) Reboot the system and check if everything works after reboot. (Trust me, things betray sometimes after reboot) Want to read more about dm-crypt or device encryption?\n","wordCount":"691","inLanguage":"en","datePublished":"2020-12-19T13:15:55+05:30","dateModified":"2023-11-07T00:10:13+05:30","author":[{"@type":"Person","name":"ayedaemon"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://ayedaemon.github.io/post/2020/12/luks-disk-encryption/"},"publisher":{"@type":"Organization","name":"Connected","logo":{"@type":"ImageObject","url":"https://ayedaemon.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://ayedaemon.github.io/ accesskey=h title="Connected (Alt + H)">Connected</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://ayedaemon.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://ayedaemon.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://ayedaemon.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ayedaemon.github.io/series/ title=Series><span>Series</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ayedaemon.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://ayedaemon.github.io/post/>Posts</a></div><h1 class=post-title>LUKS Disk Encryption</h1><div class=post-meta><span title='2020-12-19 13:15:55 +0530 +0530'>December 19, 2020</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;691 words&nbsp;¬∑&nbsp;ayedaemon&nbsp;|&nbsp;<a href=https://github.com/ayedaemon/ayedaemon.github.io/tree/main/content/post/2020/12/LUKS-disk-encryption.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#what-the>What the..?</a></li><li><a href=#just-do-it-now->Just Do It now ‚úîÔ∏è</a></li><li><a href=#installing-required-tools>Installing required tools</a></li><li><a href=#creating-the-partition>Creating the partition</a></li><li><a href=#formating-with-luks>formating with luks</a></li><li><a href=#creating-a-file-system>creating a file system</a></li><li><a href=#creating-a-mountpoint>creating a mountpoint</a></li><li><a href=#checking-luks-dumps>Checking luks dumps</a></li><li><a href=#adding-new-key>Adding new key</a></li><li><a href=#time-for-some-automation>Time for some Automation</a></li></ul></li></ul></nav></div></details></div><div class=post-content><blockquote><p>Linux Unified Key Encryption‚Ää‚Äî‚ÄäDisk Encryption</p></blockquote><p><strong>cryptsetup</strong> ‚Äî <em>manage plain dm-crypt and LUKS encrypted volumes</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cryptsetup &lt;OPTIONS&gt; &lt;action&gt; &lt;action-specific-options&gt; &lt;device&gt; &lt;dmname&gt;
</span></span></code></pre></div><p>An encrypted blockdevice is protected by a key. A key is either:</p><ul><li>a passphrase, or</li><li>a keyfile</li></ul><h3 id=what-the>What the..?<a hidden class=anchor aria-hidden=true href=#what-the>#</a></h3><p>Ok.. If you are new to encryption world, then it‚Äôs time to get a bit familiar data encryption.</p><p>There are 2 methods to encrypt your data:</p><ul><li><strong>Filesystem stacked level encryption</strong> : Form of disk encryption where individual files or directories are encrypted by the file system itself. <a href=https://en.wikipedia.org/wiki/Filesystem-level_encryption>read more here</a></li><li><strong>Block device level encryption</strong> : The entire partition or disk, in which the file system resides, is encrypted.</li></ul><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*bg4VTXG8Lp6jq9aC.gif alt></p><p>Before things go really technical and scary, let me show you how your data is stored in a harddisk.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*2cy1Ut_NVLQof_vTZWoLAQ.png alt></p><p>Above diagram shows how your data is stored in a harddisk.</p><ul><li>You create files (I am calling it data chunks) and insert your data in it.</li><li>These files are stored in a very systematic and managed system called <strong>File System</strong>.</li><li>Partitions are formatted to carry a file system on it.</li><li>Harddisks are divided into Partitions. (<a href=https://askleo.com/should_i_partition_my_hard_disk/>Wanna know why? ‚Äî ask Leo!</a>)</li></ul><p>Now when you know how your data is exactly stored in a harddisk. Let‚Äôs see how a <strong>Block device level encryption</strong> works.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*2easqwhcymbcCSp6fHSZ6g.png alt></p><p>Here, a new layer is added in the usual thing.</p><ul><li>We attach a harddisk to our system.</li><li>Create partitions on it.</li><li>Encrypt the complete partition (make it password protected) üîê</li><li>Create filesystem (NTFS, EXT4, XFS, etc) on the encrypted partition.</li><li>Write/save your data chunks.</li></ul><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*rcPPu_6o2rOgW2bS.gif alt></p><hr><h3 id=just-do-it-now->Just Do It now ‚úîÔ∏è<a hidden class=anchor aria-hidden=true href=#just-do-it-now->#</a></h3><h3 id=installing-required-tools>Installing required tools<a hidden class=anchor aria-hidden=true href=#installing-required-tools>#</a></h3><p>I am using a RHEL based OS which uses yum/dnf package managers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>yum install cryptsetup -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>or
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>dnf install -y cryptsetup
</span></span></code></pre></div><h3 id=creating-the-partition>Creating the partition<a hidden class=anchor aria-hidden=true href=#creating-the-partition>#</a></h3><p><code>lsblk</code> - check the device name for the harddisk (sdb)</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*4c6x1UUNyksMWLCc-Yqyaw.png alt></p><p><code>fdisk</code> - partitioning tool</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*k_dPP7Hb4tGu7ARPeVLvOg.png alt>
<img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*LEOYgsQ-9juROPCikHX42g.png alt></p><h3 id=formating-with-luks>formating with luks<a hidden class=anchor aria-hidden=true href=#formating-with-luks>#</a></h3><p><code>cryptsetup -y -v luksFormat /dev/sdb1</code> - encrypt the partition</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*SETeIxieb0fOBPCuX7aHNg.png alt></p><p><code>lsblk -f</code> - check the encrypted partition</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*pBN1T2AcoQyo5B8FucJV2g.png alt></p><p><code>cryptsetup -v luksOpen /dev/sdb1 myencrypt</code> - map the encrypted partition to &lsquo;myencrypt&rsquo;.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*zcUCmHHyDkU9YpBL5Zg5ZQ.png alt></p><p><code>lsblk -f</code> - check it</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*5SKWOXd-lSX468LhgJNiZQ.png alt></p><h3 id=creating-a-file-system>creating a file system<a hidden class=anchor aria-hidden=true href=#creating-a-file-system>#</a></h3><p><code>mkfs.xfs /dev/mapper/myencrypt</code> - create a file system on top of the encrypted partition.</p><p><code>lsblk -f</code> - Check the layering and filesystem associated.</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*ch_byQVfsZexQP7O7O7dag.png alt></p><h3 id=creating-a-mountpoint>creating a mountpoint<a hidden class=anchor aria-hidden=true href=#creating-a-mountpoint>#</a></h3><p><code>mkdir -p /mnt/my_encrypted_backup mount -v /dev/mapper/myencrypt /mnt/my_encrypted_backup/</code></p><p><em>If you face such issues - SELinux lables blah blah blah</em></p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*GtzHhCp6CPR8YWBTOz-yqQ.png alt></p><p><em>Type this on magic terminal ‚Äî</em> <em>restorecon -vvRF /mnt/my_encrypted_backup/</em> <em>- This will restore the SELinux context back to defaults for the destination directory.</em></p><h3 id=checking-luks-dumps>Checking luks dumps<a hidden class=anchor aria-hidden=true href=#checking-luks-dumps>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cryptsetup luksDump /dev/sdb1
</span></span></code></pre></div><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*tWyJ8XLcwJuyRG-aUl8BZA.png alt></p><h3 id=adding-new-key>Adding new key<a hidden class=anchor aria-hidden=true href=#adding-new-key>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mkdir /etc/luks-keys/; dd if=/dev/random of=/etc/luks-keys/mybackup\_key bs=32 count=1
</span></span></code></pre></div><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*fE51gnVtgYGkSOeASgrzfQ.png alt></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cryptsetup luksAddKey /dev/sdb1 /etc/luks-keys/mybackup\_key
</span></span></code></pre></div><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*FBkoDsoqSHZ9AWw73ICg2Q.png alt></p><p>Checking the dumps again</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*7pWmoHcrHZmLXtGISkrCZQ.png alt></p><p>Now here are 2 slots available.</p><ul><li>one with the initial key I entered at the time of setting it up.</li><li>another, just in the above step.</li></ul><h4 id=at-this-particular-moment-there-are-few-questions-in-my-mind>At this particular moment, there are few questions in my mind.<a hidden class=anchor aria-hidden=true href=#at-this-particular-moment-there-are-few-questions-in-my-mind>#</a></h4><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/0*-Pngs8QCzMnlwKVv.gif alt></p><p>You should know them too.</p><ol><li>If you want to unmount and remove the harddisk. You‚Äôll have to follow the steps:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>umount /mountpoints/sdb cryptsetup luksClose myencrypt
</span></span></code></pre></div><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*6JplORU1iMFii5fwR4Reqg.png alt>
<img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*TZ8IkBpyRwkufkvyPkIT2g.png alt></p><ol start=2><li>If you want to open the luks partition with keyfile instead of the passphrase.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cryptsetup -v luksOpen /dev/sdb1 myencrypt --key-file=/etc/luks-keys/mybackup\_key
</span></span></code></pre></div><ol start=3><li>What if someone changes the content of the keyfile?</li></ol><p>Creating a new key</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*SuPXbF7MvbIufvP8qAikTw.png alt></p><p>Add the key to the slots</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*gJ41bDkh1J5UyNGIQjZJww.png alt></p><p>Use key</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*bykTB3_3rLa3w5AODyKA-w.png alt></p><p>So the content inside the keyfile do matter; You can‚Äôt change it and expect things to work just fine for you.</p><h3 id=time-for-some-automation>Time for some Automation<a hidden class=anchor aria-hidden=true href=#time-for-some-automation>#</a></h3><p>Get the UUID of the encrypted partition</p><p><img loading=lazy src=https://cdn-images-1.medium.com/max/800/1*wasZr_6cKCRIibLohoPJvQ.png alt></p><p>And make the below entry in <code>/etc/crypttab</code> file. (Check the UUID for your device - Don&rsquo;t copy mine!!)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>myencrypt    UUID=48a20857-6f26-4352-89d5-e778f2d98950     /etc/luks-keys/mybackup\_key    luks
</span></span></code></pre></div><p>The above line is a combination of 4 fields:</p><ul><li>name of the mapped device.</li><li>uuid of the encrypted partition</li><li>keyfile to unlock the partiotion</li><li>type of encryption used ‚Äî luks</li></ul><p>And then make below entry in <code>/etc/fstab</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/dev/mapper/myencrypt /mountpoints/sdb xfs defaults 0 0
</span></span></code></pre></div><p><em>Want to learn more about</em> <a href=https://linux.die.net/man/5/crypttab><em>crypttab</em></a> <em>and</em> <a href=https://linux.die.net/man/5/fstab><em>fstab</em></a></p><p>Last step to verify if the above steps worked fine or not.</p><ul><li>Remount and verify (using mount command with &lsquo;a&rsquo; and &lsquo;v&rsquo; flags for clarity)</li><li>Reboot the system and check if everything works after reboot. (Trust me, things betray sometimes after reboot)</li></ul><hr><p>Want to <a href=https://wiki.archlinux.org/index.php/Dm-crypt/Device_encryption>read more</a> about dm-crypt or device encryption?</p><hr><p><img loading=lazy src=https://miro.medium.com/max/480/0*IZmFYignS8jVnoSE.gif alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ayedaemon.github.io/tags/linux/>Linux</a></li><li><a href=https://ayedaemon.github.io/tags/cryptograpy/>cryptograpy</a></li><li><a href=https://ayedaemon.github.io/tags/security/>Security</a></li></ul><nav class=paginav><a class=prev href=https://ayedaemon.github.io/post/2020/12/advanced-intrusion-detection-environment/><span class=title>¬´ Next</span><br><span>Advanced Intrusion Detection Environment</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://ayedaemon.github.io/>Connected</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>