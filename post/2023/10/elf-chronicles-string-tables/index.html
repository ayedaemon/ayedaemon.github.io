<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Elf Chronicles: String Tables (4/?) | Connected</title>
<meta name=keywords content="C,ELF,RE"><meta name=description content="Exploring ELF string tables"><meta name=author content="ayedaemon"><link rel=canonical href=https://ayedaemon.github.io/post/2023/10/elf-chronicles-string-tables/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://ayedaemon.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ayedaemon.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ayedaemon.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ayedaemon.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ayedaemon.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Elf Chronicles: String Tables (4/?)"><meta property="og:description" content="Exploring ELF string tables"><meta property="og:type" content="article"><meta property="og:url" content="https://ayedaemon.github.io/post/2023/10/elf-chronicles-string-tables/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-10-29T15:12:36+05:30"><meta property="article:modified_time" content="2024-04-05T21:58:47+05:30"><meta property="og:see_also" content="https://ayedaemon.github.io/post/2024/04/elf-chronicles-plt-got/"><meta property="og:see_also" content="https://ayedaemon.github.io/post/2023/12/elf-chronicles-relocations/"><meta property="og:see_also" content="https://ayedaemon.github.io/post/2023/10/elf-chronicles-symbol-tables/"><meta property="og:see_also" content="https://ayedaemon.github.io/post/2023/10/elf-chronicles-program-headers/"><meta property="og:see_also" content="https://ayedaemon.github.io/post/2023/10/elf-chronicles-section-headers/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Elf Chronicles: String Tables (4/?)"><meta name=twitter:description content="Exploring ELF string tables"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ayedaemon.github.io/post/"},{"@type":"ListItem","position":2,"name":"Elf Chronicles: String Tables (4/?)","item":"https://ayedaemon.github.io/post/2023/10/elf-chronicles-string-tables/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Elf Chronicles: String Tables (4/?)","name":"Elf Chronicles: String Tables (4\/?)","description":"Exploring ELF string tables","keywords":["C","ELF","RE"],"articleBody":"In the article about section headers, you got an introduction to string tables. In this article, we will delve deeper into the topic.\n…prologue We’ll start with the same program we used in the previous article about section headers.\n/* file: hello_world.c */ #include // A macro #define HELLO_MSG1 \"Hello World1\" // A global variable char HELLO_MSG2[] = \"Hello World2\"; // main function int main() { // local variable for main char HELLO_MSG3[] = \"Hello World3\"; // Print messages printf(\"%s\\n\", HELLO_MSG1); printf(\"%s\\n\", HELLO_MSG2); printf(\"%s\\n\", HELLO_MSG3); return 0; } Compile this and then analyze the ELF executable file using readelf (Not everytime we’ll go with xxd).\n❯ readelf --file-header --wide hello_world ELF Header: Magic: 7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 Class: ELF64 Data: 2's complement, little endian Version: 1 (current) OS/ABI: UNIX - System V ABI Version: 0 Type: DYN (Position-Independent Executable file) Machine: Advanced Micro Devices X86-64 Version: 0x1 Entry point address: 0x1050 Start of program headers: 64 (bytes into file) Start of section headers: 13608 (bytes into file) Flags: 0x0 Size of this header: 64 (bytes) Size of program headers: 56 (bytes) Number of program headers: 13 Size of section headers: 64 (bytes) Number of section headers: 30 Section header string table index: 29 With the help of this, you can get the section header table of the file.\n#################### Explaination ########################### # # xxd \\ # -s \\ # Start of section headers: 13608 (bytes into file) # -l \\ # size_of_one_section_header(64) * total_count_of_section_headers(30) # -c \\ # Just to get a section header entry in a single line # \\ # ... duhh! # | nl -v0 - # I wanted to get the line numbers starting from 0. WHY 0?? - because that's where the array indexing starts ############################################################# ❯ xxd \\ -s 13608 \\ -l $(( 64*30 )) \\ -c 64 \\ hello_world \\ | nl -v0 - 0 00003528: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 ................................................................ 1 00003568: 1b00 0000 0100 0000 0200 0000 0000 0000 1803 0000 0000 0000 1803 0000 0000 0000 1c00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000 ................................................................ 2 000035a8: 2300 0000 0700 0000 0200 0000 0000 0000 3803 0000 0000 0000 3803 0000 0000 0000 4000 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 #...............8.......8.......@............................... 3 000035e8: 3600 0000 0700 0000 0200 0000 0000 0000 7803 0000 0000 0000 7803 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 6...............x.......x.......$............................... 4 00003628: 4900 0000 0700 0000 0200 0000 0000 0000 9c03 0000 0000 0000 9c03 0000 0000 0000 2000 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 I............................... ............................... 5 00003668: 5700 0000 f6ff ff6f 0200 0000 0000 0000 c003 0000 0000 0000 c003 0000 0000 0000 1c00 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 W......o........................................................ 6 000036a8: 6100 0000 0b00 0000 0200 0000 0000 0000 e003 0000 0000 0000 e003 0000 0000 0000 c000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 1800 0000 0000 0000 a............................................................... 7 000036e8: 6900 0000 0300 0000 0200 0000 0000 0000 a004 0000 0000 0000 a004 0000 0000 0000 a800 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000 i............................................................... 8 00003728: 7100 0000 ffff ff6f 0200 0000 0000 0000 4805 0000 0000 0000 4805 0000 0000 0000 1000 0000 0000 0000 0600 0000 0000 0000 0200 0000 0000 0000 0200 0000 0000 0000 q......o........H.......H....................................... 9 00003768: 7e00 0000 feff ff6f 0200 0000 0000 0000 5805 0000 0000 0000 5805 0000 0000 0000 4000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 0000 0000 0000 0000 ~......o........X.......X.......@............................... 10 000037a8: 8d00 0000 0400 0000 0200 0000 0000 0000 9805 0000 0000 0000 9805 0000 0000 0000 c000 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 1800 0000 0000 0000 ................................................................ 11 000037e8: 9700 0000 0400 0000 4200 0000 0000 0000 5806 0000 0000 0000 5806 0000 0000 0000 3000 0000 0000 0000 0600 0000 1700 0000 0800 0000 0000 0000 1800 0000 0000 0000 ........B.......X.......X.......0............................... 12 00003828: a100 0000 0100 0000 0600 0000 0000 0000 0010 0000 0000 0000 0010 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 ................................................................ 13 00003868: 9c00 0000 0100 0000 0600 0000 0000 0000 2010 0000 0000 0000 2010 0000 0000 0000 3000 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 1000 0000 0000 0000 ................ ....... .......0............................... 14 000038a8: a700 0000 0100 0000 0600 0000 0000 0000 5010 0000 0000 0000 5010 0000 0000 0000 7101 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 0000 0000 0000 0000 ................P.......P.......q............................... 15 000038e8: ad00 0000 0100 0000 0600 0000 0000 0000 c411 0000 0000 0000 c411 0000 0000 0000 0d00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 ................................................................ 16 00003928: b300 0000 0100 0000 0200 0000 0000 0000 0020 0000 0000 0000 0020 0000 0000 0000 1100 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 ................. ....... ...................................... 17 00003968: bb00 0000 0100 0000 0200 0000 0000 0000 1420 0000 0000 0000 1420 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000 ................. ....... ......$............................... 18 000039a8: c900 0000 0100 0000 0200 0000 0000 0000 3820 0000 0000 0000 3820 0000 0000 0000 7c00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 ................8 ......8 ......|............................... 19 000039e8: d300 0000 0e00 0000 0300 0000 0000 0000 d03d 0000 0000 0000 d02d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000 .................=.......-...................................... 20 00003a28: df00 0000 0f00 0000 0300 0000 0000 0000 d83d 0000 0000 0000 d82d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000 .................=.......-...................................... 21 00003a68: eb00 0000 0600 0000 0300 0000 0000 0000 e03d 0000 0000 0000 e02d 0000 0000 0000 e001 0000 0000 0000 0700 0000 0000 0000 0800 0000 0000 0000 1000 0000 0000 0000 .................=.......-...................................... 22 00003aa8: f400 0000 0100 0000 0300 0000 0000 0000 c03f 0000 0000 0000 c02f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000 .................?......./......(............................... 23 00003ae8: f900 0000 0100 0000 0300 0000 0000 0000 e83f 0000 0000 0000 e82f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000 .................?......./......(............................... 24 00003b28: 0201 0000 0100 0000 0300 0000 0000 0000 1040 0000 0000 0000 1030 0000 0000 0000 1d00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 .................@.......0...................................... 25 00003b68: 0801 0000 0800 0000 0300 0000 0000 0000 2d40 0000 0000 0000 2d30 0000 0000 0000 0300 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000 ................-@......-0...................................... 26 00003ba8: 0d01 0000 0100 0000 3000 0000 0000 0000 0000 0000 0000 0000 2d30 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0100 0000 0000 0000 ........0...............-0...................................... 27 00003be8: 0100 0000 0200 0000 0000 0000 0000 0000 0000 0000 0000 0000 4830 0000 0000 0000 7002 0000 0000 0000 1c00 0000 0600 0000 0800 0000 0000 0000 1800 0000 0000 0000 ........................H0......p............................... 28 00003c28: 0900 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 b832 0000 0000 0000 5301 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000 .........................2......S............................... 29 00003c68: 1100 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 0b34 0000 0000 0000 1601 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000 .........................4...................................... Now look back at the readelf output for this line\nSection header string table index: 29 This gives the index for the string table which contains the names of all of the sections… Remember, sh_name member of section headers did not contained the actual name for the section but a index to section table. This is that section table.\nOn further analyzing this section table entry, we can identify everything about this section.\nindex | offset | sh_name | sh_type | sh_flags | sh_addr | sh_offset | sh_size | sh_link | sh_info | sh_addralign | sh_entsize | 29 | 00003c68: | 1100 0000 | 0300 0000 | 0000 0000 0000 0000 | 0000 0000 0000 0000 | 0b34 0000 0000 0000 | 1601 0000 0000 0000 | 0000 0000 | 0000 0000 | 0100 0000 0000 0000 | 0000 0000 0000 0000 | Right now, interesting thing for us is the data that resides in this section. To get that, we need sh_offset and sh_size. (Keep in mind that these values are in little endian form)\n❯ xxd \\ -s 0x340b \\ # short for 0x000000000000340b (sh_offset) -l 0x116 \\ # short for 0x0000000000000116 (sh_size) hello_world 0000340b: 002e 7379 6d74 6162 002e 7374 7274 6162 ..symtab..strtab 0000341b: 002e 7368 7374 7274 6162 002e 696e 7465 ..shstrtab..inte 0000342b: 7270 002e 6e6f 7465 2e67 6e75 2e70 726f rp..note.gnu.pro 0000343b: 7065 7274 7900 2e6e 6f74 652e 676e 752e perty..note.gnu. 0000344b: 6275 696c 642d 6964 002e 6e6f 7465 2e41 build-id..note.A 0000345b: 4249 2d74 6167 002e 676e 752e 6861 7368 BI-tag..gnu.hash 0000346b: 002e 6479 6e73 796d 002e 6479 6e73 7472 ..dynsym..dynstr 0000347b: 002e 676e 752e 7665 7273 696f 6e00 2e67 ..gnu.version..g 0000348b: 6e75 2e76 6572 7369 6f6e 5f72 002e 7265 nu.version_r..re 0000349b: 6c61 2e64 796e 002e 7265 6c61 2e70 6c74 la.dyn..rela.plt 000034ab: 002e 696e 6974 002e 7465 7874 002e 6669 ..init..text..fi 000034bb: 6e69 002e 726f 6461 7461 002e 6568 5f66 ni..rodata..eh_f 000034cb: 7261 6d65 5f68 6472 002e 6568 5f66 7261 rame_hdr..eh_fra 000034db: 6d65 002e 696e 6974 5f61 7272 6179 002e me..init_array.. 000034eb: 6669 6e69 5f61 7272 6179 002e 6479 6e61 fini_array..dyna 000034fb: 6d69 6300 2e67 6f74 002e 676f 742e 706c mic..got..got.pl 0000350b: 7400 2e64 6174 6100 2e62 7373 002e 636f t..data..bss..co 0000351b: 6d6d 656e 7400 mment. ASCII representation of this section’s data chunk confirms that this must be the string table. (the one which contains the names of the sections). Now atleast we know how to walk through the headers and locate a string table section. This gives us a green signal to go deeper and learn more about string tables.\nString table So, here’s the deal: when you’ve got a bunch of characters, and you end them with a null character, that whole thing is what we call a “string.” (At least, that’s what I’ve learned, and I’m sticking with it for now.)\nNow, when it comes to a string table, it’s pretty simple. It’s just a bunch of these strings all lined up, one after the other. The only twist is that the first string is always null (just a null char - \\0 - a null string). Now you can put all that data in a section and create a section header for it with type - SHT_STRTAB(which is just 0x3 in fancy lingo). And voila, you’ve got yourself a proper string table, with a section header entry for it.\nIf you want to picture it, think of it like this - a string table is like a list of strings, where the first one is always an empty string.\n## Every 00 is a null char (in hex) # For Section=.shstrtab (Offset: 0x348b, Size: 278 = 0x116 in hex) ❯ xxd -s 0x340b -l 278 hello 0000348b: 002e 7379 6d74 6162 002e 7374 7274 6162 ..symtab..strtab 0000349b: 002e 7368 7374 7274 6162 002e 696e 7465 ..shstrtab..inte 000034ab: 7270 002e 6e6f 7465 2e67 6e75 2e70 726f rp..note.gnu.pro 000034bb: 7065 7274 7900 2e6e 6f74 652e 676e 752e perty..note.gnu. 000034cb: 6275 696c 642d 6964 002e 6e6f 7465 2e41 build-id..note.A 000034db: 4249 2d74 6167 002e 676e 752e 6861 7368 BI-tag..gnu.hash 000034eb: 002e 6479 6e73 796d 002e 6479 6e73 7472 ..dynsym..dynstr 000034fb: 002e 676e 752e 7665 7273 696f 6e00 2e67 ..gnu.version..g 0000350b: 6e75 2e76 6572 7369 6f6e 5f72 002e 7265 nu.version_r..re 0000351b: 6c61 2e64 796e 002e 7265 6c61 2e70 6c74 la.dyn..rela.plt 0000352b: 002e 696e 6974 002e 7465 7874 002e 6669 ..init..text..fi 0000353b: 6e69 002e 726f 6461 7461 002e 6568 5f66 ni..rodata..eh_f 0000354b: 7261 6d65 5f68 6472 002e 6568 5f66 7261 rame_hdr..eh_fra 0000355b: 6d65 002e 696e 6974 5f61 7272 6179 002e me..init_array.. 0000356b: 6669 6e69 5f61 7272 6179 002e 6479 6e61 fini_array..dyna 0000357b: 6d69 6300 2e67 6f74 002e 676f 742e 706c mic..got..got.pl 0000358b: 7400 2e64 6174 6100 2e62 7373 002e 636f t..data..bss..co 0000359b: 6d6d 656e 7400 mment. It should be pretty easy to write a parser for this, if not, ask your friend to do it for you. (hint: not me)\nNow, to proceed, let’s take a look at the C program that I’ll be using for further examples\n/* file: hello.c */ #include int global1; char global2 = 'x'; static int global3 = 9; static void print_globals(void) { printf(\"global1 = %d (%p) | global2 = %c (%p) | global3 = %d (%p)\\n\", global1, \u0026global1, global2, \u0026global2, global3, \u0026global3 ); } int main(){ int local1; char local2 = 'y'; static int local3 = 6; printf(\"Main: %p\\n\", \u0026main); print_globals(); printf(\"local1 = %d (%p) | local2 = %c (%p) | local3 = %d (%p)\\n\", local1, \u0026local1, local2, \u0026local2, local3, \u0026local3 ); return 0; } I assume you can compile it and create the ELF binary. After the ELF binary is ready, analyze it to extract the list of all sections with a type of 0x3 (feeling fancy - SHT_STRTAB). Feel free to use readelf, hexdump, xxd, or any tool you prefer – the output should be same, regardless of your choice.\nUsing my pretty parser, I found three entries.\n[ 07 ] Section Name: .dynstr Type: 0x3 Flags: 0x2 Addr: 0x4a0 Offset: 0x4a0 Size: 170 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 [ 28 ] Section Name: .strtab Type: 0x3 Flags: 0x0 Addr: 0x0 Offset: 0x3318 Size: 371 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 [ 29 ] Section Name: .shstrtab Type: 0x3 Flags: 0x0 Addr: 0x0 Offset: 0x348b Size: 278 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 Let’s examine them closely, one by one.\nNOTE: String tables consist exclusively of strings. This data doesn’t serve much purpose unless those strings are needed by other sections.\n1. .shstrtab This is the string table (the one which stores the names of all of the sections) - well we already talked about it so no point of repeating it, right?\nSo, Why are the section names stored in a separate dedicated section, rather than directly within each section’s sh_name member??\nAnswer: While I can’t say for certain, it’s possible that this design choice was made to accommodate variable-length section names. Storing the names in a separate section allows flexibility in the length of section names and avoids any size constraints related to the sh_name member.\nWhen I parse this with my parser, the data of this section appears like this – an offset in the section and the string stored at that offset.\n[ 29 ] Section Name: .shstrtab Type: 0x3 Flags: 0x0 Addr: 0x0 Offset: 0x348b Size: 278 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 [ 0 ] [ 1 ] .symtab [ 9 ] .strtab [ 17 ] .shstrtab [ 27 ] .interp [ 35 ] .note.gnu.property [ 54 ] .note.gnu.build-id [ 73 ] .note.ABI-tag [ 87 ] .gnu.hash [ 97 ] .dynsym [ 105 ] .dynstr [ 113 ] .gnu.version [ 126 ] .gnu.version_r [ 141 ] .rela.dyn [ 151 ] .rela.plt [ 161 ] .init [ 167 ] .text [ 173 ] .fini [ 179 ] .rodata [ 187 ] .eh_frame_hdr [ 201 ] .eh_frame [ 211 ] .init_array [ 223 ] .fini_array [ 235 ] .dynamic [ 244 ] .got [ 249 ] .got.plt [ 258 ] .data [ 264 ] .bss [ 269 ] .comment 2. .strtab This section contains strings (:P), mostly the ones representing names linked to symbol table entries (we’ll talk about symbol tables later). But at a quick glance, you can spot some of the names for variables and functions we used in our C program, such as global3, print_globals, main and so on.\nKeep in mind that this section does not hold strings which are used by programs like the ones used with printf function.\n[ 28 ] Section Name: .strtab Type: 0x3 Flags: 0x0 Addr: 0x0 Offset: 0x3318 Size: 371 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 [ 0 ] [ 1 ] hello.c [ 9 ] global3 [ 17 ] print_globals [ 31 ] local3.0 [ 40 ] _DYNAMIC [ 49 ] __GNU_EH_FRAME_HDR [ 68 ] _GLOBAL_OFFSET_TABLE_ [ 90 ] __libc_start_main@GLIBC_2.34 [ 119 ] _ITM_deregisterTMCloneTable [ 147 ] _edata [ 154 ] _fini [ 160 ] __stack_chk_fail@GLIBC_2.4 [ 187 ] printf@GLIBC_2.2.5 [ 206 ] global1 [ 214 ] __data_start [ 227 ] __gmon_start__ [ 242 ] __dso_handle [ 255 ] _IO_stdin_used [ 270 ] _end [ 275 ] __bss_start [ 287 ] main [ 292 ] __TMC_END__ [ 304 ] _ITM_registerTMCloneTable [ 330 ] __cxa_finalize@GLIBC_2.2.5 [ 357 ] _init [ 363 ] global2 3. .dynstr Similar to strtab, this section contains strings for symbol table entries, but these symbols come into play during runtime, often as part of dynamic linking. Because this section is used for dynamic linking, this needs to be loaded into memory for runtime use. You can confirm that with the sh_flags value for this section (should be 0x2 (or fancy, SHF_ALLOC))\nFor your satisfaction, here is the the output of readelf --segments hello, which indicates that this section is a part of the first LOAD segment\n❯ readelf --segments --wide hello Elf file type is DYN (Position-Independent Executable file) Entry point 0x1050 There are 13 program headers, starting at offset 64 Program Headers: Type Offset VirtAddr PhysAddr FileSiz MemSiz Flg Align 0 PHDR 0x000040 0x0000000000000040 0x0000000000000040 0x0002d8 0x0002d8 R 0x8 1 INTERP 0x000318 0x0000000000000318 0x0000000000000318 0x00001c 0x00001c R 0x1 [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2] 2 LOAD 0x000000 0x0000000000000000 0x0000000000000000 0x000690 0x000690 R 0x1000 3 LOAD 0x001000 0x0000000000001000 0x0000000000001000 0x00024d 0x00024d R E 0x1000 4 LOAD 0x002000 0x0000000000002000 0x0000000000002000 0x000154 0x000154 R 0x1000 5 LOAD 0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x00025c 0x000268 RW 0x1000 6 DYNAMIC 0x002de0 0x0000000000003de0 0x0000000000003de0 0x0001e0 0x0001e0 RW 0x8 7 NOTE 0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R 0x8 8 NOTE 0x000378 0x0000000000000378 0x0000000000000378 0x000044 0x000044 R 0x4 9 GNU_PROPERTY 0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R 0x8 10 GNU_EH_FRAME 0x002088 0x0000000000002088 0x0000000000002088 0x00002c 0x00002c R 0x4 11 GNU_STACK 0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW 0x10 12 GNU_RELRO 0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x000230 0x000230 R 0x1 Section to Segment mapping: Segment Sections... 00 01 .interp 02 .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt 03 .init .plt .text .fini 04 .rodata .eh_frame_hdr .eh_frame 05 .init_array .fini_array .dynamic .got .got.plt .data .bss 06 .dynamic 07 .note.gnu.property 08 .note.gnu.build-id .note.ABI-tag 09 .note.gnu.property 10 .eh_frame_hdr 11 12 .init_array .fini_array .dynamic .got But the section structure is still same as any other string table, so my cool parser parsed it.\n[ 07 ] Section Name: .dynstr Type: 0x3 Flags: 0x2 Addr: 0x4a0 Offset: 0x4a0 Size: 170 Link: 0 Info: 0x0 Addralign: 0x1 Entsize: 0 [ 0 ] [ 1 ] __cxa_finalize [ 16 ] __libc_start_main [ 34 ] __stack_chk_fail [ 51 ] printf [ 58 ] libc.so.6 [ 68 ] GLIBC_2.2.5 [ 80 ] GLIBC_2.4 [ 90 ] GLIBC_2.34 [ 101 ] _ITM_deregisterTMCloneTable [ 129 ] __gmon_start__ [ 144 ] _ITM_registerTMCloneTable Conclusion string tables in ELF files serve as repositories for various strings for section names, symbol names, and other dynamic linking data. The separation of string data into dedicated sections like “strtab” and “dynstr” allows for flexibility in string length and ensures that these essential strings are readily available during program execution.\nBefore closing this, I want you to run strip command against the ELF binary used in this article… Whatever happens will raise some good new questions for you to dig deeper (Some of those questions will be answered as we go forward with this series)\n","wordCount":"3423","inLanguage":"en","datePublished":"2023-10-29T15:12:36+05:30","dateModified":"2024-04-05T21:58:47+05:30","author":[{"@type":"Person","name":"ayedaemon"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://ayedaemon.github.io/post/2023/10/elf-chronicles-string-tables/"},"publisher":{"@type":"Organization","name":"Connected","logo":{"@type":"ImageObject","url":"https://ayedaemon.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://ayedaemon.github.io/ accesskey=h title="Connected (Alt + H)">Connected</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://ayedaemon.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://ayedaemon.github.io/series/ title=Series><span>Series</span></a></li><li><a href=https://ayedaemon.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://ayedaemon.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Elf Chronicles: String Tables (4/?)</h1><div class=post-description>Exploring ELF string tables</div><div class=post-meta><span title='2023-10-29 15:12:36 +0530 +0530'>October 29, 2023</span>&nbsp;·&nbsp;17 min&nbsp;·&nbsp;3423 words&nbsp;·&nbsp;ayedaemon&nbsp;|&nbsp;<a href=https://github.com/ayedaemon/ayedaemon.github.io/tree/main/content/post/2023/10/elf-chronicles-string-tables.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#prologue aria-label=&mldr;prologue>&mldr;prologue</a></li><li><a href=#string-table aria-label="String table">String table</a><ul><li><a href=#1-shstrtab aria-label="1. .shstrtab">1. .shstrtab</a></li><li><a href=#2-strtab aria-label="2. .strtab">2. .strtab</a></li><li><a href=#3-dynstr aria-label="3. .dynstr">3. .dynstr</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></div></details></div><div class=post-content><p>In the article about <a href=https://ayedaemon.github.io/post/2023/10/elf-chronicles-section-headers>section headers</a>, you got <a href=https://ayedaemon.github.io/post/2023/10/elf-chronicles-section-headers/#1-sh_name>an introduction to string tables</a>. In this article, we will delve deeper into the topic.</p><h2 id=prologue>&mldr;prologue<a hidden class=anchor aria-hidden=true href=#prologue>#</a></h2><p>We&rsquo;ll start with the same program we used in the previous article about section headers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* file: hello_world.c */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1>// A macro
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#define HELLO_MSG1 &#34;Hello World1&#34;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1>// A global variable
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>char</span> <span class=n>HELLO_MSG2</span><span class=p>[]</span> <span class=o>=</span> <span class=s>&#34;Hello World2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// main function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// local variable for main
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>char</span> <span class=n>HELLO_MSG3</span><span class=p>[]</span> <span class=o>=</span> <span class=s>&#34;Hello World3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Print messages
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>HELLO_MSG1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>HELLO_MSG2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>HELLO_MSG3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Compile this and then analyze the ELF executable file using <code>readelf</code> (Not everytime we&rsquo;ll go with <code>xxd</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>❯ readelf --file-header --wide hello_world
</span></span><span class=line><span class=cl>ELF Header:
</span></span><span class=line><span class=cl>  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
</span></span><span class=line><span class=cl>  Class:                             ELF64
</span></span><span class=line><span class=cl>  Data:                              2&#39;s complement, little endian
</span></span><span class=line><span class=cl>  Version:                           1 (current)
</span></span><span class=line><span class=cl>  OS/ABI:                            UNIX - System V
</span></span><span class=line><span class=cl>  ABI Version:                       0
</span></span><span class=line><span class=cl>  Type:                              DYN (Position-Independent Executable file)
</span></span><span class=line><span class=cl>  Machine:                           Advanced Micro Devices X86-64
</span></span><span class=line><span class=cl>  Version:                           0x1
</span></span><span class=line><span class=cl>  Entry point address:               0x1050
</span></span><span class=line><span class=cl>  Start of program headers:          64 (bytes into file)
</span></span><span class=line><span class=cl>  Start of section headers:          13608 (bytes into file)
</span></span><span class=line><span class=cl>  Flags:                             0x0
</span></span><span class=line><span class=cl>  Size of this header:               64 (bytes)
</span></span><span class=line><span class=cl>  Size of program headers:           56 (bytes)
</span></span><span class=line><span class=cl>  Number of program headers:         13
</span></span><span class=line><span class=cl>  Size of section headers:           64 (bytes)
</span></span><span class=line><span class=cl>  Number of section headers:         30
</span></span><span class=line><span class=cl>  Section header string table index: 29
</span></span></code></pre></div><p>With the help of this, you can get the <code>section header table</code> of the file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#################### Explaination ###########################
</span></span><span class=line><span class=cl>#
</span></span><span class=line><span class=cl># xxd \
</span></span><span class=line><span class=cl>#   -s &lt;start_of_section_headers&gt; \               # Start of section headers:   13608 (bytes into file)
</span></span><span class=line><span class=cl>#   -l &lt;total_size_of_all_section_headers&gt; \      # size_of_one_section_header(64) * total_count_of_section_headers(30)
</span></span><span class=line><span class=cl>#   -c &lt;bytes_to_print_in_a_single_line&gt;   \      # Just to get a section header entry in a single line
</span></span><span class=line><span class=cl>#   &lt;ELF_file&gt; \                                  #  ... duhh!
</span></span><span class=line><span class=cl>#   | nl -v0 -                                    # I wanted to get the line numbers starting from 0. WHY 0?? - because that&#39;s where the array indexing starts
</span></span><span class=line><span class=cl>#############################################################
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>❯ xxd \
</span></span><span class=line><span class=cl>    -s 13608 \
</span></span><span class=line><span class=cl>    -l $(( 64*30 )) \
</span></span><span class=line><span class=cl>    -c 64 \
</span></span><span class=line><span class=cl>    hello_world \
</span></span><span class=line><span class=cl>    | nl -v0 -
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 0  00003528: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class=line><span class=cl> 1  00003568: 1b00 0000 0100 0000 0200 0000 0000 0000 1803 0000 0000 0000 1803 0000 0000 0000 1c00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class=line><span class=cl> 2  000035a8: 2300 0000 0700 0000 0200 0000 0000 0000 3803 0000 0000 0000 3803 0000 0000 0000 4000 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  #...............8.......8.......@...............................
</span></span><span class=line><span class=cl> 3  000035e8: 3600 0000 0700 0000 0200 0000 0000 0000 7803 0000 0000 0000 7803 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  6...............x.......x.......$...............................
</span></span><span class=line><span class=cl> 4  00003628: 4900 0000 0700 0000 0200 0000 0000 0000 9c03 0000 0000 0000 9c03 0000 0000 0000 2000 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  I............................... ...............................
</span></span><span class=line><span class=cl> 5  00003668: 5700 0000 f6ff ff6f 0200 0000 0000 0000 c003 0000 0000 0000 c003 0000 0000 0000 1c00 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  W......o........................................................
</span></span><span class=line><span class=cl> 6  000036a8: 6100 0000 0b00 0000 0200 0000 0000 0000 e003 0000 0000 0000 e003 0000 0000 0000 c000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 1800 0000 0000 0000  a...............................................................
</span></span><span class=line><span class=cl> 7  000036e8: 6900 0000 0300 0000 0200 0000 0000 0000 a004 0000 0000 0000 a004 0000 0000 0000 a800 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  i...............................................................
</span></span><span class=line><span class=cl> 8  00003728: 7100 0000 ffff ff6f 0200 0000 0000 0000 4805 0000 0000 0000 4805 0000 0000 0000 1000 0000 0000 0000 0600 0000 0000 0000 0200 0000 0000 0000 0200 0000 0000 0000  q......o........H.......H.......................................
</span></span><span class=line><span class=cl> 9  00003768: 7e00 0000 feff ff6f 0200 0000 0000 0000 5805 0000 0000 0000 5805 0000 0000 0000 4000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 0000 0000 0000 0000  ~......o........X.......X.......@...............................
</span></span><span class=line><span class=cl>10  000037a8: 8d00 0000 0400 0000 0200 0000 0000 0000 9805 0000 0000 0000 9805 0000 0000 0000 c000 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 1800 0000 0000 0000  ................................................................
</span></span><span class=line><span class=cl>11  000037e8: 9700 0000 0400 0000 4200 0000 0000 0000 5806 0000 0000 0000 5806 0000 0000 0000 3000 0000 0000 0000 0600 0000 1700 0000 0800 0000 0000 0000 1800 0000 0000 0000  ........B.......X.......X.......0...............................
</span></span><span class=line><span class=cl>12  00003828: a100 0000 0100 0000 0600 0000 0000 0000 0010 0000 0000 0000 0010 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class=line><span class=cl>13  00003868: 9c00 0000 0100 0000 0600 0000 0000 0000 2010 0000 0000 0000 2010 0000 0000 0000 3000 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 1000 0000 0000 0000  ................ ....... .......0...............................
</span></span><span class=line><span class=cl>14  000038a8: a700 0000 0100 0000 0600 0000 0000 0000 5010 0000 0000 0000 5010 0000 0000 0000 7101 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 0000 0000 0000 0000  ................P.......P.......q...............................
</span></span><span class=line><span class=cl>15  000038e8: ad00 0000 0100 0000 0600 0000 0000 0000 c411 0000 0000 0000 c411 0000 0000 0000 0d00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class=line><span class=cl>16  00003928: b300 0000 0100 0000 0200 0000 0000 0000 0020 0000 0000 0000 0020 0000 0000 0000 1100 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................. ....... ......................................
</span></span><span class=line><span class=cl>17  00003968: bb00 0000 0100 0000 0200 0000 0000 0000 1420 0000 0000 0000 1420 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................. ....... ......$...............................
</span></span><span class=line><span class=cl>18  000039a8: c900 0000 0100 0000 0200 0000 0000 0000 3820 0000 0000 0000 3820 0000 0000 0000 7c00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  ................8 ......8 ......|...............................
</span></span><span class=line><span class=cl>19  000039e8: d300 0000 0e00 0000 0300 0000 0000 0000 d03d 0000 0000 0000 d02d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................=.......-......................................
</span></span><span class=line><span class=cl>20  00003a28: df00 0000 0f00 0000 0300 0000 0000 0000 d83d 0000 0000 0000 d82d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................=.......-......................................
</span></span><span class=line><span class=cl>21  00003a68: eb00 0000 0600 0000 0300 0000 0000 0000 e03d 0000 0000 0000 e02d 0000 0000 0000 e001 0000 0000 0000 0700 0000 0000 0000 0800 0000 0000 0000 1000 0000 0000 0000  .................=.......-......................................
</span></span><span class=line><span class=cl>22  00003aa8: f400 0000 0100 0000 0300 0000 0000 0000 c03f 0000 0000 0000 c02f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................?......./......(...............................
</span></span><span class=line><span class=cl>23  00003ae8: f900 0000 0100 0000 0300 0000 0000 0000 e83f 0000 0000 0000 e82f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................?......./......(...............................
</span></span><span class=line><span class=cl>24  00003b28: 0201 0000 0100 0000 0300 0000 0000 0000 1040 0000 0000 0000 1030 0000 0000 0000 1d00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  .................@.......0......................................
</span></span><span class=line><span class=cl>25  00003b68: 0801 0000 0800 0000 0300 0000 0000 0000 2d40 0000 0000 0000 2d30 0000 0000 0000 0300 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  ................-@......-0......................................
</span></span><span class=line><span class=cl>26  00003ba8: 0d01 0000 0100 0000 3000 0000 0000 0000 0000 0000 0000 0000 2d30 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0100 0000 0000 0000  ........0...............-0......................................
</span></span><span class=line><span class=cl>27  00003be8: 0100 0000 0200 0000 0000 0000 0000 0000 0000 0000 0000 0000 4830 0000 0000 0000 7002 0000 0000 0000 1c00 0000 0600 0000 0800 0000 0000 0000 1800 0000 0000 0000  ........................H0......p...............................
</span></span><span class=line><span class=cl>28  00003c28: 0900 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 b832 0000 0000 0000 5301 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  .........................2......S...............................
</span></span><span class=line><span class=cl>29  00003c68: 1100 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 0b34 0000 0000 0000 1601 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  .........................4......................................
</span></span></code></pre></div><p>Now look back at the <code>readelf</code> output for this line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Section header string table index: 29
</span></span></code></pre></div><p>This gives the index for the string table which contains the names of all of the sections&mldr; Remember, <code>sh_name</code> member of section headers did not contained the actual name for the section but a index to section table. This is that section table.</p><p>On further analyzing this section table entry, we can identify everything about this section.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>index |  offset   |  sh_name  |  sh_type  |        sh_flags     |        sh_addr      |       sh_offset     |       sh_size       |  sh_link  |  sh_info  |     sh_addralign    |       sh_entsize    |
</span></span><span class=line><span class=cl>29    | 00003c68: | 1100 0000 | 0300 0000 | 0000 0000 0000 0000 | 0000 0000 0000 0000 | 0b34 0000 0000 0000 | 1601 0000 0000 0000 | 0000 0000 | 0000 0000 | 0100 0000 0000 0000 | 0000 0000 0000 0000 |
</span></span></code></pre></div><p>Right now, interesting thing for us is the data that resides in this section. To get that, we need <code>sh_offset</code> and <code>sh_size</code>. <em>(Keep in mind that these values are in little endian form)</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>❯ xxd \
</span></span><span class=line><span class=cl>    -s 0x340b \     # short for 0x000000000000340b (sh_offset)
</span></span><span class=line><span class=cl>    -l 0x116 \      # short for 0x0000000000000116 (sh_size)
</span></span><span class=line><span class=cl>    hello_world
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0000340b: 002e 7379 6d74 6162 002e 7374 7274 6162  ..symtab..strtab
</span></span><span class=line><span class=cl>0000341b: 002e 7368 7374 7274 6162 002e 696e 7465  ..shstrtab..inte
</span></span><span class=line><span class=cl>0000342b: 7270 002e 6e6f 7465 2e67 6e75 2e70 726f  rp..note.gnu.pro
</span></span><span class=line><span class=cl>0000343b: 7065 7274 7900 2e6e 6f74 652e 676e 752e  perty..note.gnu.
</span></span><span class=line><span class=cl>0000344b: 6275 696c 642d 6964 002e 6e6f 7465 2e41  build-id..note.A
</span></span><span class=line><span class=cl>0000345b: 4249 2d74 6167 002e 676e 752e 6861 7368  BI-tag..gnu.hash
</span></span><span class=line><span class=cl>0000346b: 002e 6479 6e73 796d 002e 6479 6e73 7472  ..dynsym..dynstr
</span></span><span class=line><span class=cl>0000347b: 002e 676e 752e 7665 7273 696f 6e00 2e67  ..gnu.version..g
</span></span><span class=line><span class=cl>0000348b: 6e75 2e76 6572 7369 6f6e 5f72 002e 7265  nu.version_r..re
</span></span><span class=line><span class=cl>0000349b: 6c61 2e64 796e 002e 7265 6c61 2e70 6c74  la.dyn..rela.plt
</span></span><span class=line><span class=cl>000034ab: 002e 696e 6974 002e 7465 7874 002e 6669  ..init..text..fi
</span></span><span class=line><span class=cl>000034bb: 6e69 002e 726f 6461 7461 002e 6568 5f66  ni..rodata..eh_f
</span></span><span class=line><span class=cl>000034cb: 7261 6d65 5f68 6472 002e 6568 5f66 7261  rame_hdr..eh_fra
</span></span><span class=line><span class=cl>000034db: 6d65 002e 696e 6974 5f61 7272 6179 002e  me..init_array..
</span></span><span class=line><span class=cl>000034eb: 6669 6e69 5f61 7272 6179 002e 6479 6e61  fini_array..dyna
</span></span><span class=line><span class=cl>000034fb: 6d69 6300 2e67 6f74 002e 676f 742e 706c  mic..got..got.pl
</span></span><span class=line><span class=cl>0000350b: 7400 2e64 6174 6100 2e62 7373 002e 636f  t..data..bss..co
</span></span><span class=line><span class=cl>0000351b: 6d6d 656e 7400                           mment.
</span></span></code></pre></div><p>ASCII representation of this section&rsquo;s data chunk confirms that this must be <strong>the</strong> string table. (the one which contains the names of the sections). Now atleast we know how to walk through the headers and locate a string table section. This gives us a green signal to go deeper and learn more about string tables.</p><h2 id=string-table>String table<a hidden class=anchor aria-hidden=true href=#string-table>#</a></h2><p>So, here&rsquo;s the deal: when you&rsquo;ve got a bunch of characters, and you end them with a null character, that whole thing is what we call a &ldquo;string.&rdquo; (<em>At least, that&rsquo;s what I&rsquo;ve learned, and I&rsquo;m sticking with it for now.</em>)</p><p>Now, when it comes to a string table, it&rsquo;s pretty simple. It&rsquo;s just a bunch of these strings all lined up, one after the other. The only twist is that the first string is always null (just a null char - <code>\0</code> - a null string). Now you can put all that data in a section and create a section header for it with <strong>type</strong> - <code>SHT_STRTAB</code>(which is just <code>0x3</code> in fancy lingo). And voila, you&rsquo;ve got yourself a proper string table, with a section header entry for it.</p><p>If you want to picture it, think of it like this - a string table is like a list of strings, where the first one is always an empty string.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>## Every 00 is a null char (in hex)
</span></span><span class=line><span class=cl># For  Section=.shstrtab (Offset: 0x348b, Size: 278 = 0x116 in hex)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>❯ xxd -s 0x340b -l 278 hello
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0000348b: 002e 7379 6d74 6162 002e 7374 7274 6162  ..symtab..strtab
</span></span><span class=line><span class=cl>0000349b: 002e 7368 7374 7274 6162 002e 696e 7465  ..shstrtab..inte
</span></span><span class=line><span class=cl>000034ab: 7270 002e 6e6f 7465 2e67 6e75 2e70 726f  rp..note.gnu.pro
</span></span><span class=line><span class=cl>000034bb: 7065 7274 7900 2e6e 6f74 652e 676e 752e  perty..note.gnu.
</span></span><span class=line><span class=cl>000034cb: 6275 696c 642d 6964 002e 6e6f 7465 2e41  build-id..note.A
</span></span><span class=line><span class=cl>000034db: 4249 2d74 6167 002e 676e 752e 6861 7368  BI-tag..gnu.hash
</span></span><span class=line><span class=cl>000034eb: 002e 6479 6e73 796d 002e 6479 6e73 7472  ..dynsym..dynstr
</span></span><span class=line><span class=cl>000034fb: 002e 676e 752e 7665 7273 696f 6e00 2e67  ..gnu.version..g
</span></span><span class=line><span class=cl>0000350b: 6e75 2e76 6572 7369 6f6e 5f72 002e 7265  nu.version_r..re
</span></span><span class=line><span class=cl>0000351b: 6c61 2e64 796e 002e 7265 6c61 2e70 6c74  la.dyn..rela.plt
</span></span><span class=line><span class=cl>0000352b: 002e 696e 6974 002e 7465 7874 002e 6669  ..init..text..fi
</span></span><span class=line><span class=cl>0000353b: 6e69 002e 726f 6461 7461 002e 6568 5f66  ni..rodata..eh_f
</span></span><span class=line><span class=cl>0000354b: 7261 6d65 5f68 6472 002e 6568 5f66 7261  rame_hdr..eh_fra
</span></span><span class=line><span class=cl>0000355b: 6d65 002e 696e 6974 5f61 7272 6179 002e  me..init_array..
</span></span><span class=line><span class=cl>0000356b: 6669 6e69 5f61 7272 6179 002e 6479 6e61  fini_array..dyna
</span></span><span class=line><span class=cl>0000357b: 6d69 6300 2e67 6f74 002e 676f 742e 706c  mic..got..got.pl
</span></span><span class=line><span class=cl>0000358b: 7400 2e64 6174 6100 2e62 7373 002e 636f  t..data..bss..co
</span></span><span class=line><span class=cl>0000359b: 6d6d 656e 7400                           mment.
</span></span></code></pre></div><p>It should be pretty easy to write a parser for this, if not, ask your friend to do it for you. (hint: not me)</p><p>Now, to proceed, let&rsquo;s take a look at the C program that I&rsquo;ll be using for further examples</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>file: hello.c
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>global1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span> <span class=n>global2</span> <span class=o>=</span> <span class=sc>&#39;x&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=n>global3</span> <span class=o>=</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>void</span> <span class=nf>print_globals</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;global1 = %d (%p) | global2 = %c (%p) | global3 = %d (%p)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>global1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>global1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>global2</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>global2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>global3</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>global3</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>local1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>local2</span> <span class=o>=</span> <span class=sc>&#39;y&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=kt>int</span> <span class=n>local3</span> <span class=o>=</span> <span class=mi>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Main: %p</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>main</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>print_globals</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;local1 = %d (%p) | local2 = %c (%p) | local3 = %d (%p)</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>local1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>local1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>local2</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>local2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>local3</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>local3</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>I assume you can compile it and create the ELF binary. After the ELF binary is ready, analyze it to extract the list of all sections with a type of <code>0x3</code> (feeling fancy - <code>SHT_STRTAB</code>). Feel free to use <code>readelf</code>, <code>hexdump</code>, <code>xxd</code>, or any tool you prefer – the output should be same, regardless of your choice.</p><p>Using my pretty parser, I found three entries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[ 07 ] Section Name: .dynstr        Type: 0x3       Flags: 0x2      Addr: 0x4a0     Offset: 0x4a0           Size: 170       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class=line><span class=cl>[ 28 ] Section Name: .strtab        Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x3318          Size: 371       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class=line><span class=cl>[ 29 ] Section Name: .shstrtab      Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x348b          Size: 278       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span></code></pre></div><p>Let&rsquo;s examine them closely, one by one.</p><p><strong>NOTE</strong>: <em>String tables consist exclusively of strings. This data doesn&rsquo;t serve much purpose unless those strings are needed by other sections.</em></p><h3 id=1-shstrtab>1. <code>.shstrtab</code><a hidden class=anchor aria-hidden=true href=#1-shstrtab>#</a></h3><p>This is <em>the</em> string table (the one which stores the names of all of the sections) - <em>well we already talked about it so no point of repeating it, right?</em></p><p>So, Why are the section names stored in a separate dedicated section, rather than directly within each section&rsquo;s <code>sh_name</code> member??</p><p><strong>Answer</strong>: While I can&rsquo;t say for certain, it&rsquo;s possible that this design choice was made to accommodate variable-length section names. Storing the names in a separate section allows flexibility in the length of section names and avoids any size constraints related to the <code>sh_name</code> member.</p><p>When I parse this with my parser, the data of this section appears like this &ndash; an offset in the section and the string stored at that offset.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[ 29 ] Section Name: .shstrtab      Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x348b          Size: 278       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class=line><span class=cl>     [    0 ]
</span></span><span class=line><span class=cl>     [    1 ] .symtab
</span></span><span class=line><span class=cl>     [    9 ] .strtab
</span></span><span class=line><span class=cl>     [   17 ] .shstrtab
</span></span><span class=line><span class=cl>     [   27 ] .interp
</span></span><span class=line><span class=cl>     [   35 ] .note.gnu.property
</span></span><span class=line><span class=cl>     [   54 ] .note.gnu.build-id
</span></span><span class=line><span class=cl>     [   73 ] .note.ABI-tag
</span></span><span class=line><span class=cl>     [   87 ] .gnu.hash
</span></span><span class=line><span class=cl>     [   97 ] .dynsym
</span></span><span class=line><span class=cl>     [  105 ] .dynstr
</span></span><span class=line><span class=cl>     [  113 ] .gnu.version
</span></span><span class=line><span class=cl>     [  126 ] .gnu.version_r
</span></span><span class=line><span class=cl>     [  141 ] .rela.dyn
</span></span><span class=line><span class=cl>     [  151 ] .rela.plt
</span></span><span class=line><span class=cl>     [  161 ] .init
</span></span><span class=line><span class=cl>     [  167 ] .text
</span></span><span class=line><span class=cl>     [  173 ] .fini
</span></span><span class=line><span class=cl>     [  179 ] .rodata
</span></span><span class=line><span class=cl>     [  187 ] .eh_frame_hdr
</span></span><span class=line><span class=cl>     [  201 ] .eh_frame
</span></span><span class=line><span class=cl>     [  211 ] .init_array
</span></span><span class=line><span class=cl>     [  223 ] .fini_array
</span></span><span class=line><span class=cl>     [  235 ] .dynamic
</span></span><span class=line><span class=cl>     [  244 ] .got
</span></span><span class=line><span class=cl>     [  249 ] .got.plt
</span></span><span class=line><span class=cl>     [  258 ] .data
</span></span><span class=line><span class=cl>     [  264 ] .bss
</span></span><span class=line><span class=cl>     [  269 ] .comment
</span></span></code></pre></div><h3 id=2-strtab>2. <code>.strtab</code><a hidden class=anchor aria-hidden=true href=#2-strtab>#</a></h3><p>This section contains strings (:P), mostly the ones representing names linked to symbol table entries (we&rsquo;ll talk about symbol tables later). But at a quick glance, you can spot some of the names for <code>variables</code> and <code>functions</code> we used in our C program, such as <code>global3</code>, <code>print_globals</code>, <code>main</code> and so on.</p><p>Keep in mind that this section does not hold strings which are used by programs like the ones used with <code>printf</code> function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[ 28 ] Section Name: .strtab        Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x3318          Size: 371       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class=line><span class=cl>     [    0 ]
</span></span><span class=line><span class=cl>     [    1 ] hello.c
</span></span><span class=line><span class=cl>     [    9 ] global3
</span></span><span class=line><span class=cl>     [   17 ] print_globals
</span></span><span class=line><span class=cl>     [   31 ] local3.0
</span></span><span class=line><span class=cl>     [   40 ] _DYNAMIC
</span></span><span class=line><span class=cl>     [   49 ] __GNU_EH_FRAME_HDR
</span></span><span class=line><span class=cl>     [   68 ] _GLOBAL_OFFSET_TABLE_
</span></span><span class=line><span class=cl>     [   90 ] __libc_start_main@GLIBC_2.34
</span></span><span class=line><span class=cl>     [  119 ] _ITM_deregisterTMCloneTable
</span></span><span class=line><span class=cl>     [  147 ] _edata
</span></span><span class=line><span class=cl>     [  154 ] _fini
</span></span><span class=line><span class=cl>     [  160 ] __stack_chk_fail@GLIBC_2.4
</span></span><span class=line><span class=cl>     [  187 ] printf@GLIBC_2.2.5
</span></span><span class=line><span class=cl>     [  206 ] global1
</span></span><span class=line><span class=cl>     [  214 ] __data_start
</span></span><span class=line><span class=cl>     [  227 ] __gmon_start__
</span></span><span class=line><span class=cl>     [  242 ] __dso_handle
</span></span><span class=line><span class=cl>     [  255 ] _IO_stdin_used
</span></span><span class=line><span class=cl>     [  270 ] _end
</span></span><span class=line><span class=cl>     [  275 ] __bss_start
</span></span><span class=line><span class=cl>     [  287 ] main
</span></span><span class=line><span class=cl>     [  292 ] __TMC_END__
</span></span><span class=line><span class=cl>     [  304 ] _ITM_registerTMCloneTable
</span></span><span class=line><span class=cl>     [  330 ] __cxa_finalize@GLIBC_2.2.5
</span></span><span class=line><span class=cl>     [  357 ] _init
</span></span><span class=line><span class=cl>     [  363 ] global2
</span></span></code></pre></div><h3 id=3-dynstr>3. <code>.dynstr</code><a hidden class=anchor aria-hidden=true href=#3-dynstr>#</a></h3><p>Similar to <code>strtab</code>, this section contains strings for symbol table entries, but these symbols come into play during runtime, often as part of dynamic linking. Because this section is used for dynamic linking, this needs to be loaded into memory for runtime use. You can confirm that with the <code>sh_flags</code> value for this section (should be <code>0x2</code> (or fancy, <code>SHF_ALLOC</code>))</p><p>For your satisfaction, here is the the output of <code>readelf --segments hello</code>, which indicates that this section is a part of the first <code>LOAD</code> segment</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>❯ readelf --segments --wide hello
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Elf file type is DYN (Position-Independent Executable file)
</span></span><span class=line><span class=cl>Entry point 0x1050
</span></span><span class=line><span class=cl>There are 13 program headers, starting at offset 64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Program Headers:
</span></span><span class=line><span class=cl>  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
</span></span><span class=line><span class=cl>  0 PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0002d8 0x0002d8 R   0x8
</span></span><span class=line><span class=cl>  1 INTERP         0x000318 0x0000000000000318 0x0000000000000318 0x00001c 0x00001c R   0x1
</span></span><span class=line><span class=cl>      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]
</span></span><span class=line><span class=cl>  2 LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000690 0x000690 R   0x1000
</span></span><span class=line><span class=cl>  3 LOAD           0x001000 0x0000000000001000 0x0000000000001000 0x00024d 0x00024d R E 0x1000
</span></span><span class=line><span class=cl>  4 LOAD           0x002000 0x0000000000002000 0x0000000000002000 0x000154 0x000154 R   0x1000
</span></span><span class=line><span class=cl>  5 LOAD           0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x00025c 0x000268 RW  0x1000
</span></span><span class=line><span class=cl>  6 DYNAMIC        0x002de0 0x0000000000003de0 0x0000000000003de0 0x0001e0 0x0001e0 RW  0x8
</span></span><span class=line><span class=cl>  7 NOTE           0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R   0x8
</span></span><span class=line><span class=cl>  8 NOTE           0x000378 0x0000000000000378 0x0000000000000378 0x000044 0x000044 R   0x4
</span></span><span class=line><span class=cl>  9 GNU_PROPERTY   0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R   0x8
</span></span><span class=line><span class=cl> 10 GNU_EH_FRAME   0x002088 0x0000000000002088 0x0000000000002088 0x00002c 0x00002c R   0x4
</span></span><span class=line><span class=cl> 11 GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x10
</span></span><span class=line><span class=cl> 12 GNU_RELRO      0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x000230 0x000230 R   0x1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Section to Segment mapping:
</span></span><span class=line><span class=cl>  Segment Sections...
</span></span><span class=line><span class=cl>   00
</span></span><span class=line><span class=cl>   01     .interp
</span></span><span class=line><span class=cl>   02     .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt
</span></span><span class=line><span class=cl>   03     .init .plt .text .fini
</span></span><span class=line><span class=cl>   04     .rodata .eh_frame_hdr .eh_frame
</span></span><span class=line><span class=cl>   05     .init_array .fini_array .dynamic .got .got.plt .data .bss
</span></span><span class=line><span class=cl>   06     .dynamic
</span></span><span class=line><span class=cl>   07     .note.gnu.property
</span></span><span class=line><span class=cl>   08     .note.gnu.build-id .note.ABI-tag
</span></span><span class=line><span class=cl>   09     .note.gnu.property
</span></span><span class=line><span class=cl>   10     .eh_frame_hdr
</span></span><span class=line><span class=cl>   11
</span></span><span class=line><span class=cl>   12     .init_array .fini_array .dynamic .got
</span></span></code></pre></div><p>But the section structure is still same as any other string table, so my cool parser parsed it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> [ 07 ] Section Name: .dynstr       Type: 0x3       Flags: 0x2      Addr: 0x4a0     Offset: 0x4a0           Size: 170       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class=line><span class=cl>     [    0 ]
</span></span><span class=line><span class=cl>     [    1 ] __cxa_finalize
</span></span><span class=line><span class=cl>     [   16 ] __libc_start_main
</span></span><span class=line><span class=cl>     [   34 ] __stack_chk_fail
</span></span><span class=line><span class=cl>     [   51 ] printf
</span></span><span class=line><span class=cl>     [   58 ] libc.so.6
</span></span><span class=line><span class=cl>     [   68 ] GLIBC_2.2.5
</span></span><span class=line><span class=cl>     [   80 ] GLIBC_2.4
</span></span><span class=line><span class=cl>     [   90 ] GLIBC_2.34
</span></span><span class=line><span class=cl>     [  101 ] _ITM_deregisterTMCloneTable
</span></span><span class=line><span class=cl>     [  129 ] __gmon_start__
</span></span><span class=line><span class=cl>     [  144 ] _ITM_registerTMCloneTable
</span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>string tables in ELF files serve as repositories for various strings for section names, symbol names, and other dynamic linking data. The separation of string data into dedicated sections like &ldquo;strtab&rdquo; and &ldquo;dynstr&rdquo; allows for flexibility in string length and ensures that these essential strings are readily available during program execution.</p><p>Before closing this, I want you to run <code>strip</code> command against the ELF binary used in this article&mldr; Whatever happens will raise some good new questions for you to dig deeper (Some of those questions will be answered as we go forward with this series)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ayedaemon.github.io/tags/c/>C</a></li><li><a href=https://ayedaemon.github.io/tags/elf/>ELF</a></li><li><a href=https://ayedaemon.github.io/tags/re/>RE</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://ayedaemon.github.io/>Connected</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>