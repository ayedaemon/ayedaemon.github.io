<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>RE on Connected</title>
    <link>https://ayedaemon.github.io/tags/re/</link>
    <description>Recent content in RE on Connected</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 20 Oct 2023 15:21:49 +0530</lastBuildDate><atom:link href="https://ayedaemon.github.io/tags/re/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ELF Chronicles: Program Headers</title>
      <link>https://ayedaemon.github.io/post/2023/10/elf-chronicles-program-headers/</link>
      <pubDate>Fri, 20 Oct 2023 15:21:49 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/10/elf-chronicles-program-headers/</guid>
      <description>Exploring ELF program Headers</description>
      <content:encoded><![CDATA[<p>In preceding articles, we&rsquo;ve delved into the details of ELF file headers and section headers. Section headers provide insight into how data and instructions are organized based on their characteristics and grouped into distinct sections. These sections remain distinct due to variations in their types and permissions (<em>&hellip; and few other things</em>).</p>
<p>Up to this point, our focus has been on the aspects of the ELF file as it resides on-disk. However, we now turn our attention to what occurs when the file is loaded into memory. How is its arrangement handled? Are all the sections loaded into memory?</p>
<p>This is where the concept of program headers comes into play. Program headers are similar to section headers, but instead of section information, they store segment information. A segment encompasses one or more sections from the ELF file. While program headers hold little significance while the file is on disk, they become imperative when the file needs to be loaded and executed in memory, specifically in the case of executables and shared objects.</p>
<p>Some criteria for grouping sections to form segments can be:</p>
<ul>
<li>Type and purpose of the sections (like <code>.data</code> and <code>.bss</code>),</li>
<li>Memory Access Permissions and mapping,</li>
<li>Alignment and Layout,</li>
<li>Segment size constraints,</li>
<li>OS and platform requirements, etc</li>
</ul>
<p>For this article, I&rsquo;ll be using the same C code to generate an ELF file</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">File: hello_world.c
</span></span></span><span class="line"><span class="cl"><span class="cm">Compile: gcc hello_world.c -o hello_world
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A macro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define HELLO_MSG1 &#34;Hello World1&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A global variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span> <span class="n">HELLO_MSG2</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World2&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// local variable for main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">HELLO_MSG3</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Print messages
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Once you have the ELF file, you can get the program header related information from ELF file headers - <code>e_phoff</code>, <code>e_phentsize</code> and <code>e_phnum</code></p>
<p>I&rsquo;ll use readelf to get this information from the ELF headers. Feel free to use any method of your choice.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ELF Header:
</span></span><span class="line"><span class="cl">  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">  Class:                             ELF64
</span></span><span class="line"><span class="cl">  Data:                              2&#39;s complement, little endian
</span></span><span class="line"><span class="cl">  Version:                           1 (current)
</span></span><span class="line"><span class="cl">  OS/ABI:                            UNIX - System V
</span></span><span class="line"><span class="cl">  ABI Version:                       0
</span></span><span class="line"><span class="cl">  Type:                              DYN (Position-Independent Executable file)
</span></span><span class="line"><span class="cl">  Machine:                           Advanced Micro Devices X86-64
</span></span><span class="line"><span class="cl">  Version:                           0x1
</span></span><span class="line"><span class="cl">  Entry point address:               0x1040
</span></span><span class="line"><span class="cl">  Start of program headers:          64 (bytes into file)
</span></span><span class="line"><span class="cl">  Start of section headers:          13496 (bytes into file)
</span></span><span class="line"><span class="cl">  Flags:                             0x0
</span></span><span class="line"><span class="cl">  Size of this header:               64 (bytes)
</span></span><span class="line"><span class="cl">  Size of program headers:           56 (bytes)
</span></span><span class="line"><span class="cl">  Number of program headers:         13
</span></span><span class="line"><span class="cl">  Size of section headers:           64 (bytes)
</span></span><span class="line"><span class="cl">  Number of section headers:         30
</span></span><span class="line"><span class="cl">  Section header string table index: 29
</span></span></code></pre></div><p>From the the output above, we can deduce that</p>
<ul>
<li>the program headers are located at offset of <code>64</code> bytes,</li>
<li>each of these header entries is <code>56</code> bytes in size,</li>
<li>and in total, we&rsquo;ve got <code>13</code> entries</li>
</ul>
<p>Now we can use xxd to get the data out</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ xxd -s 64 -l $(( 54*13 )) -c 54 build/hello
</span></span><span class="line"><span class="cl">00000040: 0600 0000 0400 0000 4000 0000 0000 0000 4000 0000 0000 0000 4000 0000 0000 0000 d802 0000 0000 0000 d802 0000 0000 0000 0800 0000 0000  ........@.......@.......@.............................
</span></span><span class="line"><span class="cl">00000076: 0000 0300 0000 0400 0000 1803 0000 0000 0000 1803 0000 0000 0000 1803 0000 0000 0000 1c00 0000 0000 0000 1c00 0000 0000 0000 0100 0000  ......................................................
</span></span><span class="line"><span class="cl">000000ac: 0000 0000 0100 0000 0400 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 3006 0000 0000 0000 3006 0000 0000 0000 0010  ....................................0.......0.........
</span></span><span class="line"><span class="cl">000000e2: 0000 0000 0000 0100 0000 0500 0000 0010 0000 0000 0000 0010 0000 0000 0000 0010 0000 0000 0000 8901 0000 0000 0000 8901 0000 0000 0000  ......................................................
</span></span><span class="line"><span class="cl">00000118: 0010 0000 0000 0000 0100 0000 0400 0000 0020 0000 0000 0000 0020 0000 0000 0000 0020 0000 0000 0000 b400 0000 0000 0000 b400 0000 0000  ................. ....... ....... ....................
</span></span><span class="line"><span class="cl">0000014e: 0000 0010 0000 0000 0000 0100 0000 0600 0000 d02d 0000 0000 0000 d03d 0000 0000 0000 d03d 0000 0000 0000 4802 0000 0000 0000 5002 0000  ...................-.......=.......=......H.......P...
</span></span><span class="line"><span class="cl">00000184: 0000 0000 0010 0000 0000 0000 0200 0000 0600 0000 e02d 0000 0000 0000 e03d 0000 0000 0000 e03d 0000 0000 0000 e001 0000 0000 0000 e001  .....................-.......=.......=................
</span></span><span class="line"><span class="cl">000001ba: 0000 0000 0000 0800 0000 0000 0000 0400 0000 0400 0000 3803 0000 0000 0000 3803 0000 0000 0000 3803 0000 0000 0000 4000 0000 0000 0000  ......................8.......8.......8.......@.......
</span></span><span class="line"><span class="cl">000001f0: 4000 0000 0000 0000 0800 0000 0000 0000 0400 0000 0400 0000 7803 0000 0000 0000 7803 0000 0000 0000 7803 0000 0000 0000 4400 0000 0000  @.......................x.......x.......x.......D.....
</span></span><span class="line"><span class="cl">00000226: 0000 4400 0000 0000 0000 0400 0000 0000 0000 53e5 7464 0400 0000 3803 0000 0000 0000 3803 0000 0000 0000 3803 0000 0000 0000 4000 0000  ..D...............S.td....8.......8.......8.......@...
</span></span><span class="line"><span class="cl">0000025c: 0000 0000 4000 0000 0000 0000 0800 0000 0000 0000 50e5 7464 0400 0000 1420 0000 0000 0000 1420 0000 0000 0000 1420 0000 0000 0000 2400  ....@...............P.td..... ....... ....... ......$.
</span></span><span class="line"><span class="cl">00000292: 0000 0000 0000 2400 0000 0000 0000 0400 0000 0000 0000 51e5 7464 0600 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ......$...............Q.td............................
</span></span><span class="line"><span class="cl">000002c8: 0000 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 52e5 7464 0400 0000 d02d 0000 0000 0000 d03d 0000 0000 0000 d03d 0000 0000  ........................R.td.....-.......=.......=....
</span></span></code></pre></div><p>Now we just have to map each of these lines to <code>Elf64_Phdr</code> (since we have a 64Bit file)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/latest/source/include/uapi/linux/elf.h#L260
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">typedef struct elf64_phdr {
</span></span><span class="line"><span class="cl">  Elf64_Word p_type;      /* Segment type */
</span></span><span class="line"><span class="cl">  Elf64_Word p_flags;     /* Segment flags */
</span></span><span class="line"><span class="cl">  Elf64_Off p_offset;     /* Segment file offset */
</span></span><span class="line"><span class="cl">  Elf64_Addr p_vaddr;     /* Segment virtual address */
</span></span><span class="line"><span class="cl">  Elf64_Addr p_paddr;     /* Segment physical address */
</span></span><span class="line"><span class="cl">  Elf64_Xword p_filesz;   /* Segment size in file */
</span></span><span class="line"><span class="cl">  Elf64_Xword p_memsz;    /* Segment size in memory */
</span></span><span class="line"><span class="cl">  Elf64_Xword p_align;    /* Segment alignment, file &amp; memory */
</span></span><span class="line"><span class="cl">} Elf64_Phdr;
</span></span></code></pre></div><p>Using my nifty little parser, I got this digestible and user-friendly output for the above dump (Feel free to compare it)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[ + ] Program headers begins at: 0x40
</span></span><span class="line"><span class="cl"> [ 00 ] Type: 0x6        Flags: 0x4      Offset: 0x0040          vaddr: 0x40     paddr: 0x40     filesz: 0x728           memsz: 0x728            align: 0x8
</span></span><span class="line"><span class="cl"> [ 01 ] Type: 0x3        Flags: 0x4      Offset: 0x0318          vaddr: 0x318    paddr: 0x318    filesz: 0x28            memsz: 0x28             align: 0x1
</span></span><span class="line"><span class="cl"> [ 02 ] Type: 0x1        Flags: 0x4      Offset: 0x0000          vaddr: 0x0      paddr: 0x0      filesz: 0x1584          memsz: 0x1584           align: 0x1000
</span></span><span class="line"><span class="cl"> [ 03 ] Type: 0x1        Flags: 0x5      Offset: 0x1000          vaddr: 0x1000   paddr: 0x1000   filesz: 0x393           memsz: 0x393            align: 0x1000
</span></span><span class="line"><span class="cl"> [ 04 ] Type: 0x1        Flags: 0x4      Offset: 0x2000          vaddr: 0x2000   paddr: 0x2000   filesz: 0x180           memsz: 0x180            align: 0x1000
</span></span><span class="line"><span class="cl"> [ 05 ] Type: 0x1        Flags: 0x6      Offset: 0x2dd0          vaddr: 0x3dd0   paddr: 0x3dd0   filesz: 0x584           memsz: 0x592            align: 0x1000
</span></span><span class="line"><span class="cl"> [ 06 ] Type: 0x2        Flags: 0x6      Offset: 0x2de0          vaddr: 0x3de0   paddr: 0x3de0   filesz: 0x480           memsz: 0x480            align: 0x8
</span></span><span class="line"><span class="cl"> [ 07 ] Type: 0x4        Flags: 0x4      Offset: 0x0338          vaddr: 0x338    paddr: 0x338    filesz: 0x64            memsz: 0x64             align: 0x8
</span></span><span class="line"><span class="cl"> [ 08 ] Type: 0x4        Flags: 0x4      Offset: 0x0378          vaddr: 0x378    paddr: 0x378    filesz: 0x68            memsz: 0x68             align: 0x4
</span></span><span class="line"><span class="cl"> [ 09 ] Type: 0xe553     Flags: 0x4      Offset: 0x0338          vaddr: 0x338    paddr: 0x338    filesz: 0x64            memsz: 0x64             align: 0x8
</span></span><span class="line"><span class="cl"> [ 10 ] Type: 0xe550     Flags: 0x4      Offset: 0x2014          vaddr: 0x2014   paddr: 0x2014   filesz: 0x36            memsz: 0x36             align: 0x4
</span></span><span class="line"><span class="cl"> [ 11 ] Type: 0xe551     Flags: 0x6      Offset: 0x0000          vaddr: 0x0      paddr: 0x0      filesz: 0x0             memsz: 0x0              align: 0x10
</span></span><span class="line"><span class="cl"> [ 12 ] Type: 0xe552     Flags: 0x4      Offset: 0x2dd0          vaddr: 0x3dd0   paddr: 0x3dd0   filesz: 0x560           memsz: 0x560            align: 0x1
</span></span></code></pre></div><p>Now, it&rsquo;s time to take a deep dive into the inner workings of the <code>Elf64_Phdr</code> struct</p>
<h3 id="1-p_type">1. p_type</h3>
<p>Just like <code>sh_type</code>, this member tells the type of the segment. Whether the segment will be loaded in the memory or is it just used to store notes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/latest/source/include/uapi/linux/elf.h#L25
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/* These constants are for the segment types stored in the image headers */
</span></span><span class="line"><span class="cl">#define PT_NULL    0
</span></span><span class="line"><span class="cl">#define PT_LOAD    1
</span></span><span class="line"><span class="cl">#define PT_DYNAMIC 2
</span></span><span class="line"><span class="cl">#define PT_INTERP  3
</span></span><span class="line"><span class="cl">#define PT_NOTE    4
</span></span><span class="line"><span class="cl">#define PT_SHLIB   5
</span></span><span class="line"><span class="cl">#define PT_PHDR    6
</span></span><span class="line"><span class="cl">#define PT_TLS     7               /* Thread local storage segment */
</span></span><span class="line"><span class="cl">#define PT_LOOS    0x60000000      /* OS-specific */
</span></span><span class="line"><span class="cl">#define PT_HIOS    0x6fffffff      /* OS-specific */
</span></span><span class="line"><span class="cl">#define PT_LOPROC  0x70000000
</span></span><span class="line"><span class="cl">#define PT_HIPROC  0x7fffffff
</span></span><span class="line"><span class="cl">#define PT_GNU_EH_FRAME	(PT_LOOS + 0x474e550)
</span></span><span class="line"><span class="cl">#define PT_GNU_STACK	(PT_LOOS + 0x474e551)
</span></span><span class="line"><span class="cl">#define PT_GNU_RELRO	(PT_LOOS + 0x474e552)
</span></span><span class="line"><span class="cl">#define PT_GNU_PROPERTY	(PT_LOOS + 0x474e553)
</span></span></code></pre></div><h3 id="2-p_flags">2. p_flags</h3>
<p>This is quite similar to the the <code>(r)ead</code>, <code>(w)rite</code> and <code>e(x)ecute</code> permissions we are familiar with. This member specifies the permissions for the given segment.</p>
<p>Usually the segment containing the <code>.text</code> section will have <code>(r)ead</code> and <code>e(x)ecute</code> permissions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/latest/source/include/uapi/linux/elf.h#L243
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/* These constants define the permissions on sections in the program
</span></span><span class="line"><span class="cl">   header, p_flags. */
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#define PF_R    0x4
</span></span><span class="line"><span class="cl">#define PF_W    0x2
</span></span><span class="line"><span class="cl">#define PF_X    0x1
</span></span></code></pre></div><h3 id="3-p_offset">3. p_offset</h3>
<p>This holds the offset from the beginning of the file, where the first byte of the first section in this segment is located.</p>
<h3 id="4-p_vaddr">4. p_vaddr</h3>
<p>This member holds the memory/virtual address for the segment.</p>
<h3 id="5-p_paddr">5. p_paddr</h3>
<p>This is same as <code>p_vaddr</code>, but holds the physical/on-disk address for the segment.</p>
<h3 id="6-p_filesz">6. p_filesz</h3>
<p>This holds the on-disk size (in bytes) of the segment.</p>
<h3 id="7-p_memsz">7. p_memsz</h3>
<p>This member holds the memory/virtual size (in bytes) of the segment.</p>
<h3 id="8-p_align">8. p_align</h3>
<p>This member holds the value to which the segments are aligned in memory and in the file.</p>
<p>Similar to <code>sh_addralign</code>, value of <code>0</code> and <code>1</code> are treated as &ldquo;no alignment&rdquo;, while the positive powers of <code>2</code> are taken as the actual alignment values.</p>
<h2 id="practicals">Practicals</h2>
<p>Let&rsquo;s start with checking if <code>strip</code> command makes any change to the program headers.</p>
<ul>
<li>Try to write a program to parse the program headers and display the information in better way.</li>
<li>Try to write a program that gives the information about what sections are grouped together in a segment. <code>readelf</code> gives this information in below format</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Program Headers:
</span></span><span class="line"><span class="cl">  Type           Offset   VirtAddr           PhysAddr           FileSiz  MemSiz   Flg Align
</span></span><span class="line"><span class="cl">  PHDR           0x000040 0x0000000000000040 0x0000000000000040 0x0002d8 0x0002d8 R   0x8
</span></span><span class="line"><span class="cl">  INTERP         0x000318 0x0000000000000318 0x0000000000000318 0x00001c 0x00001c R   0x1
</span></span><span class="line"><span class="cl">      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2 ]
</span></span><span class="line"><span class="cl">  LOAD           0x000000 0x0000000000000000 0x0000000000000000 0x000630 0x000630 R   0x1000
</span></span><span class="line"><span class="cl">  LOAD           0x001000 0x0000000000001000 0x0000000000001000 0x000189 0x000189 R E 0x1000
</span></span><span class="line"><span class="cl">  LOAD           0x002000 0x0000000000002000 0x0000000000002000 0x0000b4 0x0000b4 R   0x1000
</span></span><span class="line"><span class="cl">  LOAD           0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x000248 0x000250 RW  0x1000
</span></span><span class="line"><span class="cl">  DYNAMIC        0x002de0 0x0000000000003de0 0x0000000000003de0 0x0001e0 0x0001e0 RW  0x8
</span></span><span class="line"><span class="cl">  NOTE           0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R   0x8
</span></span><span class="line"><span class="cl">  NOTE           0x000378 0x0000000000000378 0x0000000000000378 0x000044 0x000044 R   0x4
</span></span><span class="line"><span class="cl">  GNU_PROPERTY   0x000338 0x0000000000000338 0x0000000000000338 0x000040 0x000040 R   0x8
</span></span><span class="line"><span class="cl">  GNU_EH_FRAME   0x002014 0x0000000000002014 0x0000000000002014 0x000024 0x000024 R   0x4
</span></span><span class="line"><span class="cl">  GNU_STACK      0x000000 0x0000000000000000 0x0000000000000000 0x000000 0x000000 RW  0x10
</span></span><span class="line"><span class="cl">  GNU_RELRO      0x002dd0 0x0000000000003dd0 0x0000000000003dd0 0x000230 0x000230 R   0x1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Section to Segment mapping:
</span></span><span class="line"><span class="cl">  Segment Sections...
</span></span><span class="line"><span class="cl">   00
</span></span><span class="line"><span class="cl">   01     .interp
</span></span><span class="line"><span class="cl">   02     .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt
</span></span><span class="line"><span class="cl">   03     .init .plt .text .fini
</span></span><span class="line"><span class="cl">   04     .rodata .eh_frame_hdr .eh_frame
</span></span><span class="line"><span class="cl">   05     .init_array .fini_array .dynamic .got .got.plt .data .bss
</span></span><span class="line"><span class="cl">   06     .dynamic
</span></span><span class="line"><span class="cl">   07     .note.gnu.property
</span></span><span class="line"><span class="cl">   08     .note.gnu.build-id .note.ABI-tag
</span></span><span class="line"><span class="cl">   09     .note.gnu.property
</span></span><span class="line"><span class="cl">   10     .eh_frame_hdr
</span></span><span class="line"><span class="cl">   11
</span></span><span class="line"><span class="cl">   12     .init_array .fini_array .dynamic .got
</span></span></code></pre></div><p>If you want to go extra mile and dig deep,</p>
<ul>
<li>Try overwriting the program interpreter with your custom loader program. Things will probably go wrong and then you can dig deep what&rsquo;s the root cause.</li>
<li>Add a new section (<code>.text</code> type), create it&rsquo;s section header entry, then create it&rsquo;s program header entry such that it is loadable in memory. Then change the ELF entrypoint to the newly created section.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Alright, buckle up, because we have just seen what segments are, how sections are grouped into segments, and how program headers act as a table to store information about segments which is helpful for runtime. Picture this -</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  ┌───────────────────────────┐
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │      File Header          │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │     Program Header        │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤  ◄───┐
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │      Section 1            │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤      │ Segment 1
</span></span><span class="line"><span class="cl">  │      Section 2            │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │      Section 3            │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤  ◄───┤
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │ Segment 2
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │      Section 4            │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │  ◄───┤
</span></span><span class="line"><span class="cl">  │                           │      │ Segment 3
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤  ◄───┤
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │      Section 5            │      │
</span></span><span class="line"><span class="cl">  │                           │      │ Segment 4
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤  ◄───┤
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │     Section 6             │      │ Segment 5
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  │                           │      │
</span></span><span class="line"><span class="cl">  ├───────────────────────────┤  ◄───┘
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │     Section Header        │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  │                           │
</span></span><span class="line"><span class="cl">  └───────────────────────────┘
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>ELF Chronicles: Section Headers</title>
      <link>https://ayedaemon.github.io/post/2023/10/elf-chronicles-section-headers/</link>
      <pubDate>Thu, 19 Oct 2023 00:24:06 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/10/elf-chronicles-section-headers/</guid>
      <description>Exploring ELF Section Headers</description>
      <content:encoded><![CDATA[<h2 id="intro">Intro</h2>
<p>Assuming you&rsquo;ve got ELF headers like <code>Elf64_Ehdr</code> or <code>Elf32_Ehdr</code> at your fingertips, and you&rsquo;re armed with the know-how and tools to decipher their contents effortlessly.</p>
<p>For this article I&rsquo;ll be using the below C code to generate the ELF file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* file: hello_world.c */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A macro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define HELLO_MSG1 &#34;Hello World1&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A global variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span> <span class="n">HELLO_MSG2</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World2&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// local variable for main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">HELLO_MSG3</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Print messages
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>You can get the ELF binary by compiling this code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gcc hello_world.c -o hello_world
</span></span></code></pre></div><p>Now the task at hand is to read/parse the file and get information regarding the sections (<code>e_shoff</code>, <code>e_shentsize</code>, <code>e_shnum</code>, and <code>e_shstrndx</code>). Mostly I, another <em>mere</em> human, rely on a &ldquo;industry grade&rdquo; tool called <code>readelf</code> to read an ELF file and figure out stuff.</p>
<p>Now, the challenge on our hands is to crack open the file and unearth some juicy details about the sections. You already know, things like <code>e_shoff</code>, <code>e_shentsize</code>, <code>e_shnum</code>, and <code>e_shstrndx</code>. I confess, like any other <em>mere</em> human, I often lean on a trusty &ldquo;industry-grade&rdquo; tool called <code>readelf</code> to do the heavy lifting when it comes to ELF file forensics. (But it&rsquo;s always good to know the manual methods for those 1% kind of situations)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ readelf --file-header --wide hello_world
</span></span><span class="line"><span class="cl">ELF Header:
</span></span><span class="line"><span class="cl">  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">  Class:                             ELF64
</span></span><span class="line"><span class="cl">  Data:                              2&#39;s complement, little endian
</span></span><span class="line"><span class="cl">  Version:                           1 (current)
</span></span><span class="line"><span class="cl">  OS/ABI:                            UNIX - System V
</span></span><span class="line"><span class="cl">  ABI Version:                       0
</span></span><span class="line"><span class="cl">  Type:                              DYN (Position-Independent Executable file)
</span></span><span class="line"><span class="cl">  Machine:                           Advanced Micro Devices X86-64
</span></span><span class="line"><span class="cl">  Version:                           0x1
</span></span><span class="line"><span class="cl">  Entry point address:               0x1050
</span></span><span class="line"><span class="cl">  Start of program headers:          64 (bytes into file)
</span></span><span class="line"><span class="cl">  Start of section headers:          13608 (bytes into file)
</span></span><span class="line"><span class="cl">  Flags:                             0x0
</span></span><span class="line"><span class="cl">  Size of this header:               64 (bytes)
</span></span><span class="line"><span class="cl">  Size of program headers:           56 (bytes)
</span></span><span class="line"><span class="cl">  Number of program headers:         13
</span></span><span class="line"><span class="cl">  Size of section headers:           64 (bytes)
</span></span><span class="line"><span class="cl">  Number of section headers:         30
</span></span><span class="line"><span class="cl">  Section header string table index: 29
</span></span></code></pre></div><p>Examining the output above, we can deduce a few key details.</p>
<ul>
<li>Firstly, the section headers take their grand entrance at a distance of <code>13608</code> bytes (<code>0x3528</code> in the mystical language of hex).</li>
<li>Each of these header entries is precisely <code>64</code> bytes in size (<code>0x40</code> in hex),</li>
<li>and in total, we&rsquo;ve got a flourishing population of <code>30</code> sections (<code>1e</code> in hex).</li>
</ul>
<p>So, it&rsquo;s like having a treasure map telling us exactly where to dig in the ELF file and how big the treasure chests are!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ xxd -s 13608 -l $(( 64*30 )) -c 64 hello_world
</span></span><span class="line"><span class="cl">00003528: 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class="line"><span class="cl">00003568: 1b00 0000 0100 0000 0200 0000 0000 0000 1803 0000 0000 0000 1803 0000 0000 0000 1c00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class="line"><span class="cl">000035a8: 2300 0000 0700 0000 0200 0000 0000 0000 3803 0000 0000 0000 3803 0000 0000 0000 4000 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  #...............8.......8.......@...............................
</span></span><span class="line"><span class="cl">000035e8: 3600 0000 0700 0000 0200 0000 0000 0000 7803 0000 0000 0000 7803 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  6...............x.......x.......$...............................
</span></span><span class="line"><span class="cl">00003628: 4900 0000 0700 0000 0200 0000 0000 0000 9c03 0000 0000 0000 9c03 0000 0000 0000 2000 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  I............................... ...............................
</span></span><span class="line"><span class="cl">00003668: 5700 0000 f6ff ff6f 0200 0000 0000 0000 c003 0000 0000 0000 c003 0000 0000 0000 1c00 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  W......o........................................................
</span></span><span class="line"><span class="cl">000036a8: 6100 0000 0b00 0000 0200 0000 0000 0000 e003 0000 0000 0000 e003 0000 0000 0000 c000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 1800 0000 0000 0000  a...............................................................
</span></span><span class="line"><span class="cl">000036e8: 6900 0000 0300 0000 0200 0000 0000 0000 a004 0000 0000 0000 a004 0000 0000 0000 a800 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  i...............................................................
</span></span><span class="line"><span class="cl">00003728: 7100 0000 ffff ff6f 0200 0000 0000 0000 4805 0000 0000 0000 4805 0000 0000 0000 1000 0000 0000 0000 0600 0000 0000 0000 0200 0000 0000 0000 0200 0000 0000 0000  q......o........H.......H.......................................
</span></span><span class="line"><span class="cl">00003768: 7e00 0000 feff ff6f 0200 0000 0000 0000 5805 0000 0000 0000 5805 0000 0000 0000 4000 0000 0000 0000 0700 0000 0100 0000 0800 0000 0000 0000 0000 0000 0000 0000  ~......o........X.......X.......@...............................
</span></span><span class="line"><span class="cl">000037a8: 8d00 0000 0400 0000 0200 0000 0000 0000 9805 0000 0000 0000 9805 0000 0000 0000 c000 0000 0000 0000 0600 0000 0000 0000 0800 0000 0000 0000 1800 0000 0000 0000  ................................................................
</span></span><span class="line"><span class="cl">000037e8: 9700 0000 0400 0000 4200 0000 0000 0000 5806 0000 0000 0000 5806 0000 0000 0000 3000 0000 0000 0000 0600 0000 1700 0000 0800 0000 0000 0000 1800 0000 0000 0000  ........B.......X.......X.......0...............................
</span></span><span class="line"><span class="cl">00003828: a100 0000 0100 0000 0600 0000 0000 0000 0010 0000 0000 0000 0010 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class="line"><span class="cl">00003868: 9c00 0000 0100 0000 0600 0000 0000 0000 2010 0000 0000 0000 2010 0000 0000 0000 3000 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 1000 0000 0000 0000  ................ ....... .......0...............................
</span></span><span class="line"><span class="cl">000038a8: a700 0000 0100 0000 0600 0000 0000 0000 5010 0000 0000 0000 5010 0000 0000 0000 7101 0000 0000 0000 0000 0000 0000 0000 1000 0000 0000 0000 0000 0000 0000 0000  ................P.......P.......q...............................
</span></span><span class="line"><span class="cl">000038e8: ad00 0000 0100 0000 0600 0000 0000 0000 c411 0000 0000 0000 c411 0000 0000 0000 0d00 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................................................................
</span></span><span class="line"><span class="cl">00003928: b300 0000 0100 0000 0200 0000 0000 0000 0020 0000 0000 0000 0020 0000 0000 0000 1100 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................. ....... ......................................
</span></span><span class="line"><span class="cl">00003968: bb00 0000 0100 0000 0200 0000 0000 0000 1420 0000 0000 0000 1420 0000 0000 0000 2400 0000 0000 0000 0000 0000 0000 0000 0400 0000 0000 0000 0000 0000 0000 0000  ................. ....... ......$...............................
</span></span><span class="line"><span class="cl">000039a8: c900 0000 0100 0000 0200 0000 0000 0000 3820 0000 0000 0000 3820 0000 0000 0000 7c00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  ................8 ......8 ......|...............................
</span></span><span class="line"><span class="cl">000039e8: d300 0000 0e00 0000 0300 0000 0000 0000 d03d 0000 0000 0000 d02d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................=.......-......................................
</span></span><span class="line"><span class="cl">00003a28: df00 0000 0f00 0000 0300 0000 0000 0000 d83d 0000 0000 0000 d82d 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................=.......-......................................
</span></span><span class="line"><span class="cl">00003a68: eb00 0000 0600 0000 0300 0000 0000 0000 e03d 0000 0000 0000 e02d 0000 0000 0000 e001 0000 0000 0000 0700 0000 0000 0000 0800 0000 0000 0000 1000 0000 0000 0000  .................=.......-......................................
</span></span><span class="line"><span class="cl">00003aa8: f400 0000 0100 0000 0300 0000 0000 0000 c03f 0000 0000 0000 c02f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................?......./......(...............................
</span></span><span class="line"><span class="cl">00003ae8: f900 0000 0100 0000 0300 0000 0000 0000 e83f 0000 0000 0000 e82f 0000 0000 0000 2800 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0800 0000 0000 0000  .................?......./......(...............................
</span></span><span class="line"><span class="cl">00003b28: 0201 0000 0100 0000 0300 0000 0000 0000 1040 0000 0000 0000 1030 0000 0000 0000 1d00 0000 0000 0000 0000 0000 0000 0000 0800 0000 0000 0000 0000 0000 0000 0000  .................@.......0......................................
</span></span><span class="line"><span class="cl">00003b68: 0801 0000 0800 0000 0300 0000 0000 0000 2d40 0000 0000 0000 2d30 0000 0000 0000 0300 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  ................-@......-0......................................
</span></span><span class="line"><span class="cl">00003ba8: 0d01 0000 0100 0000 3000 0000 0000 0000 0000 0000 0000 0000 2d30 0000 0000 0000 1b00 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0100 0000 0000 0000  ........0...............-0......................................
</span></span><span class="line"><span class="cl">00003be8: 0100 0000 0200 0000 0000 0000 0000 0000 0000 0000 0000 0000 4830 0000 0000 0000 7002 0000 0000 0000 1c00 0000 0600 0000 0800 0000 0000 0000 1800 0000 0000 0000  ........................H0......p...............................
</span></span><span class="line"><span class="cl">00003c28: 0900 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 b832 0000 0000 0000 5301 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  .........................2......S...............................
</span></span><span class="line"><span class="cl">00003c68: 1100 0000 0300 0000 0000 0000 0000 0000 0000 0000 0000 0000 0b34 0000 0000 0000 1601 0000 0000 0000 0000 0000 0000 0000 0100 0000 0000 0000 0000 0000 0000 0000  .........................4......................................
</span></span></code></pre></div><p>With each line presenting itself as a section header entry, it&rsquo;s like experiencing an elegant and straightforward design! Now we just have to map each of these lines to <code>Elf64_Shdr</code> (since we have a 64Bit file)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/latest/source/include/uapi/linux/elf.h#L321
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">typedef struct elf64_shdr {
</span></span><span class="line"><span class="cl">  Elf64_Word sh_name;		/* Section name, index in string tbl    # 4 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Word sh_type;		/* Type of section                      # 4 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Xword sh_flags;		/* Miscellaneous section attributes   # 8 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Addr sh_addr;		/* Section virtual addr at execution    # 8 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Off sh_offset;		/* Section file offset                # 8 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Xword sh_size;		/* Size of section in bytes           # 8 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Word sh_link;		/* Index of another section             # 4 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Word sh_info;		/* Additional section information       # 4 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Xword sh_addralign;	/* Section alignment                # 8 bytes */
</span></span><span class="line"><span class="cl">  Elf64_Xword sh_entsize;	/* Entry size if section holds table  # 8 bytes */
</span></span><span class="line"><span class="cl">} Elf64_Shdr;
</span></span></code></pre></div><p>But first, understand why we are doing any of this&hellip;</p>
<h2 id="section-headers">Section headers</h2>
<p>Imagine a <a href="https://www.lego.com/en-us/product/lego-dc-batman-batmobile-tumbler-76240">LEGO batmobile</a> – it&rsquo;s not just one big block, right? It has different parts, like a roof, doors, wheels, etc. <strong>ELF sections</strong> (not section headers) are like these parts in a computer program. Each section has its own job, some sections hold the variables, some hold the program instructions, while some just hold extra notes. Basically, each section has some data in it and has a specific role for that data.</p>
<p>Section headers is like a index for those sections. It tells you a good amount of details about the section, like</p>
<ul>
<li>Name of the section (indirectly :P),</li>
<li>Type of section,</li>
<li>Offset of the address in file and memory,</li>
<li>Size of the section in bytes, etc</li>
</ul>
<p>Now you know what section headers are and the valuable data they contain, and with the ELF file headers acting as our treasure map, directing us to the precise location of the section headers in the file (<code>e_shoff</code>), detailing their entry size (<code>e_shentsize</code>) and counting their entries (<code>e_shnum</code>).</p>
<p>I&rsquo;ve also whipped up a nifty little parser, just for the occasion. It&rsquo;s designed to gracefully dissect an ELF file and lay out the section headers in a more digestible and user-friendly fashion. No more cryptic <code>hexdumps</code> or <code>xxd</code> outputs for us!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[ + ] Section headers begins at: 0x34b8
</span></span><span class="line"><span class="cl"> [ 00 ] Section Name:                            Type: 0x0       Flags: 0x0      Addr: 0x0       Offset: 0x0             Size: 0         Link: 0         Info: 0x0       Addralign: 0x0          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 01 ] Section Name: .interp                    Type: 0x1       Flags: 0x2      Addr: 0x318     Offset: 0x318           Size: 28        Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 02 ] Section Name: .note.gnu.property         Type: 0x7       Flags: 0x2      Addr: 0x338     Offset: 0x338           Size: 64        Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 03 ] Section Name: .note.gnu.build-id         Type: 0x7       Flags: 0x2      Addr: 0x378     Offset: 0x378           Size: 36        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 04 ] Section Name: .note.ABI-tag              Type: 0x7       Flags: 0x2      Addr: 0x39c     Offset: 0x39c           Size: 32        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 05 ] Section Name: .gnu.hash                  Type: 0xfff6    Flags: 0x2      Addr: 0x3c0     Offset: 0x3c0           Size: 28        Link: 6         Info: 0x0       Addralign: 0x8          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 06 ] Section Name: .dynsym                    Type: 0xb       Flags: 0x2      Addr: 0x3e0     Offset: 0x3e0           Size: 168       Link: 7         Info: 0x1       Addralign: 0x8          Entsize: 24
</span></span><span class="line"><span class="cl"> [ 07 ] Section Name: .dynstr                    Type: 0x3       Flags: 0x2      Addr: 0x488     Offset: 0x488           Size: 144       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 08 ] Section Name: .gnu.version               Type: 0xffff    Flags: 0x2      Addr: 0x518     Offset: 0x518           Size: 14        Link: 6         Info: 0x0       Addralign: 0x2          Entsize: 2
</span></span><span class="line"><span class="cl"> [ 09 ] Section Name: .gnu.version_r             Type: 0xfffe    Flags: 0x2      Addr: 0x528     Offset: 0x528           Size: 48        Link: 7         Info: 0x1       Addralign: 0x8          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 10 ] Section Name: .rela.dyn                  Type: 0x4       Flags: 0x2      Addr: 0x558     Offset: 0x558           Size: 192       Link: 6         Info: 0x0       Addralign: 0x8          Entsize: 24
</span></span><span class="line"><span class="cl"> [ 11 ] Section Name: .rela.plt                  Type: 0x4       Flags: 0x42     Addr: 0x618     Offset: 0x618           Size: 24        Link: 6         Info: 0x17      Addralign: 0x8          Entsize: 24
</span></span><span class="line"><span class="cl"> [ 12 ] Section Name: .init                      Type: 0x1       Flags: 0x6      Addr: 0x1000    Offset: 0x1000          Size: 27        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 13 ] Section Name: .plt                       Type: 0x1       Flags: 0x6      Addr: 0x1020    Offset: 0x1020          Size: 32        Link: 0         Info: 0x0       Addralign: 0x10         Entsize: 16
</span></span><span class="line"><span class="cl"> [ 14 ] Section Name: .text                      Type: 0x1       Flags: 0x6      Addr: 0x1040    Offset: 0x1040          Size: 315       Link: 0         Info: 0x0       Addralign: 0x10         Entsize: 0
</span></span><span class="line"><span class="cl"> [ 15 ] Section Name: .fini                      Type: 0x1       Flags: 0x6      Addr: 0x117c    Offset: 0x117c          Size: 13        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 16 ] Section Name: .rodata                    Type: 0x1       Flags: 0x2      Addr: 0x2000    Offset: 0x2000          Size: 18        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 17 ] Section Name: .eh_frame_hdr              Type: 0x1       Flags: 0x2      Addr: 0x2014    Offset: 0x2014          Size: 36        Link: 0         Info: 0x0       Addralign: 0x4          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 18 ] Section Name: .eh_frame                  Type: 0x1       Flags: 0x2      Addr: 0x2038    Offset: 0x2038          Size: 124       Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 19 ] Section Name: .init_array                Type: 0xe       Flags: 0x3      Addr: 0x3dd0    Offset: 0x2dd0          Size: 8         Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 8
</span></span><span class="line"><span class="cl"> [ 20 ] Section Name: .fini_array                Type: 0xf       Flags: 0x3      Addr: 0x3dd8    Offset: 0x2dd8          Size: 8         Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 8
</span></span><span class="line"><span class="cl"> [ 21 ] Section Name: .dynamic                   Type: 0x6       Flags: 0x3      Addr: 0x3de0    Offset: 0x2de0          Size: 480       Link: 7         Info: 0x0       Addralign: 0x8          Entsize: 16
</span></span><span class="line"><span class="cl"> [ 22 ] Section Name: .got                       Type: 0x1       Flags: 0x3      Addr: 0x3fc0    Offset: 0x2fc0          Size: 40        Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 8
</span></span><span class="line"><span class="cl"> [ 23 ] Section Name: .got.plt                   Type: 0x1       Flags: 0x3      Addr: 0x3fe8    Offset: 0x2fe8          Size: 32        Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 8
</span></span><span class="line"><span class="cl"> [ 24 ] Section Name: .data                      Type: 0x1       Flags: 0x3      Addr: 0x4008    Offset: 0x3008          Size: 16        Link: 0         Info: 0x0       Addralign: 0x8          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 25 ] Section Name: .bss                       Type: 0x8       Flags: 0x3      Addr: 0x4018    Offset: 0x3018          Size: 8         Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 26 ] Section Name: .comment                   Type: 0x1       Flags: 0x30     Addr: 0x0       Offset: 0x3018          Size: 27        Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 1
</span></span><span class="line"><span class="cl"> [ 27 ] Section Name: .symtab                    Type: 0x2       Flags: 0x0      Addr: 0x0       Offset: 0x3038          Size: 576       Link: 28        Info: 0x6       Addralign: 0x8          Entsize: 24
</span></span><span class="line"><span class="cl"> [ 28 ] Section Name: .strtab                    Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x3278          Size: 298       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span><span class="line"><span class="cl"> [ 29 ] Section Name: .shstrtab                  Type: 0x3       Flags: 0x0      Addr: 0x0       Offset: 0x33a2          Size: 278       Link: 0         Info: 0x0       Addralign: 0x1          Entsize: 0
</span></span></code></pre></div><p>Here&rsquo;s a sneak peek at what my trusty parser churned out, for your reference. (If you fancy, you can even pit it against the <code>xxd</code> results we saw earlier).</p>
<p>Now, it&rsquo;s time to take a deep dive into the inner workings of the <code>Elf64_Shdr</code> struct</p>
<h3 id="1-sh_name">1. sh_name</h3>
<p>As I mentioned earlier, among so many sections of an ELF file, there&rsquo;s one special place known as the string table. In this mystical realm, the names of all sections are held in a null-terminated fashion, creating a seamless string of section names. Now, the <code>sh_name</code> member, well, it&rsquo;s like a treasure map, pinpointing the exact <strong>offset</strong> within that section. So, if, for instance, <code>.interp</code> resides at <code>X1</code> bytes within the section, and this section itself is tucked away at <code>Y1</code> bytes into the file, the location of this string can be calculated as simply <code>X1 + Y1</code> bytes into the file. But, for the sake of simplicity, <code>sh_name</code> keeps things straightforward by storing just the <code>X1</code> value, and nothing more. To track down the section&rsquo;s exact location, we can rely on the trusty <code>e_shstrndx</code> value from the ELF file header.</p>
<p>From programming point of view, accessing the string value for section name will look something like -</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)(</span><span class="n">shdr</span><span class="p">[</span><span class="n">ehdr</span><span class="o">-&gt;</span><span class="n">e_shstrndx</span><span class="p">].</span><span class="n">sh_offset</span> <span class="o">+</span> <span class="n">shdr</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">sh_name</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-sh_type">2. sh_type</h3>
<p>This section serves as a delightful teaser, offering a glimpse of the treasures awaiting inside the section itself. Take, for instance, <code>SHT_STRTAB</code> (0x3), a section that houses a collection of null-terminated strings, just waiting to be discovered.</p>
<p>When we journey into the Linux kernel, we encounter a bunch of defined section header types -</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">https://elixir.bootlin.com/linux/v6.5.8/source/include/uapi/linux/elf.h#L271
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* sh_type */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SHT_NULL      0
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_PROGBITS  1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_SYMTAB    2
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_STRTAB    3
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_RELA      4
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_HASH      5
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_DYNAMIC   6
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_NOTE      7
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_NOBITS    8
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_REL       9
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_SHLIB     10
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_DYNSYM    11
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_NUM       12
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_LOPROC    0x70000000
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_HIPROC    0x7fffffff
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_LOUSER    0x80000000
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHT_HIUSER    0xffffffff
</span></span></span></code></pre></div><h3 id="3-sh_flags">3. sh_flags</h3>
<p>This is a one-bit flag, that decides whether a specific feature applies to the given section or not&hellip;
Linux kernel has some flag types defined -</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">https://elixir.bootlin.com/linux/v6.5.8/source/include/uapi/linux/elf.h#L290
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* sh_flags */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SHF_WRIT            0x1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHF_ALLOC           0x2
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHF_EXECINSTR       0x4
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHF_RELA_LIVEPATCH  0x00100000
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHF_RO_AFTER_INIT   0x00200000
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHF_MASKPROC        0xf0000000
</span></span></span></code></pre></div><p>Playing the guessing game? Well, if you spot a section like <code>.text</code> with a type value of <code>0x6</code>, it&rsquo;s a hint at what&rsquo;s to come. This section will be allocated a space in memory at runtime, with permission to execute instructions, but don&rsquo;t even think about writing anything to it after the section is loaded.</p>
<h3 id="4-sh_addr">4. sh_addr</h3>
<p>Now, if the section is destined for memory, this member plays a pivotal role, holding the keys to the memory kingdom, designating the precise spot where the section lands. But here&rsquo;s a twist – for sections with no memory aspirations, this value becomes a mere placeholder, leaving a little room for some extra, secret bytes. <em>(wink, wink)</em></p>
<h3 id="5-sh_offset">5. sh_offset</h3>
<p>Here&rsquo;s the catch: while <code>sh_addr</code> spills the beans on the section&rsquo;s memory location, this member focuses on the section&rsquo;s spot in the file. It&rsquo;s like knowing where the script lies before the performance. However, some sections, like the enigmatic <code>SHT_NOBITS</code>, are a bit of a puzzle – they claim a spot in the file, but when you try to read data from their supposed location, it&rsquo;s like chasing a ghost; there&rsquo;s nothing substantial to be found. (that is, they don&rsquo;t take any space in file; like a classic &ldquo;all bark, no bite&rdquo; scenario)</p>
<p>(<strong>HINT</strong>: Look at offsets and size of <code>.bss</code> and <code>.comment</code> sections from above listing. <code>.bss</code> is a <code>SHT_NOBITS</code> kind of section.)</p>
<h3 id="6-sh_size">6. sh_size</h3>
<p>For sections that aren&rsquo;t the enigmatic <code>SHT_NOBITS</code> type, this value is a trustworthy measure, mapping out the precise size (in bytes) of the section within the file. For <code>SHT_NOBITS</code>, it&rsquo;s a bit of a riddle. While it claims to reveal a section&rsquo;s size in bytes, be warned that when you glance at the size of a <code>.bss</code> section and it does says <code>8</code> bytes. But again, since there is nothing in the file, it&rsquo;s more of a conceptual size for this type.</p>
<h3 id="7-sh_link">7. sh_link</h3>
<p>This member is used to link a section with another section. One of the use for such kind of linking is to signify some sort of dependency of one section on another. But the actual nature of linking depends on the section type.</p>
<p>(HINT: Checkout <code>.gnu_hash</code>, <code>.dynsym</code>, and <code>dynstr</code> sections)</p>
<h3 id="8-sh_info">8. sh_info</h3>
<p>Think of this member as the mysterious vault, holding extra information that&rsquo;s tailor-made for the section&rsquo;s needs. However, the contents of this vault are shapeshifters, and what you&rsquo;ll find inside depends entirely on the section&rsquo;s unique personality and type.</p>
<h3 id="9-sh_addralign">9. sh_addralign</h3>
<p>This member holds the alignment information. When it takes on the humble value of <code>0</code> or <code>1</code>, it&rsquo;s like saying, &ldquo;No alignment required.&rdquo; But when it strides into the realm of positive powers of <code>2</code>, it becomes the architect of alignment, ensuring that the section is perfectly orchestrated for maximum efficiency.</p>
<p><em>Alignment is the unsung hero in the world of efficient computing. It&rsquo;s the magic behind how smoothly a computer can access and manipulate data or instructions.</em></p>
<h3 id="10-sh_entsize">10. sh_entsize</h3>
<p>Picture it: there are sections that harbor orderly tables with entries of a fixed size. Now, this member is your trusted guide, revealing the size of each entry in bytes. To find the grand total of entries, you simply divide the section&rsquo;s size by the size of each entry, just like a mathematical maestro.</p>
<p>(NOTE: You can read more about ELF sections and each member of section headers from <a href="https://linux.die.net/man/5/elf"><code>man 5 elf</code></a>; RTFM)</p>
<h2 id="practicals">Practicals</h2>
<p>For now, let&rsquo;s just start with what does <code>strip</code> command do to ELF sections. And research on why section headers are actually important.</p>
<p>If you are more inclined towards being tech savvy, try to write a program to parse and display the section headers.</p>
<p>To go an extra mile, add a new section to your ELF file (also add it&rsquo;s entry in section headers)&hellip;</p>
<p>Here are some links that might give you a starting point.</p>
<ul>
<li><a href="https://stackoverflow.com/questions/1088128/adding-section-to-elf-file">https://stackoverflow.com/questions/1088128/adding-section-to-elf-file</a></li>
<li><a href="https://reverseengineering.stackexchange.com/questions/14779/how-to-successfully-add-a-code-section-to-an-executable-file-in-linux">https://reverseengineering.stackexchange.com/questions/14779/how-to-successfully-add-a-code-section-to-an-executable-file-in-linux</a></li>
<li><a href="https://stackoverflow.com/questions/29058016/efficiently-adding-a-new-section-in-an-elf-file">https://stackoverflow.com/questions/29058016/efficiently-adding-a-new-section-in-an-elf-file</a></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Alright, buckle up, because we&rsquo;ve just taken a deep dive into the wild world of ELF section headers! Picture this -</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   ┌───────────────────────────┐
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │      File Header          │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │     Program Header        │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │      Section 1            │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │      Section 2            │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │      Section 3            │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │      Section 4            │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │      Section 5            │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │     Section 6             │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   ├───────────────────────────┤
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │     Section Header        │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   │                           │
</span></span><span class="line"><span class="cl">   └───────────────────────────┘
</span></span></code></pre></div><p>Think of sections as pieces of a puzzle, each unique in size and placed at different offsets within the file. But fear not, for the section headers play the role of meticulous architects, documenting these diverse sections&rsquo; whereabouts and characteristics. They&rsquo;re the cool blueprints that grant us insight into the entire file&rsquo;s layout and functionality.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ELF Chronicles: ELF file Header</title>
      <link>https://ayedaemon.github.io/post/2023/10/elf-chronicles-elf-header/</link>
      <pubDate>Wed, 18 Oct 2023 13:34:57 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/10/elf-chronicles-elf-header/</guid>
      <description>Exploring ELF file headers</description>
      <content:encoded><![CDATA[<h2 id="hexdumps">Hexdumps</h2>
<p>In the fascinating world of computers, we&rsquo;re stuck conversing in binary, a rather dull language of just <em>ones</em> and <em>zeros</em>. But because we <em>mere</em> humans love things to be a tad more exciting and concise, we&rsquo;ve come up with our own nifty number system - &ldquo;<code>hexadecimal</code>&rdquo; or &ldquo;<code>hex</code>&rdquo; for short. This system ditches the binary bore and adds a touch of flair with 16 snazzy symbols. It&rsquo;s got your usual digits from <code>0 to 9</code>, plus those fancy <code>A to F</code> letters to make data a bit more, well, <em>hexadecimal-chic</em>!</p>
<p>Now, let&rsquo;s take a gander at this binary enigma, a message that only the most extraordinary folks can decipher with ease:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">011010000110010101101100011011000110111100001010
</span></span></code></pre></div><p>For us ordinary humans, this is a bit like deciphering alien hieroglyphics. So, we follow a procedure to unravel the secrets hidden within.</p>
<p>Step one involves breaking down the binary data into byte-sized chunks, each containing 8 bits:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">01101000 01100101 01101100 01101100 01101111 00001010
</span></span></code></pre></div><p>Now, we embark on the magical journey of converting each chunk into its hexadecimal form. The legendary figures of the past might have used pen and paper, but in our tech-savvy era, we turn to tools like <a href="https://cyberchef.org/#recipe=From_Binary('Space',8)To_Hex('Space',0)&amp;input=MDExMDEwMDAgMDExMDAxMDEgMDExMDExMDAgMDExMDExMDAgMDExMDExMTEgMDAwMDEwMTA">CyberChef</a>.</p>
<p>No matter your chosen method, the results remains the same:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">68 65 6c 6c 6f 0a
</span></span></code></pre></div><p>The binary code&rsquo;s cryptic riddle got a facelift, and voilà! We now have this friendly hexadecimal version. It&rsquo;s just what the doctor ordered for us humans to have a casual chat with the binary data, no sweat!</p>
<h2 id="from-code-to-binary">From Code to Binary</h2>
<p>Lets&rsquo;s go on a journey that turns elegant C code into a mysterious binary blob, a language of ones and zeros that only computers understand. (** <em>coughs compilation</em> **)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* file: hello_world.c */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A macro
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define HELLO_MSG1 &#34;Hello World1&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// A global variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span> <span class="n">HELLO_MSG2</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World2&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// local variable for main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">HELLO_MSG3</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World3&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Print messages
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">HELLO_MSG3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>After compiling the above C code we get an ELF (Executable and Linkable Format) file. (Compilation command - <code>gcc hello_world.c -o hello_world</code>)</p>
<p>This generated file, at its core, is nothing more than a delightful binary blob. It&rsquo;s the computer&rsquo;s secret handshake, speaking directly in ones and zeros, no pleasantries. And the icing on the cake is that we <em>mere</em> humans, with our clever programming prowess, can craft tools to translate this binary jargon into friendly hexadecimal, or we can simply cozy up to good ol&rsquo; <code>hexdump</code> and <code>xxd</code> for the job. Whichever suits your fancy, we&rsquo;ve got options!</p>
<h2 id="elf-header">ELF Header</h2>
<p>Here&rsquo;s a snapshot of the first 64 bytes in the compiled binary file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># In binary representation
</span></span><span class="line"><span class="cl">❯ xxd -b -l 64 ./hello_world
</span></span><span class="line"><span class="cl">00000000: 01111111 01000101 01001100 01000110 00000010 00000001  .ELF..
</span></span><span class="line"><span class="cl">00000006: 00000001 00000000 00000000 00000000 00000000 00000000  ......
</span></span><span class="line"><span class="cl">0000000c: 00000000 00000000 00000000 00000000 00000011 00000000  ......
</span></span><span class="line"><span class="cl">00000012: 00111110 00000000 00000001 00000000 00000000 00000000  &gt;.....
</span></span><span class="line"><span class="cl">00000018: 01010000 00010000 00000000 00000000 00000000 00000000  P.....
</span></span><span class="line"><span class="cl">0000001e: 00000000 00000000 01000000 00000000 00000000 00000000  ..@...
</span></span><span class="line"><span class="cl">00000024: 00000000 00000000 00000000 00000000 00101000 00110101  ....(5
</span></span><span class="line"><span class="cl">0000002a: 00000000 00000000 00000000 00000000 00000000 00000000  ......
</span></span><span class="line"><span class="cl">00000030: 00000000 00000000 00000000 00000000 01000000 00000000  ....@.
</span></span><span class="line"><span class="cl">00000036: 00111000 00000000 00001101 00000000 01000000 00000000  8...@.
</span></span><span class="line"><span class="cl">0000003c: 00011110 00000000 00011101 00000000                    ....
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># In hex representation
</span></span><span class="line"><span class="cl">❯ xxd -l 64 ./hello_world
</span></span><span class="line"><span class="cl">00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
</span></span><span class="line"><span class="cl">00000010: 0300 3e00 0100 0000 5010 0000 0000 0000  ..&gt;.....P.......
</span></span><span class="line"><span class="cl">00000020: 4000 0000 0000 0000 2835 0000 0000 0000  @.......(5......
</span></span><span class="line"><span class="cl">00000030: 0000 0000 4000 3800 0d00 4000 1e00 1d00  ....@.8...@.....
</span></span></code></pre></div><p>Now, you may wonder, what on earth does this mean? Well, these intriguing bytes are like puzzle pieces, and depending on the machine type, they map to specific structures in the Linux kernel. Our quest, quite simply, is to unravel this digital enigma and shed light on the code&rsquo;s purpose.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf.h#L207
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define EI_NIDENT	16
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">elf32_hdr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">e_ident</span><span class="p">[</span><span class="n">EI_NIDENT</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_machine</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Word</span>	<span class="n">e_version</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Addr</span>	<span class="n">e_entry</span><span class="p">;</span>  <span class="cm">/* Entry point */</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Off</span>	    <span class="n">e_phoff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Off</span>	    <span class="n">e_shoff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Word</span>	<span class="n">e_flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_ehsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_phentsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_phnum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_shentsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_shnum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf32_Half</span>	<span class="n">e_shstrndx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Elf32_Ehdr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">elf64_hdr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">e_ident</span><span class="p">[</span><span class="n">EI_NIDENT</span><span class="p">];</span>	<span class="cm">/* ELF &#34;magic number&#34; */</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_machine</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Word</span>    <span class="n">e_version</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Addr</span>    <span class="n">e_entry</span><span class="p">;</span>		<span class="cm">/* Entry point virtual address */</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Off</span>     <span class="n">e_phoff</span><span class="p">;</span>		<span class="cm">/* Program header table file offset */</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Off</span>     <span class="n">e_shoff</span><span class="p">;</span>		<span class="cm">/* Section header table file offset */</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Word</span>    <span class="n">e_flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_ehsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_phentsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_phnum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_shentsize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_shnum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Elf64_Half</span>    <span class="n">e_shstrndx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">Elf64_Ehdr</span><span class="p">;</span>
</span></span></code></pre></div><p>Since I&rsquo;m on a 64 bit system, I&rsquo;ll use <code>Elf64_Ehdr</code> to show what each byte in the above data chunk represents.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ xxd -l 64 ./hello_world
</span></span><span class="line"><span class="cl">00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
</span></span><span class="line"><span class="cl">00000010: 0300 3e00 0100 0000 5010 0000 0000 0000  ..&gt;.....P.......
</span></span><span class="line"><span class="cl">00000020: 4000 0000 0000 0000 2835 0000 0000 0000  @.......(5......
</span></span><span class="line"><span class="cl">00000030: 0000 0000 4000 3800 0d00 4000 1e00 1d00  ....@.8...@.....
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// After mapping the linux ELF struct to the above data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e_ident[16] = 7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">e_type      = 03 00
</span></span><span class="line"><span class="cl">e_machine   = 3e 00
</span></span><span class="line"><span class="cl">e_version   = 01 00 00 00
</span></span><span class="line"><span class="cl">e_entry     = 50 10 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">e_phoff     = 40 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">e_shoff     = 28 35 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">e_flags     = 00 00 00 00
</span></span><span class="line"><span class="cl">e_ehsize    = 40 00
</span></span><span class="line"><span class="cl">e_phentsize = 38 00
</span></span><span class="line"><span class="cl">e_phnum     = 0d 00
</span></span><span class="line"><span class="cl">e_shentsize = 40 00
</span></span><span class="line"><span class="cl">e_shnum     = 1e 00
</span></span><span class="line"><span class="cl">e_shstrndx  = 1d 00
</span></span></code></pre></div><p>Shall we dissect each of these mysterious members in the struct?</p>
<p><img loading="lazy" src="https://media.giphy.com/media/QaNQJZhjd2QrDUBNcg/giphy.gif#center" alt=""  />
</p>
<h3 id="1-e_identei_nident">1. <strong>e_ident[EI_NIDENT]</strong></h3>
<p>The first 16 bytes of the ELF header are collectively referred to as the &ldquo;ident&rdquo; or &ldquo;identification&rdquo; field. It includes a magic number and various identification information. Here is a table that tells more about what all identification information is present in it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">e_ident[16] = 7f45 4c46 0201 0100 0000 0000 0000 0000
</span></span><span class="line"><span class="cl">    EI_MAG0 = 7f
</span></span><span class="line"><span class="cl">    EI_MAG1 = 45 (E)
</span></span><span class="line"><span class="cl">    EI_MAG2 = 4c (L)
</span></span><span class="line"><span class="cl">    EI_MAG3 = 46 (F)
</span></span><span class="line"><span class="cl">    EI_CLASS = 02
</span></span><span class="line"><span class="cl">    EI_DATA = 01
</span></span><span class="line"><span class="cl">    EI_VERSION = 01
</span></span><span class="line"><span class="cl">    EI_OSABI = 00
</span></span><span class="line"><span class="cl">    EI_ABIVERSION = 00
</span></span><span class="line"><span class="cl">    EI_PAD = 00 0000 0000 0000
</span></span></code></pre></div><p>Ah, you might wonder, &ldquo;How on earth do I know this?&rdquo; Well, my friend, it&rsquo;s a detective game we play, and our magnifying glass is the kernel source code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf.h#L334
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#define	EI_MAG0		0		/* e_ident[] indexes */
</span></span><span class="line"><span class="cl">#define	EI_MAG1		1
</span></span><span class="line"><span class="cl">#define	EI_MAG2		2
</span></span><span class="line"><span class="cl">#define	EI_MAG3		3
</span></span><span class="line"><span class="cl">#define	EI_CLASS	4       /* 1=32Bit; 2=64Bit */
</span></span><span class="line"><span class="cl">#define	EI_DATA		5       /* Endianness ==&gt; 1=Little; 2=Big */
</span></span><span class="line"><span class="cl">#define	EI_VERSION	6       /* ELF header version */
</span></span><span class="line"><span class="cl">#define	EI_OSABI	7       /* OS ABI ==&gt; 0=None(same as SysV); 3=Linux */
</span></span><span class="line"><span class="cl">#define	EI_PAD		8       /* Starting of padding - currently unused */
</span></span></code></pre></div><p><strong>==&gt;</strong> This information tells me that my ELF binary is a <code>64-Bit</code> (EI_CLASS = 02), <code>Little</code> endian (EI_DATA = 01) binary.</p>
<h3 id="2-e_type">2. <strong>e_type</strong></h3>
<p>This member tells what type of ELF file it is.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf.h#L69
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#define ET_NONE   0         // No file type
</span></span><span class="line"><span class="cl">#define ET_REL    1
</span></span><span class="line"><span class="cl">#define ET_EXEC   2
</span></span><span class="line"><span class="cl">#define ET_DYN    3
</span></span><span class="line"><span class="cl">#define ET_CORE   4
</span></span><span class="line"><span class="cl">#define ET_LOPROC 0xff00    // Processor-specific
</span></span><span class="line"><span class="cl">#define ET_HIPROC 0xffff    // Processor-specific
</span></span></code></pre></div><p>Since my binary is little endian, <code>e_type = 03 00</code> should be read as <code>e_type = 00 03</code>. That tells me that I&rsquo;ve a <code>ET_DYN</code> type of file.</p>
<h3 id="3-e_machine">3. <strong>e_machine</strong></h3>
<p>This member tells us about the target architecture for the file. In linux kernel uapi, there is <a href="https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf-em.h">a complete header file dedicated for target machines</a>.</p>
<p>For my binary file, machine type is <code>3e</code> (e_machine = <em>3e 00</em>; Should be read as <em>00 3e</em>).</p>
<p><em>(Integer representation of <code>3e</code> is <code>62</code>)</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf-em.h#L31
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#define EM_X86_64	62	/* AMD x86-64 */
</span></span></code></pre></div><h3 id="4-e_version">4. <strong>e_version</strong></h3>
<p>This member specifies the version of the ELF file. This is different from the <code>EI_VERSION</code> which tells only about the ELF header version.</p>
<p>For my binary file, version is <code>1</code> (remember, to convert the value to little endian)</p>
<p>These are the versions defined in linux kernel uapi header</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#define EV_NONE		0		/* e_version, EI_VERSION */
</span></span><span class="line"><span class="cl">#define EV_CURRENT	1
</span></span><span class="line"><span class="cl">#define EV_NUM		2
</span></span></code></pre></div><h3 id="5-e_entry">5. <strong>e_entry</strong></h3>
<p>This member is quite interesting. This tells about the virtual/memory address where program execution begins. This is the starting point of the program.</p>
<p>You might think, &ldquo;Aha, this must always point to the <code>main()</code> function!&rdquo; Well, here&rsquo;s a plot twist for you!</p>
<p>For my binary file, the entry point is <code>1050</code> (e_entry = 50 10 00 00 00 00 00 00).</p>
<p>According to our trusty <code>objdump</code>, this value does not point to the <code>main</code> function but points to the <code>_start</code> function. <em>(..which in turn executes the <code>main</code> function. Here is <a href="https://ayedaemon.github.io/post/2022/01/debugging-c-code/#the-whole-picture">an article</a> that explains this.)</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ objdump  -D --disassembler-options=intel hello_world | grep -i &#34;1050&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0000000000001050 &lt;_start&gt;:
</span></span></code></pre></div><h3 id="6-e_phoff">6. <strong>e_phoff</strong></h3>
<p>This is the program header offset. The starting point in the ELF file where program headers can be found.</p>
<h3 id="7-e_shoff">7. <strong>e_shoff</strong></h3>
<p>Just like <code>e_phoff</code>, this member stores the offset of the section headers of the ELF file.</p>
<h3 id="8-e_flags">8. <strong>e_flags</strong></h3>
<p>This member provides processor-specific flags associated with the file.</p>
<h3 id="9-e_ehsize">9. <strong>e_ehsize</strong></h3>
<p>This member tells the size of the the ELF header. For my binary, value of this member is <code>40</code> (64 in decimal). Now you take a guess why I started analyzing first 64 bytes of the file.</p>
<h3 id="10-e_phentsize">10. <strong>e_phentsize</strong></h3>
<p>This is the size of each entry in program header.</p>
<h3 id="11-e_phnum">11. <strong>e_phnum</strong></h3>
<p>This is the count of entries in program header</p>
<h3 id="12-e_shentsize">12. <strong>e_shentsize</strong></h3>
<p>This is the size of each entry in section header.</p>
<h3 id="13-e_shnum">13. <strong>e_shnum</strong></h3>
<p>This is the count of entries in section header</p>
<h3 id="14-e_shstrndx">14. <strong>e_shstrndx</strong></h3>
<p>Now, this little guy is what we call the &ldquo;Section string index&rdquo;. This points to the index in section headers which holds all of the strings.</p>
<p><em>(We&rsquo;ll talk more about section headers and program headers in later articles.)</em></p>
<h2 id="practicals">Practicals</h2>
<h3 id="how-to-edit-a-binary-file">How to edit a binary file?</h3>
<p>If you think it through, you just need a program that can read/write binary data and convert that data to hex for us to view. You can build your own tool to do this or you can use other tools that can already do this.</p>
<p>I would like to propose my favorite - <code>vim</code> + <code>xxd</code></p>
<p>Here are the steps to it.</p>
<ul>
<li>Open the file in vim in binary mode (use <code>-b</code> flag)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">vim -b argv_printer
</span></span></code></pre></div><ul>
<li>Pass the data to <code>xxd</code> (you can also use the additional flags that xxd supports)
<ul>
<li>Press <code>:</code> to go into commmand mode</li>
<li>then type <code>%!xxd -c 1</code> to pass the binary data through this command.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">:%!xxd -c 1
</span></span></code></pre></div><ul>
<li>Edit the hex values you want (just like you would edit any other text file, press <code>i</code> and go on)</li>
<li>Reverse the hex to binary
<ul>
<li>Go to command mode again by pressing <code>:</code></li>
<li>then type <code>%!xxd -r</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">:%!xxd -r
</span></span></code></pre></div><ul>
<li>Now save and quit the vim editor
<ul>
<li>If you don&rsquo;t know steps for that consider learning vim first</li>
<li>or, use another hex editor</li>
</ul>
</li>
</ul>
<h3 id="change-the-elf-magic-number">Change the ELF magic number</h3>
<ul>
<li>Open the file with vim and edit the <code>EI_MAG</code> part.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Before
</span></span><span class="line"><span class="cl">  00000000: 7f  .
</span></span><span class="line"><span class="cl">  00000001: 45  E
</span></span><span class="line"><span class="cl">  00000002: 4c  L
</span></span><span class="line"><span class="cl">  00000003: 46  F
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># After
</span></span><span class="line"><span class="cl">  00000000: 7f  .
</span></span><span class="line"><span class="cl">  00000001: 48  E
</span></span><span class="line"><span class="cl">  00000002: 45  L
</span></span><span class="line"><span class="cl">  00000003: 58  F
</span></span></code></pre></div><p><em>Note that I&rsquo;ve only changed the hex values and not the ascii values for it.</em></p>
<ul>
<li>revert the hex to binary data (<code>:%!xxd -r</code>)</li>
<li>write and quit vim (I&rsquo;m still not telling you the command)</li>
<li>analyze it</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">❯ ./hello_world
</span></span><span class="line"><span class="cl">zsh: exec format error: ./hello_world
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">❯ readelf --file-header --wide hello_world
</span></span><span class="line"><span class="cl">readelf: Error: Not an ELF file - it has the wrong magic bytes at the start
</span></span></code></pre></div><p>The reason for this behaviour is written in kernel code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">https://elixir.bootlin.com/linux/v6.5.7/source/include/uapi/linux/elf.h#L348
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define	ELFMAG		&#34;\177ELF&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define	SELFMAG		4
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">https://elixir.bootlin.com/linux/v6.5.7/source/fs/binfmt_elf.c#L848
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOEXEC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">memcmp</span><span class="p">(</span><span class="n">elf_ex</span><span class="o">-&gt;</span><span class="n">e_ident</span><span class="p">,</span> <span class="n">ELFMAG</span><span class="p">,</span> <span class="n">SELFMAG</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="change-the-executable-class-64-bit---32-bit">Change the executable class (64 bit -&gt; 32 bit)</h3>
<ul>
<li>Open the file with vim and edit the <code>EI_CLASS</code> part.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Before
</span></span><span class="line"><span class="cl">  00000004: 02  .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># After
</span></span><span class="line"><span class="cl">  00000004: 01  .
</span></span></code></pre></div><ul>
<li>revert the hex to binary data (<code>:%!xxd -r</code>)</li>
<li>write and quit vim (I&rsquo;m still not telling you the command)</li>
<li>analyze it</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Runs perfectly fine
</span></span><span class="line"><span class="cl">❯ ./hello_world
</span></span><span class="line"><span class="cl">Hello World1
</span></span><span class="line"><span class="cl">Hello World2
</span></span><span class="line"><span class="cl">Hello World3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># file command tells another tale
</span></span><span class="line"><span class="cl">❯ file hello_world
</span></span><span class="line"><span class="cl">hello_world: ELF 32-bit LSB pie executable, x86-64, version 1 (SYSV), no program header, no section header
</span></span></code></pre></div><p>This is clearly a parsing problem. There are no checks on the kernel for the <code>EI_CLASS</code> (or I should say I could not find any, if you find one, please let me know.)</p>
<h3 id="more-diy-kind-of">&hellip;more (DIY, kind of)</h3>
<p>There are few more interesting things you can play around with</p>
<ul>
<li><code>EI_OSABI</code></li>
<li><code>e_machine</code></li>
<li><code>e_entry</code></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>ELF headers emerge as the silent orchestrators of the executable files&hellip; The backstage bosses of the show. In this article, we cracked open their secrets (with not-so-real-world tricks) and diving into their nitty-gritty using hexdumps. Think of this as the cool architect of the software world, shaping how things work under the hood.</p>
<p>Mastering these headers is like getting a backstage pass to rock the binary world - tweaking, fixing, and making stuff dance to your tune. So next time you run an executable on *unix machines, remember, ELF header are the groove makers behind the scenes!</p>
<hr>
<h2 id="useful-links">Useful links</h2>
<ol>
<li>(ELF Specification 1.1) <a href="https://flint.cs.yale.edu/cs422/doc/ELF_Format.pdf">https://flint.cs.yale.edu/cs422/doc/ELF_Format.pdf</a></li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Intro to Re: C : part-4</title>
      <link>https://ayedaemon.github.io/post/2023/05/intro-to-re-part-4/</link>
      <pubDate>Mon, 01 May 2023 02:34:50 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/05/intro-to-re-part-4/</guid>
      <description>Some things about process and stack memory</description>
      <content:encoded><![CDATA[<p>When an operating system (OS) runs a program, the program is first loaded into main memory. Memory is utilized for both program&rsquo;s machine instructions and program&rsquo;s data&hellip;this includes parameters, dynamic variables, (un)initialized variables, and so on.</p>
<p>Most computers today use paged memory allocations, which allow the amount of memory assigned to a program to increase/decrease as the needs of the application change. Memory is allocated to the program and reclaimed by the operating system in fixed-size chunks known as <code>pages</code>. When a program is loaded into a paged-memory computer, the operating system initially allocates a small number of pages to the program and then allocates additional memory as needed.</p>
<p>On a linux machine you can check the memory layout of a running program using <code>cat /proc/&lt;proc_id&gt;/map</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt; cat /proc/self/maps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">55f5db535000-55f5db537000 r--p 00000000 08:02 917947                     /usr/bin/cat
</span></span><span class="line"><span class="cl">55f5db537000-55f5db53b000 r-xp 00002000 08:02 917947                     /usr/bin/cat
</span></span><span class="line"><span class="cl">55f5db53b000-55f5db53d000 r--p 00006000 08:02 917947                     /usr/bin/cat
</span></span><span class="line"><span class="cl">55f5db53d000-55f5db53e000 r--p 00007000 08:02 917947                     /usr/bin/cat
</span></span><span class="line"><span class="cl">55f5db53e000-55f5db53f000 rw-p 00008000 08:02 917947                     /usr/bin/cat
</span></span><span class="line"><span class="cl">55f5dd440000-55f5dd461000 rw-p 00000000 00:00 0                          [heap]
</span></span><span class="line"><span class="cl">7f0db2800000-7f0db2aea000 r--p 00000000 08:02 929341                     /usr/lib/locale/locale-archive
</span></span><span class="line"><span class="cl">7f0db2ba4000-7f0db2bc9000 rw-p 00000000 00:00 0 
</span></span><span class="line"><span class="cl">7f0db2bc9000-7f0db2beb000 r--p 00000000 08:02 923932                     /usr/lib/libc.so.6
</span></span><span class="line"><span class="cl">7f0db2beb000-7f0db2d45000 r-xp 00022000 08:02 923932                     /usr/lib/libc.so.6
</span></span><span class="line"><span class="cl">7f0db2d45000-7f0db2d9d000 r--p 0017c000 08:02 923932                     /usr/lib/libc.so.6
</span></span><span class="line"><span class="cl">7f0db2d9d000-7f0db2da1000 r--p 001d4000 08:02 923932                     /usr/lib/libc.so.6
</span></span><span class="line"><span class="cl">7f0db2da1000-7f0db2da3000 rw-p 001d8000 08:02 923932                     /usr/lib/libc.so.6
</span></span><span class="line"><span class="cl">7f0db2da3000-7f0db2db2000 rw-p 00000000 00:00 0 
</span></span><span class="line"><span class="cl">7f0db2dd0000-7f0db2dd1000 r--p 00000000 08:02 923793                     /usr/lib/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">7f0db2dd1000-7f0db2df7000 r-xp 00001000 08:02 923793                     /usr/lib/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">7f0db2df7000-7f0db2e01000 r--p 00027000 08:02 923793                     /usr/lib/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">7f0db2e01000-7f0db2e03000 r--p 00031000 08:02 923793                     /usr/lib/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">7f0db2e03000-7f0db2e05000 rw-p 00033000 08:02 923793                     /usr/lib/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">7ffd55089000-7ffd550aa000 rw-p 00000000 00:00 0                          [stack]
</span></span><span class="line"><span class="cl">7ffd550f6000-7ffd550fa000 r--p 00000000 00:00 0                          [vvar]
</span></span><span class="line"><span class="cl">7ffd550fa000-7ffd550fc000 r-xp 00000000 00:00 0                          [vdso]
</span></span><span class="line"><span class="cl">ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]
</span></span></code></pre></div><p>When you read the contents of <code>/proc/self/map</code>, you will encounter multiple lines, with each line representing a separate memory mapping region. Each line contains various fields separated by whitespace, representing different attributes of the memory mapping. The common fields include:</p>
<ul>
<li><strong>Start and End Addresses</strong>: The starting and ending virtual addresses of the memory mapping region.</li>
<li><strong>Permissions</strong>: The permissions assigned to the memory mapping, such as read, write, and execute.</li>
<li><strong>Offset</strong>: The offset in the file (if the mapping is backed by a file) or zero otherwise.</li>
<li><strong>Device and Inode</strong>: The device and inode number of the file backing the mapping.</li>
<li><strong>File descriptor</strong>: If the mapping is associated with a file opened by the process, the file descriptor number is mentioned in this field.</li>
<li><strong>Flags</strong>: Additional flags indicating special characteristics of the mapping.</li>
<li><strong>Inode and Path</strong>: The inode number and path of the file backing the mapping (if available).</li>
</ul>
<h2 id="memory-layout-of-a-process">Memory layout of a process</h2>
<p>Memory space allocated to a running program/process is called process memory (AKA virtual memory). It allows multiple programs to run concurrently and provides each program with a dedicated and isolated memory space. The purpose of process memory is to facilitate the execution of programs by providing a private address space for each process, shielding them from interfering with one another.</p>
<p>A typical memory layout consists of many segments.</p>
<ol>
<li>Text segment (code segment)</li>
<li>Initialized data segment (data segment)</li>
<li>Uninitialized data segment (bss segment)</li>
<li>Heap</li>
<li>Stack</li>
</ol>
<h3 id="text-segment-code-segment">Text segment (Code Segment)</h3>
<p>The code segment contains the executable instructions of the program. It is typically read-only and stores the program&rsquo;s machine code instructions, constants, and literals.</p>
<h3 id="initialized-data-segment-data-segment">Initialized data segment (Data Segment)</h3>
<p>This segment contains initialized static variables like global variables and local static variables which have a defined value and can be modified.</p>
<h3 id="uninitialized-data-segment-bss-segment">Uninitialized data segment (BSS Segment)</h3>
<p>This segment contains uninitialized static data, both variables and constants. On most systems, kernel automatically zeros this segment.</p>
<h3 id="heap">Heap</h3>
<p>This segment contains dynamically allocated memory. It is usually managed by malloc, calloc, realloc, free (and their sibling functions too). The heap segment is shared by all threads, shared libraries, and dynamically loaded modules in a process. Heap memory segment grows towards higher memory addresses.</p>
<h3 id="stack">Stack</h3>
<p>This region of memory is used for managing function calls and local variables. It is an essential part of the execution environment and plays a crucial role in program flow control.</p>
<p>This is typically located in higher parts of the memory and grows towards lower parts (towards heap memory). A <strong>stack pointer</strong> register keeps track of the top of the stack, this gets adjusted each time a new value is pushed to or poped from the stack.</p>
<p><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Program_memory_layout.pdf/page1-225px-Program_memory_layout.pdf.jpg#center" alt=""  />
</p>
<p>This is what the whole memory layout looks like altogether, but in this article we are focusing mainly on stack segment.</p>
<h2 id="more-about-stack-practical">More about stack (practical)</h2>
<p>Stack memory is organized into stack frames, each representing the activation record of a function call. A stack frame contains information such as function parameters, local variables, return addresses, and other metadata necessary for function execution.</p>
<p>Let&rsquo;s start with a simple example of function calls to understand how stack works.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Prints are garbage value from stack and returns the same.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">func2</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">var2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;var2 (%p) = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var2</span><span class="p">,</span> <span class="n">var2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">var2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Prints var1 value as 55 and returns it.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">func1</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">var1</span> <span class="o">=</span> <span class="mi">55</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;var1 (%p) = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">var1</span><span class="p">,</span> <span class="n">var1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">var1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Calls both functions and stores their return values
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="kt">int</span> <span class="n">v1</span> <span class="o">=</span> <span class="nf">func1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">   <span class="kt">int</span> <span class="n">v2</span> <span class="o">=</span> <span class="nf">func2</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Compares their return values and print message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="k">if</span><span class="p">(</span><span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Both values are equal</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Both values are not equal</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>To get a better understanding for this, I&rsquo;ll put this down in steps of what this program will do upon execution.</p>
<ol>
<li>Call <code>func1()</code>, get a return value and store that in <code>v1</code> variable.</li>
<li>Call <code>func2()</code>, get a return value and store that in <code>v2</code> variable</li>
<li>Compare both values and print appropriate message.</li>
</ol>
<p>That&rsquo;s it. Quite straightforward, isn&rsquo;t it?. Let&rsquo;s see the output of this program before jumping to conclusions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">var1 (0x7ffeaf266d1c) = 55
</span></span><span class="line"><span class="cl">var2 (0x7ffeaf266d1c) = 55
</span></span><span class="line"><span class="cl">Both values are equal
</span></span></code></pre></div><p><img loading="lazy" src="https://media.giphy.com/media/edGzBC6GDOhutW32ps/giphy.gif#center" alt=""  />
</p>
<p>Both <code>var1</code> and <code>var2</code> have same values and infact have same memory addresses&hellip; even though they belong to different functions and have separate stack frame and everything.</p>
<p>To understand this we&rsquo;ll have to go deeper with a debugger (I&rsquo;m using GDB).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">disas</span> <span class="n">main</span>
</span></span><span class="line"><span class="cl"><span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="nl">main</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011a6</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	    <span class="n">push</span>   <span class="n">rbp</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011a7</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Creating space in stack for variables. 0x10 is 16 bytes (4 bytes for each int variable)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="c1">// 4(v1) + 4(v2) + 8 (padding)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011aa</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	    <span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Function call and store value in [rbp-0x4]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011ae</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011b3</span> <span class="o">&lt;+</span><span class="mi">13</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1174</span> <span class="o">&lt;</span><span class="n">func1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011b8</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span><span class="n">eax</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Another function call and store value in [rbp-0x8]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011bb</span> <span class="o">&lt;+</span><span class="mi">21</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011c0</span> <span class="o">&lt;+</span><span class="mi">26</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1149</span> <span class="o">&lt;</span><span class="n">func2</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011c5</span> <span class="o">&lt;+</span><span class="mi">31</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">],</span><span class="n">eax</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Compare values stored in [rbp-0x4] &amp; [rbp-0x8]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011c8</span> <span class="o">&lt;+</span><span class="mi">34</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011cb</span> <span class="o">&lt;+</span><span class="mi">37</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// if not equal then jump to &lt;main+59&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011ce</span> <span class="o">&lt;+</span><span class="mi">40</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x11e1</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">59</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// else print this message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011d0</span> <span class="o">&lt;+</span><span class="mi">42</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xe4d</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x2024</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011d7</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011da</span> <span class="o">&lt;+</span><span class="mi">52</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1030</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// And finally jump to &lt;main+74&gt; (epilogue)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011df</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x11f0</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">74</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// if comparision failed: land here and print this message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011e1</span> <span class="o">&lt;+</span><span class="mi">59</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xe52</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x203a</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011e8</span> <span class="o">&lt;+</span><span class="mi">66</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011eb</span> <span class="o">&lt;+</span><span class="mi">69</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1030</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="c1">// Finally epilogue - set return value and leave
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011f0</span> <span class="o">&lt;+</span><span class="mi">74</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xa</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011f5</span> <span class="o">&lt;+</span><span class="mi">79</span><span class="o">&gt;:</span>	<span class="n">leave</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011f6</span> <span class="o">&lt;+</span><span class="mi">80</span><span class="o">&gt;:</span>	<span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</span></span></code></pre></div><p>In the disassembly code, the <code>main</code> function calls both the functions and stores their respective return values in <code>[rbp-0x4]</code> and <code>[rbp-0x8]</code> memory locations. Since these variables are specific to <code>main</code> function, they will be created in the stack memory (inside the stack frame for <code>main</code> function).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">disas</span> <span class="n">func1</span>
</span></span><span class="line"><span class="cl"><span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="nl">func1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x0000000000001174</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	    <span class="n">push</span>   <span class="n">rbp</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001175</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Create memory for the variable -- 4(var1) + 12(padding) = 16 (0x10)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x0000000000001178</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	    <span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Store 0x37(55) in [rbp-0x4]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x000000000000117c</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">],</span><span class="mh">0x37</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Print this value with a specific message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x0000000000001183</span> <span class="o">&lt;+</span><span class="mi">15</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001186</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000118a</span> <span class="o">&lt;+</span><span class="mi">22</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rsi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000118d</span> <span class="o">&lt;+</span><span class="mi">25</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xe80</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x2014</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001194</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001197</span> <span class="o">&lt;+</span><span class="mi">35</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000119c</span> <span class="o">&lt;+</span><span class="mi">40</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1040</span> <span class="o">&lt;</span><span class="n">printf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Epilogue: set this value as return value and leave
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x00000000000011a1</span> <span class="o">&lt;+</span><span class="mi">45</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011a4</span> <span class="o">&lt;+</span><span class="mi">48</span><span class="o">&gt;:</span>	<span class="n">leave</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x00000000000011a5</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>	<span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</span></span></code></pre></div><p>The above function, when called, will create another stack frame just after the main function&rsquo;s stack frame&hellip; and will create it&rsquo;s local variables in that region.</p>
<p>This function will print the value of the local variable and then return back to the main function. This action will remove the stack frame created by resetting the stack pointer and base pointer register values&hellip; BUT the actual values stored in memory location is still not overwritten by anything. So technically, the values are still present there and can be accessed if the memory location can be pointed to.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">disas</span> <span class="n">func2</span>
</span></span><span class="line"><span class="cl"><span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="nl">func2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x0000000000001149</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	    <span class="n">push</span>   <span class="n">rbp</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000114a</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Create memory for the variable -- 4(var2) + 12(padding) = 16 (0x10)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x000000000000114d</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	    <span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Print the value with a specific message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x0000000000001151</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>	    <span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001154</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001158</span> <span class="o">&lt;+</span><span class="mi">15</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rsi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000115b</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xea2</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x2004</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001162</span> <span class="o">&lt;+</span><span class="mi">25</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001165</span> <span class="o">&lt;+</span><span class="mi">28</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x000000000000116a</span> <span class="o">&lt;+</span><span class="mi">33</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x1040</span> <span class="o">&lt;</span><span class="n">printf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// Epilogue: set this value as return value and leave
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="mh">0x000000000000116f</span> <span class="o">&lt;+</span><span class="mi">38</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001172</span> <span class="o">&lt;+</span><span class="mi">41</span><span class="o">&gt;:</span>	<span class="n">leave</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x0000000000001173</span> <span class="o">&lt;+</span><span class="mi">42</span><span class="o">&gt;:</span>	<span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</span></span></code></pre></div><p>After the <code>func1</code> has returned, it&rsquo;s time for <code>func2</code> to create it&rsquo;s own stack frame and it&rsquo;s own local variables.</p>
<p>Coincidently, the memory location used by <code>func2</code> is exactly the same location that was used by <code>func1</code> earlier. And on top of that, both functions have <code>int</code> type variables which means that the memory location used by <code>var1</code> in <code>func1</code> will be used by <code>var2</code> in <code>func2</code>.</p>
<p>Stack frame for both functions will <em>kind of</em> overlap each other. That should explain why we we&rsquo;re getting the same results and same memory locations in the program output earlier.</p>
<p>This theory should be enough to understand what&rsquo;s going on&hellip;. But practical is more fun. Accept it!!</p>
<p><img loading="lazy" src="https://media.giphy.com/media/hu0tQXRqT06YOFvd8D/giphy.gif#center" alt=""  />
</p>
<p>I&rsquo;m going to place some breakpoints in the code and check the status of the stack on each hit. For me, such interesting points are where new variables or function&rsquo;s stack frame will be created. This will help me to analyze the change in stack as we go forward.</p>
<p>(<em><strong>NOTE</strong>: Sometimes I over-use breakpoints. Don&rsquo;t judge me :|</em> )</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">info</span> <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">Num</span>     <span class="n">Type</span>           <span class="n">Disp</span> <span class="n">Enb</span> <span class="n">Address</span>            <span class="n">What</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551a6 &lt;main+0&gt;:	    push   rbp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551a6</span> <span class="n">in</span> <span class="n">main</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551aa &lt;main+4&gt;:	    sub    rsp,0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551aa</span> <span class="n">in</span> <span class="n">main</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551b3 &lt;main+13&gt;:	call   0x555555555174 &lt;func1&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">3</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551b3</span> <span class="n">in</span> <span class="n">main</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">17</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551c0 &lt;main+26&gt;:	call   0x555555555149 &lt;func2&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">4</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551c0</span> <span class="n">in</span> <span class="n">main</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">18</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551f5 &lt;main+79&gt;:	leave
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">5</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551f5</span> <span class="n">in</span> <span class="n">main</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">26</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x555555555174 &lt;func1&gt;:	    push   rbp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">6</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x0000555555555174</span> <span class="n">in</span> <span class="n">func1</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x555555555178 &lt;func1+4&gt;:	sub    rsp,0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">7</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x0000555555555178</span> <span class="n">in</span> <span class="n">func1</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x5555555551a5 &lt;func1+49&gt;:	ret
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">8</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x00005555555551a5</span> <span class="n">in</span> <span class="n">func1</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">13</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x555555555149 &lt;func2&gt;:	    push   rbp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">9</span>       <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x0000555555555149</span> <span class="n">in</span> <span class="n">func2</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x55555555514d &lt;func2+4&gt;:	sub    rsp,0x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">10</span>      <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x000055555555514d</span> <span class="n">in</span> <span class="n">func2</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 0x555555555173 &lt;func2+42&gt;:	ret
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">11</span>      <span class="n">breakpoint</span>     <span class="n">keep</span> <span class="n">y</span>   <span class="mh">0x0000555555555173</span> <span class="n">in</span> <span class="n">func2</span> <span class="n">at</span> <span class="n">func_calls</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">7</span>
</span></span></code></pre></div><p>I&rsquo;ve set up 11 break points here which will help me check the change in stack during the execution of the program.</p>
<p>After running the program in debugger, it&rsquo;ll stop at the first break point which is just before the point where <code>main</code> function&rsquo;s stack frame will begin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg <span class="nv">$rsp</span>
</span></span><span class="line"><span class="cl">0x7fffffffe218:	0x00007ffff7de0790	0x00007fffffffe310
</span></span><span class="line"><span class="cl">0x7fffffffe228:	0x00005555555551a6	0x0000000155554040
</span></span><span class="line"><span class="cl">0x7fffffffe238:	0x00007fffffffe328	0x00007fffffffe328
</span></span><span class="line"><span class="cl">0x7fffffffe248:	0x86b5da47f7ba01f3	0x0000000000000000
</span></span><span class="line"><span class="cl">0x7fffffffe258:	0x00007fffffffe338	0x0000555555557dd8
</span></span></code></pre></div><p>Theoretically, we know if we step over another instruction, value from <code>rbp</code> will be stored in the stack. So let&rsquo;s check the value of <code>rbp</code> right now and then monitor the stack (after stepping over) to see if it is the same value we are expecting it to be.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">// Check the base pointer before stepping over instruction
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; p <span class="nv">$rbp</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span> <span class="o">=</span> <span class="o">(</span>void *<span class="o">)</span> 0x1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Check the next instruction to be executed
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; x <span class="nv">$rip</span>
</span></span><span class="line"><span class="cl"><span class="o">=</span>&gt; 0x5555555551a6 &lt;main&gt;:	push   rbp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Step over an instruction
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; ni
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Monitor stack
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg <span class="nv">$rsp</span>
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span><span class="line"><span class="cl">0x7fffffffe240:	0x00007fffffffe328	0x8f2aa2d53bd1951c
</span></span><span class="line"><span class="cl">0x7fffffffe250:	0x0000000000000000	0x00007fffffffe338
</span></span></code></pre></div><p>Now our stack has a new item in it, that is <code>rbp</code> value. If you notice, previously the top of the stack was at <code>0x7fffffffe218</code>, but after adding one item the top of stack is <code>0x7fffffffe210</code>. It decreased, which indicates that stack grows downwards; towards lower memory addresses.</p>
<p>The stack does not change up until the breakpoint 2 on <code>0x5555555551aa &lt;main+4&gt;:	    sub    rsp,0x10</code>&hellip; But on stepping another instruction, we can see a new space of <strong>16 bytes</strong> in the stack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00007ffff7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span><span class="line"><span class="cl">0x7fffffffe240:	0x00007fffffffe328	0x8f2aa2d53bd1951c
</span></span></code></pre></div><p>Before this, the stack pointer was on <code>0x7fffffffe210</code>, now the stack pointer is on <code>0x7fffffffe200</code>&hellip; so <code>0x7fffffffe210 - 0x7fffffffe200 = 0x10 (16)</code>. Simple maths!!</p>
<p>We just moved the stack pointer down to create space required, no cleaning was done&hellip; hence the stack is already filled with some garbage value that resided in the memory long before the stack occupied this new memory region.</p>
<p>Now let&rsquo;s call the function <code>func1</code> and see what that function call will add to the stack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1f8:	0x00005555555551b8	0x0000000000000000
</span></span><span class="line"><span class="cl">0x7fffffffe208:	0x00007ffff7ffdab0	0x0000000000000001
</span></span><span class="line"><span class="cl">0x7fffffffe218:	0x00007ffff7de0790	0x00007fffffffe310
</span></span><span class="line"><span class="cl">0x7fffffffe228:	0x00005555555551a6	0x0000000155554040
</span></span><span class="line"><span class="cl">0x7fffffffe238:	0x00007fffffffe328	0x00007fffffffe328
</span></span></code></pre></div><p>Just after making the function call and before executing the first instruction of the <code>func1</code>, we have a new value in the stack. This new value is the return address for the main function, which will be used to continue execution after the func1 call is finished.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/i 0x00005555555551b8
</span></span><span class="line"><span class="cl">   0x5555555551b8 &lt;main+18&gt;:	mov    DWORD PTR [rbp-0x4],eax
</span></span></code></pre></div><p>(Note: if this value is somehow overwritten, we can make our function to return to another function or instruction. This is something which comes under a technique called Return Oriented Programming aka ROP.)</p>
<p>After the first instruction of the <code>func1</code> function, that is pushing the <code>rbp</code> on the stack, we can see an updated stack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1f0:	0x00007fffffffe210	0x00005555555551b8
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00007ffff7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span></code></pre></div><p>This points to the place where the <code>main</code> function&rsquo;s <code>base pointer</code> is. Think this as a chain like connection which links to the next stop.</p>
<p>Now after creating some space in this new stack frame for <code>var1</code>&hellip;. Stack looks like this. (<em>Notice that the stack keeps on growing down, towards low memory regions.</em>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1e0:	0x0000000000000000	0x0000000000000000
</span></span><span class="line"><span class="cl">0x7fffffffe1f0:	0x00007fffffffe210	0x00005555555551b8
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00007ffff7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span></code></pre></div><p>The <code>leave</code> instruction does a lot of the work. It copies the <code>rbp</code> to <code>rsp</code> and then restores the old <code>rbp</code> from the stack again.</p>
<p>This will move the base pointer back to <code>0x00007fffffffe210</code> and the stack pointer to <code>0x00007fffffffe1f8</code>.</p>
<p>This instruction basically releases a stack frame set up by a function. That means now our new stack will look something like this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1f8:	0x00005555555551b8	0x0000000000000000
</span></span><span class="line"><span class="cl">0x7fffffffe208:	0x00007ffff7ffdab0	0x0000000000000001
</span></span><span class="line"><span class="cl">0x7fffffffe218:	0x00007ffff7de0790	0x00007fffffffe310
</span></span><span class="line"><span class="cl">0x7fffffffe228:	0x00005555555551a6	0x0000000155554040
</span></span><span class="line"><span class="cl">0x7fffffffe238:	0x00007fffffffe328	0x00007fffffffe328
</span></span></code></pre></div><p>The next <code>ret</code> statement will take off the top of the value from stack and move the instruction control to that memory location&hellip; that is, set the <code>rip</code> value to that memory location. This means that the next instruction to be executed will be &lt;main+18&gt; which stores the <code>eax</code> (return value from the previous function call) into <code>[rbp-0x4]</code> location on stack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/i 0x00005555555551b8
</span></span><span class="line"><span class="cl">=&gt; 0x5555555551b8 &lt;main+18&gt;:	mov    DWORD PTR [rbp-0x4],eax
</span></span></code></pre></div><p>So when <code>func1</code> returns back, our stack looks something like this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00007ffff7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span><span class="line"><span class="cl">0x7fffffffe240:	0x00007fffffffe328	0x42033bae0bc1441d
</span></span></code></pre></div><p>Now for the next function <code>func2</code>, our stack is like this, just before the <code>sub    rsp,0x10</code> instruction. This instruction will create enough memory for the variables to be.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1f0:	0x00007fffffffe210	0x00005555555551c5
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00000037f7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span></code></pre></div><p>Once the space in stack memory is created, the stack looks like this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe1e0:	0x0000000000000000	0x0000003700000000
</span></span><span class="line"><span class="cl">0x7fffffffe1f0:	0x00007fffffffe210	0x00005555555551c5
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x00000037f7ffdab0
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span></code></pre></div><p>If you notice, these are the same memory locations which were used by <code>func1</code> to store <code>0x37</code> (<code>mov    DWORD PTR [rbp-0x4],0x37</code>)&hellip;. and since the stack is not cleaned properly, the value from that function is still in the place it was left to be picked by our variable <code>var2</code>.</p>
<p>This can be checked with <code>x/w ($rbp-0x4)</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/w ($rbp-0x4)
</span></span><span class="line"><span class="cl">0x7fffffffe1ec:	0x00000037
</span></span></code></pre></div><p>So the value is just as it was left by <code>func1</code>&hellip; :|</p>
<p>Now after returning back to <code>main</code> function, the stack looks like this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/10xg $rsp
</span></span><span class="line"><span class="cl">0x7fffffffe200:	0x0000000000000000	0x0000003700000037
</span></span><span class="line"><span class="cl">0x7fffffffe210:	0x0000000000000001	0x00007ffff7de0790
</span></span><span class="line"><span class="cl">0x7fffffffe220:	0x00007fffffffe310	0x00005555555551a6
</span></span><span class="line"><span class="cl">0x7fffffffe230:	0x0000000155554040	0x00007fffffffe328
</span></span><span class="line"><span class="cl">0x7fffffffe240:	0x00007fffffffe328	0x42033bae0bc1441d
</span></span></code></pre></div><p>And both <code>v1</code> and <code>v2</code>, are same values and were picked from the same memory locations when in their respective function frames.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; x/w $rbp-0x4
</span></span><span class="line"><span class="cl">0x7fffffffe20c:	0x00000037
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; x/w $rbp-0x8
</span></span><span class="line"><span class="cl">0x7fffffffe208:	0x00000037
</span></span></code></pre></div><p><img loading="lazy" src="https://media.giphy.com/media/3ohzdNuQy40h2dUCGI/giphy.gif#center" alt=""  />
</p>
<p>This explains the <em>somewhat</em> unusual behaviour of the program. There is nothing special about this, its just the way the stack memory works and a well crafted example presented to you.</p>
<p>In next article, I&rsquo;ll try to cover stack overflows&hellip; which is a cool technique to insert the data in a variable which will overflow and overwrite the data for another variable. Try to think around this, if you may.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Intro to Re: C : A Simple Calculator</title>
      <link>https://ayedaemon.github.io/post/2023/04/intro-to-re-simple-calculator/</link>
      <pubDate>Mon, 03 Apr 2023 21:59:48 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/04/intro-to-re-simple-calculator/</guid>
      <description>How to reverse engineer a simple calculator program from scratch</description>
      <content:encoded><![CDATA[<p>We covered a wide range of topics in earlier articles that were helpful in comprehending how many lower-level processes operate. This blog will concentrate on applying those ideas to recreate C program after reverse engineering a simple calculator binary.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/Pmv6m86yGQCjkLjmqx/giphy.gif#center" alt=""  />
</p>
<p>It is always a good idea to observe how the target software responds to various inputs. This gives you a sense of the internal logic that might be operating.</p>
<p>If we run this program without any arguments, we will get an error message stating that we need to pass more arguments as well as the usage guide is printed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ./calc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Not enough arguments passed
</span></span><span class="line"><span class="cl">Usage: ./calc &lt;num1&gt; &lt;operator&gt; &lt;num2&gt;
</span></span></code></pre></div><p>So I can assume that there are checks in place which will see if we&rsquo;ve passed enough arguments. If not, it&rsquo;ll exit with the above message.</p>
<p>So its obvious for anybody now to try it with the arguments this time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ./calc 5 + 3
</span></span><span class="line"><span class="cl">5 + 3 = 8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">❯ ./calc 100 / 5
</span></span><span class="line"><span class="cl">100 / 5 = 20
</span></span></code></pre></div><p>This works now and gives us the required output in a good looking way. That should do it for now.</p>
<p>It&rsquo;s time to open up our hacker tools and disassemble the binary.</p>
<p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">addFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">subFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">mulFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">imul</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">divFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cdq</span>
</span></span><span class="line"><span class="cl">        <span class="nf">idiv</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Not enough arguments passed&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC1:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Usage: ./calc &lt;num1&gt; &lt;operator&gt; &lt;num2&gt;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">die:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">puts</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">puts</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">exit</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC2:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%d %c %d = %d\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">48</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-36</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">],</span> <span class="no">rsi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-36</span><span class="p">],</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L11</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">die</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L11:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">24</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movzx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">],</span> <span class="no">al</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L12</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L14</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">42</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L15</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">43</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jne</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">addFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L14:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">subFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L15:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">mulFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L12:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">divFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L13:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rcx</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">rcx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">edx</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">r8d</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>This is far too large to handle at once. So I&rsquo;ll start with smaller functions and see what they do before moving on to the <code>main</code> function.</p>
<p><em>(In my opinion, there is no specific reverse engineering flow. You could start from anywhere that suits your needs and the project at hand.)</em></p>
<p>Now the first function I&rsquo;ll start with is going to be the <code>addFunc</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">addFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>The first three lines are simply the function&rsquo;s label and prologue.</p>
<p>Then there are two <code>mov</code> statements (lines 4 and 5) that involve <code>edi</code> (first argument) and <code>esi</code> (second argument) (second argument). They are the function arguments passed from the calling function to this function. These values are then saved in the <code>[rbp-4]</code> and <code>[rbp-8]</code> local variables.</p>
<p>Given the variable size requirements (4 bytes each), it is safe to assume that the passed variables are of the <code>int</code> type. That is, we are passing this function two <code>int</code> values.</p>
<p>Then, at lines 6, 7, and 8, we simply load the values from the variables into some registers and then add them up. In this case, the result of the add instruction will be stored in the <code>eax</code> register. Remember, this is also the register where the return value of a function is stored. So when we return back from this function, we have our addition result in the <code>eax</code> register.</p>
<p>Finally, at line 9 &amp; 10, we make a graceful return from the function.</p>
<p>Similar behaviour is followed by next 3 functions - <code>subFunc</code>, <code>mulFunc</code> and <code>divFunc</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">subFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Function arguments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Load values and perform subtraction
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Return value is already in EAX, just return
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">mulFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Function arguments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Load values and perform multiplication
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">imul</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Return value is already in EAX, just return
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">divFunc:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Function arguments
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Load values and perform division
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cdq</span>
</span></span><span class="line"><span class="cl">        <span class="nf">idiv</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Return value is already in EAX, just return
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Now we are done with all the functions that perform the computations, next comes the function which prints the help message and then exits.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Not enough arguments passed&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC1:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Usage: ./calc &lt;num1&gt; &lt;operator&gt; &lt;num2&gt;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">die:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">puts</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">puts</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">exit</span>
</span></span></code></pre></div><p>The name implies that the purpose of this function is to terminate the execution of the <code>calc</code> program. Lines 8-9 show that this function is printing something using the <code>puts</code> function. The function&rsquo;s argument is a string starting at offset <code>.LC0</code> - <code>&quot;Insufficient arguments passed&quot;</code>. Lines 9-10 contain another call for <code>puts</code> with an argument from offset <code>.LC1</code> - <code>&quot;Usage: ./calc &lt;num1&gt; &lt;operator&gt; &lt;num2&gt;&quot;</code>.</p>
<p>These both <code>puts</code> statements combined give the error message we got when we tried to execute the program without any arguments.</p>
<p>Finally, it terminates with an <code>exit</code> function call (no return), and the function&rsquo;s argument was the integer value <code>1</code>. Typically, the return value for successful execution is zero, and all non-zero values denote some type of execution error. <strong>So exiting with 1 indicates an error.</strong></p>
<p>Now we know what each function do at atomic level. Let&rsquo;s load our big guns and take a shot at <code>main()</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC2:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%d %c %d = %d\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">48</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-36</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">],</span> <span class="no">rsi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-36</span><span class="p">],</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L11</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">die</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L11:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">24</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movzx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">],</span> <span class="no">al</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L12</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L14</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">42</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L15</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">43</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jne</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">addFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L14:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">subFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L15:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">mulFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L12:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">divFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L13:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rcx</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">rcx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">edx</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">r8d</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>The <code>main</code> function still appears to be too large to handle all at once, so I&rsquo;ll cut it into smaller chunks to bite off and digest properly.</p>
<p>The prologue comes first&hellip; setting up the function frame; nothing new here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span></code></pre></div><p>Then we make some space in the frame to store the local variables.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">48</span>
</span></span></code></pre></div><p>And then storing <code>edi</code> and <code>rsi</code> values in there. If you remember these two registers indicate the first two arguments passed to a function. In this case, the arguments to main function will be the <code>argc</code> and <code>argv</code>.</p>
<ul>
<li><code>argc</code> &ndash;&gt; Count of the cli arguments passed to it.</li>
<li><code>argv</code> &ndash;&gt; Pointer to the list of arguments passed.</li>
</ul>
<p>Next up is the comparision&hellip;which will check the count of args. This decides the branch the program execution takes - die or live.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-36</span><span class="p">],</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L11</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">die</span>
</span></span></code></pre></div><p>This compares <code>[rbp-36]</code> (<code>argc</code>) with hardcoded value of <code>3</code>. If the value from <code>argc</code> is greater than <code>3</code> then it&rsquo;ll make a jump to <code>.L11</code>, otherwise it&rsquo;ll call <code>die</code> function&hellip; which will print some messages and then <code>exit</code> with status <code>1</code>. We already looked at that.</p>
<p>So if we write a C program for what we know about <code>main</code> till now, we&rsquo;ll get something like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="cm">/* Keep on going to know more */</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Next statements are something new, so you&rsquo;ll have to believe me when I say that this is equivalent to <code>argv[1]</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.L11:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span></code></pre></div><p>Before I start explaining, take a look at this diagram.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 840 489"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='24' y='180' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='180' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='180' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='48' y='196' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='48' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='48' y='228' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='56' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='120' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='120' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='120' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='120' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='196' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='216' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='228' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='416' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='448' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='448' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='68' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='100' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='132' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='196' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='324' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='356' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='388' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='420' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='448' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='448' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='464' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='308' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='472' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='472' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='340' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='472' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='372' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='472' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='404' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='472' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='480' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='480' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='340' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='480' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='480' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='404' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='480' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='488' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='116' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='496' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='340' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='496' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='372' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='496' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='404' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='496' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='504' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='504' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='340' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='504' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='504' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='404' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='504' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='512' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='404' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='116' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='520' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='308' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='520' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='340' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='520' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='372' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='520' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='404' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='520' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='528' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='528' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='536' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='536' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='536' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='536' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='536' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='544' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='308' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='544' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='340' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='544' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='372' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='544' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='404' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='544' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='552' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='552' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='340' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='552' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='372' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='552' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='404' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='552' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='116' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='560' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='568' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='568' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='576' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='308' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='576' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='116' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='584' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='592' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='600' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='632' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='68' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='100' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='164' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='196' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='292' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='324' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='356' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='388' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='420' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='632' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='632' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='648' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='648' y='340' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='648' y='372' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='648' y='404' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='656' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='656' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='656' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='656' y='404' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='664' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='308' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='664' y='340' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='664' y='372' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='664' y='404' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='672' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='672' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='672' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='672' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='680' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='680' y='340' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='680' y='372' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='680' y='404' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='688' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='308' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='688' y='340' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='688' y='372' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='688' y='404' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='696' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='696' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='696' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='696' y='404' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='704' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='308' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='704' y='340' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='704' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='704' y='404' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='712' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='712' y='340' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='712' y='372' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='712' y='404' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='720' y='116' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='720' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='720' y='276' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='720' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='720' y='340' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='720' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='720' y='404' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='728' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='728' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='728' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='728' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='736' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='736' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='736' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='736' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='744' y='308' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='744' y='340' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='744' y='372' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='744' y='404' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='752' y='308' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='752' y='340' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='752' y='372' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='752' y='404' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='760' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='760' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='760' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='760' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='768' y='308' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='768' y='340' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='768' y='372' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='768' y='404' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='776' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='776' y='340' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='776' y='372' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='776' y='404' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='784' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='784' y='340' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='784' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='784' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='800' y='340' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='800' y='372' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='800' y='404' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='816' y='340' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='816' y='372' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='816' y='404' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='824' y='372' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='824' y='404' fill='currentColor' style='font-size:1em'>4</text>
</g>

    </svg>
  
</div>
<p>Now with this in your mind, we can start to understand the above 3 instructions.</p>
<ul>
<li><code>mov     rax, QWORD PTR [rbp-48]</code></li>
</ul>
<p>This instruction loads the <code>some_pointer_value</code> into <code>rax</code> register.</p>
<ul>
<li><code>add     rax, 8</code></li>
</ul>
<p>This adds up <code>8</code> to <code>rax</code> value. That means now the resultant value is <code>some_pointer_value + 8</code>. If you don&rsquo;t know it already, <code>8</code> is the size of a pointer on most x86_64 machines. So if we want to add for 2 pointers, we&rsquo;ll need something like <code>some_pointer_value + 16</code>.</p>
<ul>
<li><code>mov     rax, QWORD PTR [rax]</code></li>
</ul>
<p>Now we load the value from that location. In C language, this would be equivalent to <code>*(argv + 1)</code> or <code>argv[1]</code> or if you are feeling funny <code>1[argv]</code>. <strong><a href="https://stackoverflow.com/questions/381542/with-arrays-why-is-it-the-case-that-a5-5a">HOW??</a></strong> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>Now, next instruction calls <code>atoi</code> function with the <code>argv[1]</code> as it&rsquo;s first argument.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span></code></pre></div><p><code>atoi</code> function changes character value to respective integer value. As an example, <code>'1'</code> (in char) will be converted to <code>1</code> (in int).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span></code></pre></div><p>And then whatever is returned by that function will be stored in a local variable pointed by <code>rbp-12</code>. Remember, <code>eax</code> register is used to store the return values from called functions (<code>atio</code>) to caller function (<code>main</code>).</p>
<p>Next set of instructions is quite similar to what we just saw.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">24</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">atoi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">eax</span>
</span></span></code></pre></div><p>If you notice, here we are adding <code>24</code><em>(8 * 3 = 24)</em> so that means <code>arg3</code> is being used - <code>argv[3]</code>. Till this point we have successfully converted <code>argv[1]</code> and <code>argv[3]</code> to integers. These are the number1 and number2 values for our litte calculator.</p>
<p>Now <code>argv[2]</code>&hellip; our operator character&hellip; 1 byte value.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-48</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rax</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rax</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movzx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">],</span> <span class="no">al</span>
</span></span></code></pre></div><p>This adds <code>16</code> - means <code>argv[2]</code>. So we load the value and then just pick up the lowest 1 byte value <code>al</code> from the whole thing and store it in <code>[rbp-17]</code> location.</p>
<p>Let&rsquo;s update our C program with the new findings.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">num1</span> <span class="o">=</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="kt">int</span> <span class="n">num2</span> <span class="o">=</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="kt">char</span> <span class="n">op</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="cm">/* Keep on going to know more */</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Next few lines of disassembly code looks like a conditional branch&hellip;. So many &ldquo;compare and jump&rdquo; instructions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L12</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">47</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L14</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">45</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jg</span>      <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">42</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L15</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">43</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jne</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">addFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L14:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">subFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L15:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">mulFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L13</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L12:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">divFunc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span></code></pre></div><p>The value being compared is stored in <code>[rbp-17]</code> in this case. This contains the operator character from <code>argv[2]</code>. If you convert the values this is compared to to char equivalents, you&rsquo;ll get the following:</p>
<ul>
<li>47 is <code>/</code>,</li>
<li>45 is <code>-</code>,</li>
<li>42 is <code>*</code>, and</li>
<li>43 is <code>+</code>.</li>
</ul>
<p>With some calculations, you can conclude where the control will jump. To sum up,</p>
<ul>
<li>
<p>if the operator is 47 (<code>/</code>), then it&rsquo;ll jump to <code>.L12</code>. Which will move the offset location for <code>divFunc</code> function to a local variable.</p>
</li>
<li>
<p>if the operator is 45 (<code>-</code>), then it&rsquo;ll move offset location for <code>subFunc</code> function to that local variable.</p>
</li>
<li>
<p>if the operator is 42 (<code>*</code>), then it&rsquo;ll move offset location for <code>mulFunc</code> function to that local variable.</p>
</li>
<li>
<p>if the operator is 42 (<code>+</code>), then it&rsquo;ll move offset location for <code>addFunc</code> function to that local variable.</p>
</li>
<li>
<p>In any other given input, it&rsquo;ll simply move forward to <code>.L13</code>.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.L13:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rcx</span><span class="p">,</span> <span class="no">QWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">rcx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nf">movsx</span>   <span class="no">edx</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-17</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">r8d</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Before reaching <code>.L13</code>, we have 4 variables in our program:-</p>
<ul>
<li>number1 - stored at <code>[rbp-12]</code></li>
<li>number2 - stored at <code>[rbp-16]</code></li>
<li>operator - stored at <code>[rbp-17]</code></li>
<li>pointer to the function which is selected on the basis of operator. This is stored at <code>[rbp-8]</code>.</li>
</ul>
<p>Now that we&rsquo;re in <code>.L13</code>,</p>
<p>We assign the <code>number1</code>, <code>number2</code>, and the <code>function pointer</code> to <code>eax</code>, <code>edx</code>, and <code>rcx</code>, respectively. The <code>function</code> is then called with the arguments <code>number1</code> and <code>number2</code>. Finally, the outcome is saved.</p>
<p>The remainder of the <code>.L13</code> consists entirely of calling a <code>printf</code> function with a format string and other local variables. The final result will look like this: <code>&lt;number1&gt; &lt;operator&gt; &lt;number2&gt; = &lt;result_from_function&gt;</code>. I&rsquo;ll leave it to you to dissect and solve the final puzzle piece. After printing, the function then exits gracefully.</p>
<p>Now we can put everything together, and the complete code should look something like this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Function to perform addition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">addFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Function to perform subtraction
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">subFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Function to perform multiplication
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">mulFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Function to perform division
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">divFunc</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Function to print usage message and exit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">die</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Not enough arguments passed</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Usage: ./calc &lt;num1&gt; &lt;operator&gt; &lt;num2&gt;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="nf">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">option</span> <span class="o">=</span> <span class="o">*</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">fp</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="n">option</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;+&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fp</span> <span class="o">=</span> <span class="n">addFunc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;-&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fp</span> <span class="o">=</span> <span class="n">subFunc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;*&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fp</span> <span class="o">=</span> <span class="n">mulFunc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                      <span class="n">fp</span> <span class="o">=</span> <span class="n">divFunc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d %c %d = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This may not be what the original developer wrote, but it will certainly behave the same. That is the entire point of reverse engineering. Dissecting something with your tools to understand how it behaves and then creating something that mimics the behavior.</p>
<p>I&rsquo;ll encourage you to go and try to reverse engineer some more binaries. You can build your own if you want or just download some from online platforms like <a href="https://crackmes.one/">crackme.one</a>. Have fun!!</p>
<p><img loading="lazy" src="https://media.giphy.com/media/OB4Sjggq8aMJnq4sLQ/giphy.gif#center" alt=""  />
</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://stackoverflow.com/questions/381542/with-arrays-why-is-it-the-case-that-a5-5a">https://stackoverflow.com/questions/381542/with-arrays-why-is-it-the-case-that-a5-5a</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Intro to Re: C : part-3</title>
      <link>https://ayedaemon.github.io/post/2023/04/intro-to-re-part-3/</link>
      <pubDate>Sat, 01 Apr 2023 21:59:33 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/04/intro-to-re-part-3/</guid>
      <description>Blog covers how disassembly of basic operations and functions in C programming looks like.</description>
      <content:encoded><![CDATA[<p>In the previous blog, I discussed some of the basic C program&rsquo;s disassembly structures, concentrating on the variables and their memory layouts. This article, a follow-up to the previous one, focuses on basic operations and functions in C programs.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/3BUYbmXltgQ4zu0Tv5/giphy.gif#center" alt=""  />
</p>
<p>In the previous blogs, we have seen what an empty C program looks like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><h2 id="arithmatic-operators">Arithmatic operators</h2>
<p>Now if we want to work with operations, we&rsquo;ll have to add 2 local variables to the function. Something like in the below example.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><h3 id="addition">Addition</h3>
<p>Now let&rsquo;s perform add operation on the 2 local variables we created and save the result in a new variable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>We can see a few new instructions in the disassembly code that are responsible for the <code>int c = a + b</code> instruction in the source code.</p>
<p>When we look at them separately, it becomes quite natural to understand.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; Save the first variable value in EDX register
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>      <span class="c1">; Save the second variable value in EAX register
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>                    <span class="c1">; add EAX and EDX register values, this stores the result in EAX here
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; Move the new value of EAX to third variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Let&rsquo;s look at other arithmetic operations as well</p>
<h3 id="subtraction">Subtraction</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; load first variable in EAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>      <span class="c1">; subtract EAX with second variable, then save the result in EAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; save the new value of EAX in the third register
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><h3 id="multiplication">Multiplication</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; load first variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">imul</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>      <span class="c1">; multiply it with second
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; save it in the third
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><h3 id="division-and-modulo">Division and modulo</h3>
<p>If you are not aware, the division operation is about calculating the quotient and the modulo operation is about the remainder.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>   
</span></span><span class="line"><span class="cl">        <span class="c1">; prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; first and second variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; division
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; Load first variable in EAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">cdq</span>                                 <span class="c1">; Convert double to quad value;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">idiv</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>           <span class="c1">; perform idiv operation with second variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; Store new EAX value in third variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="c1">; modulo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; Load the first value again
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">cdq</span>                                 <span class="c1">; Convert double to quad value;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">idiv</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>           <span class="c1">; perform idiv operation with second variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">edx</span>     <span class="c1">; Store the EDX value in fourth variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="c1">; epilogue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>If you didn&rsquo;t notice, the <strong>division result</strong> was stored in the <code>EAX</code> register, while the <strong>modulo result</strong> was stored in the <code>EDX</code>&hellip;Everything else stays unchanged.</p>
<p>Its OKAY if you are having questions like-</p>
<ul>
<li>How?</li>
<li>why EDX??</li>
<li>WTF is going on???</li>
<li>Does it perform both operations even if either one of them is required????</li>
</ul>
<p>These instructions, however, are not as simple to understand as others. So allow me to attempt to explain what&rsquo;s going on.</p>
<p>To begin, you must comprehend the cdq instruction&rsquo;s magic. This converts a <code>Doubleword</code> to a <code>Quadword</code> by extending the sign bit of <code>EAX</code> into the <code>EDX</code> register. For the purposes of this blog, consider the <code>EAX</code> and <code>EDX</code> to be joined together to form a large quadword register. So, if <code>EDX</code> contains <code>0x12</code> and <code>EAX</code> contains <code>0x3456789a</code>, the resulting value is <code>0x123456789a</code>. Does that make sense?</p>
<p>So when a <code>idiv</code> (or other <code>div</code> derivatives) operation is performed, both the quotient and the remainder are calculated. The instruction stores the quotient in <code>EAX</code> and the remainder in <code>EDX</code> register.</p>
<p>Now that you understand the concept, you can think about removing some of the repeated instructions to make your program smaller and run faster.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>   
</span></span><span class="line"><span class="cl">        <span class="c1">; prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; first and second variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; division and modulo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; Load first variable in EAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">cdq</span>                                 <span class="c1">; Convert double to quad value;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">idiv</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>           <span class="c1">; perform idiv operation with second variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; Store new EAX value in third variable (quotient)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">edx</span>     <span class="c1">; Store the EDX value in fourth variable (remainder)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="c1">; epilogue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Another point worth mentioning is that <code>div</code> operations cannot be used without overwriting the contents of the <code>EAX</code> and <code>EDX</code> registers. If you want to use the values of these registers after the <code>div</code> operation, save them somewhere else where they can be read later.</p>
<h2 id="incrementdecrement-operators">Increment/Decrement operators</h2>
<p>That&rsquo;s all there is to arithmetic operators. Let&rsquo;s move on to the increment and decrement operators&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C</span> <span class="o">=</span> <span class="o">++</span><span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int A = 5;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int B = A++;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; load the value from variable A in EAX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">rax</span><span class="err">+</span><span class="mi">1</span><span class="p">]</span>                <span class="c1">; increment the value and store it in EDX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edx</span>      <span class="c1">; update the incremented value in the variable A
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">eax</span>      <span class="c1">; Load the old EAX value in variable B;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="c1">; int C = ++A;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">add</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>        <span class="c1">; Increment the value of variable A
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>      <span class="c1">; Load the updated value of variable A in EAX 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>     <span class="c1">; Store the EAX value in variable C
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">; epilogue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>At this level, I believe you can see that this operator is nothing special. I&rsquo;ll leave the decrement operator upto you to test and disect. You can always use <a href="https://godbolt.org/">godbolt.org</a> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> for quick testing.</p>
<h2 id="bitwise-operators">Bitwise operators</h2>
<p>We can now proceed to examine the bitwise operators from a low-level perspective.
(PS: They are my personal favourites)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C1</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C2</span> <span class="o">=</span> <span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C3</span> <span class="o">=</span> <span class="n">A</span> <span class="o">^</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C4</span> <span class="o">=</span> <span class="o">~</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int A = 5, B = 0;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int C1 = A &amp; B;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">and</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int C1 = A | B;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">or</span>      <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int C1 = A ^ B;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-20</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int C1 = ~ B;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">not</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-24</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; epilogue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Simple and neat. Aren&rsquo;t they? Load the variables in registers, perform the operation, store the result.</p>
<h3 id="shift-rightleft-operators">shift right/left operators</h3>
<p>Then there are shift operators - shift left and shift right.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">C</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; int A = 1;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int B = A &lt;&lt; 4;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sal</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>                  <span class="c1">; Shift arithmetic left
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; int C = B &gt;&gt; 4;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sar</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>                  <span class="c1">; Shift arithmetic right
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; epilogue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>If you look at their binary representation, shift operators are very straightforward. Allow me to create an image for you.</p>
<ul>
<li>Initial value in memory</li>
</ul>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 272 89"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<ul>
<li>After shifting left 4 times.</li>
</ul>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 280 153"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='24' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='72' y='68' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='216' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>─</text>
</g>

    </svg>
  
</div>
<p>Blocks with &ldquo;.&rdquo; are the freshly shifted block from outside the memory frame. These blocks are packed with zeroes. This makes our resulting value <code>2^4 = 16</code>.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 272 89"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<p>If we shift it right 4 times we&rsquo;ll get our initial value.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 288 329"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='0' y='228' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='8' y='228' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='16' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='24' y='84' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='24' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='260' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='24' y='292' fill='currentColor' style='font-size:1em'>V</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='32' y='292' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='40' y='84' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='40' y='228' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='40' y='292' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>:</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='48' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='48' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='260' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='260' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='72' y='292' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='80' y='52' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='80' y='260' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='80' y='292' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='136' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='308' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='260' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='152' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='152' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='152' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='168' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='168' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='260' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='184' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='260' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='200' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='208' y='260' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='208' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='216' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='216' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='260' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='240' y='260' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='100' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='248' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='276' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='308' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='256' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='256' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='68' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='100' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='264' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='272' y='132' fill='currentColor' style='font-size:1em'>►</text>
</g>

    </svg>
  
</div>
<p>Consider this: if we conducted a shift right operation with this, the entire frame would be filled with 0s, and the resultant value would be zero. No matter how many shifts we make.</p>
<p>Another intriguing thing is that you can multiply a number by <code>2</code> using the shift left procedure&hellip;without actually using the <code>*</code> operation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">void main() {
</span></span><span class="line"><span class="cl">    int a = 589;
</span></span><span class="line"><span class="cl">    int X = a*2;
</span></span><span class="line"><span class="cl">    int Y = a &lt;&lt; 1;
</span></span><span class="line"><span class="cl">}  
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">main:
</span></span><span class="line"><span class="cl">        push    rbp
</span></span><span class="line"><span class="cl">        mov     rbp, rsp
</span></span><span class="line"><span class="cl">        mov     DWORD PTR [rbp-4], 589
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        ; int X = a*2;
</span></span><span class="line"><span class="cl">        mov     eax, DWORD PTR [rbp-4]
</span></span><span class="line"><span class="cl">        add     eax, eax
</span></span><span class="line"><span class="cl">        mov     DWORD PTR [rbp-8], eax
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        ; int Y = a &lt;&lt; 1;
</span></span><span class="line"><span class="cl">        mov     eax, DWORD PTR [rbp-4]
</span></span><span class="line"><span class="cl">        add     eax, eax
</span></span><span class="line"><span class="cl">        mov     DWORD PTR [rbp-12], eax
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        nop
</span></span><span class="line"><span class="cl">        pop     rbp
</span></span><span class="line"><span class="cl">        ret
</span></span></code></pre></div><p>At a lower level, they are identical. Nothing particularly useful, but it&rsquo;s good to know what&rsquo;s happening behind the scenes.</p>
<h2 id="branching">Branching</h2>
<p>Now comes the branching. Every good program employs branching for one reason or another. This is very useful to understand when considering reverse engineering.</p>
<h3 id="if-else">If-else</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jne</span>     <span class="no">.L2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L2:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.L4:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Let&rsquo;s understand this step by step</p>
<table>
<thead>
<tr>
<th>Line</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Line 1</td>
<td>label for the function starting</td>
</tr>
<tr>
<td>Line 2:3</td>
<td>Prologue; Setting up the function frame</td>
</tr>
<tr>
<td>Line 4</td>
<td>int a = 1;</td>
</tr>
<tr>
<td>Line 5</td>
<td>Comparing this value with a hardcoded value <code>2</code></td>
</tr>
<tr>
<td>Line 6</td>
<td>If the result of the comparision is <em>not equal</em>, then jump to <code>L2</code> flag</td>
</tr>
<tr>
<td>Line 7</td>
<td>x = 10; This will run if it didn&rsquo;t jump to <code>L2</code></td>
</tr>
<tr>
<td>Line 8</td>
<td>Now jump to <code>L4</code></td>
</tr>
<tr>
<td>Line 9</td>
<td>Flag for <code>L2</code></td>
</tr>
<tr>
<td>Line 10</td>
<td>x = 5;</td>
</tr>
<tr>
<td>Line 11:14</td>
<td>epilogue for the function</td>
</tr>
</tbody>
</table>
<p>Here is a graph to make it more simpler</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 640 553"
      >
      <g transform='translate(8,16)'>
<polygon points='136.000000,352.000000 124.000000,346.399994 124.000000,357.600006' fill='currentColor' transform='rotate(90.000000, 128.000000, 352.000000)'></polygon>
<polygon points='408.000000,352.000000 396.000000,346.399994 396.000000,357.600006' fill='currentColor' transform='rotate(90.000000, 400.000000, 352.000000)'></polygon>
<text text-anchor='middle' x='64' y='276' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='64' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='64' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='64' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='64' y='340' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='72' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='292' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='80' y='324' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='80' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='88' y='324' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='88' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='292' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='96' y='324' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='96' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='244' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='112' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='112' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='112' y='324' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='112' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='292' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='120' y='324' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='120' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='128' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='128' y='324' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='388' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='144' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='144' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='152' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='292' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='160' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='168' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='176' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='184' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='192' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='180' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='192' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='244' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='292' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='192' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='436' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='192' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='532' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='200' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='452' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='208' y='484' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='516' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='292' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='216' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='452' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='484' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='216' y='516' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='224' y='484' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='224' y='516' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='224' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='232' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='248' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='248' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='484' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='248' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='484' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='256' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='228' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='388' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='404' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='280' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='280' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='84' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='276' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='340' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='296' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='84' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='276' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='340' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='336' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='352' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='360' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='368' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='228' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='384' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='384' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='384' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='384' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='392' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='400' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='404' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='400' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='408' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='416' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='432' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='440' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='448' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='456' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='464' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='472' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='480' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='436' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='480' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='480' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='480' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='480' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='480' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='480' y='532' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='488' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='488' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='496' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='504' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='520' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='4' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='552' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='552' y='164' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='552' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='276' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='624' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='624' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='624' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='624' y='340' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<h3 id="switch-case">Switch-case</h3>
<p>Branching can also be implemented with switch-case directives in C and some other languages. At lower level, they function similarly to if-else.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; Compare and jump if equal
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; Compare and jump if equal
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">cmp</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">je</span>      <span class="no">.L3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; Default jump to the end
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">jmp</span>     <span class="no">.L4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.L2:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nf">jmp</span>     <span class="no">.L4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.L3:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.L4:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>See&hellip;just like if-else statements, switch-case statements also use <code>cmp</code> and <code>jmp</code> instructions to create branches in the flow.</p>
<p>Graph diagram for the above disassembly will look something like this</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 696 761"
      >
      <g transform='translate(8,16)'>
<polygon points='48.000000,512.000000 36.000000,506.399994 36.000000,517.599976' fill='currentColor' transform='rotate(90.000000, 40.000000, 512.000000)'></polygon>
<polygon points='256.000000,544.000000 244.000000,538.400024 244.000000,549.599976' fill='currentColor' transform='rotate(90.000000, 248.000000, 544.000000)'></polygon>
<polygon points='432.000000,368.000000 420.000000,362.399994 420.000000,373.600006' fill='currentColor' transform='rotate(90.000000, 424.000000, 368.000000)'></polygon>
<text text-anchor='middle' x='8' y='468' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='8' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='8' y='500' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='16' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='16' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='484' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='24' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='484' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='32' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='420' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='40' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='484' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='40' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='580' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='48' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='484' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='56' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='484' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='64' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='484' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='72' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='276' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='112' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='112' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='112' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='112' y='340' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='112' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='128' y='324' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='292' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='136' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='644' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='136' y='660' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='676' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='692' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='708' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='724' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='740' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='144' y='244' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='144' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='324' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='152' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='660' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='152' y='692' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='152' y='724' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='152' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='180' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='324' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='160' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='660' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='160' y='692' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='160' y='724' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='292' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='168' y='324' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='168' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='500' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='660' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='168' y='692' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='168' y='724' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='176' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='176' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='176' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='420' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='176' y='468' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='176' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='500' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='176' y='580' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='580' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='184' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='692' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='192' y='100' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='192' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='192' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='192' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='404' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='192' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='692' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='192' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='200' y='164' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='200' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='596' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='200' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='692' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='208' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='292' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='596' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='216' y='100' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='216' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='244' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='468' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='216' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='532' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='216' y='596' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='612' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='216' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='216' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='224' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='224' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='244' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='596' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='232' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='484' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='232' y='516' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='596' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='240' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='228' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='240' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='292' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='484' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='240' y='516' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='240' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='596' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='404' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='248' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='484' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='248' y='516' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='248' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='596' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='248' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='256' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='264' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='484' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='264' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='100' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='272' y='132' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='272' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='272' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='484' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='272' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='280' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='280' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='484' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='100' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='288' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='288' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='296' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='484' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='296' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='100' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='304' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='100' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='312' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='484' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='312' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='100' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='320' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='100' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='328' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='276' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='340' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='328' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='484' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='328' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='484' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='336' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='344' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='484' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='344' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='484' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='352' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='484' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='360' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='484' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='368' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='484' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='376' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='484' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='384' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='276' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='356' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='392' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='484' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='400' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='484' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='408' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='416' y='324' fill='currentColor' style='font-size:1em'>j</text>
<text text-anchor='middle' x='416' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='424' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='424' y='324' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='424' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='436' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='424' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='432' y='324' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='432' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='448' y='324' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='448' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='456' y='324' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='456' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='464' y='324' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='464' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='472' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='480' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='496' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='468' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='532' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='504' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='468' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='504' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='504' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='504' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='504' y='532' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='504' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='512' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='644' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='740' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='520' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='644' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='520' y='660' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='520' y='676' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='520' y='692' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='520' y='708' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='520' y='724' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='520' y='740' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='528' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='528' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='436' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='612' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='536' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='436' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='536' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='612' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='544' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='544' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='552' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='560' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='568' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='584' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='584' y='180' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='584' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='584' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='592' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='356' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='276' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='680' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='680' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='680' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='680' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='680' y='356' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<p>With all that out of the way, let us take a brief look at how function calling works at the low level.</p>
<h2 id="functions">Functions</h2>
<p>I always wished to demonstrate people an infinite loop with recursion. So here you have it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Each time the <code>call main</code> instruction is encountered, the <code>main()</code> function is called, and a new function frame is created. Due to the lack of an exit condition, the processor will never be able to read anything beyond the <code>call main</code> instruction, and thus the function will never return. Hence, the infinite loop.</p>
<p>Now take a look at how things change when we add arguments to a function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">main</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="mi">9</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="mi">7</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">r9d</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">r8d</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="nf">add</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>If you examine the pattern, you will notice that the arguments are loaded in a particular sequence - from right to left. The first six arguments remain in the registers <code>edi</code>, <code>esi</code>, <code>edx</code>, <code>ecx</code>, <code>r8d</code> &amp; <code>r9d</code> (from left to right). The rest of the arguments are stored on the stack.</p>
<p>This pattern is followed by any function that you wish to invoke from your code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>This is obviously not the correct method to invoke a <code>printf</code> function. <code>Printf</code>&rsquo;s first argument should be a string (possibly a format string).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Hello&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>The <code>Hello</code> string is kept at <code>LC0</code> offset here. So we load the offset&rsquo;s pointer to value and put it in <code>edi</code>. Then execute the <code>printf()</code> function, which will take as its first argument the value stored in the <code>edi</code> register.</p>
<p>If you are wondering what&rsquo;s the point of <code>mov     eax, 0</code> just before <code>printf</code> call&hellip; <a href="https://stackoverflow.com/questions/6212665/why-is-eax-zeroed-before-a-call-to-printf">read this StackOverflow thread</a> <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<p>If we add 1 more argument to <code>printf</code> call, that should be stored in <code>esi</code> register. And the right-most argument will be processed first.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%d&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p><code>Printf</code>, like all other C functions, has a return value that is an <code>int</code> type. <code>Printf</code> gives the number of characters in the format string that the function has processed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%d&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">; Prologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; Getting memory block for variables
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; first printf 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; Storing return value (eax) of printf in the local variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; second printf
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; epologue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Remember how we talked about that the return values from functions are stored in <code>eax</code> register. Here also, the return value from <code>printf</code> is stored in <code>eax</code> which is then stored in some other local variable.</p>
<p>Since both of my strings for <code>printf</code> were exactly same, the compiler reused it to call <code>printf</code> second time, instead of creating 2 strings with same content.</p>
<h3 id="function-pointers">Function pointers</h3>
<p>Let us spice things up a little more now&hellip; and look at function pointers.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">main</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">main</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">main</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Output of this program is not what you might expect if you are not a seasoned C programmer or have never worked with function pointers before.</p>
<p>Output:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">0x55770bbfa139
</span></span><span class="line"><span class="cl">0x55770bbfa139
</span></span><span class="line"><span class="cl">0x55770bbfa139
</span></span></code></pre></div><p>Each of them gave the same output. This is not the case when working with integer pointers. Let&rsquo;s see how this looks at lower level</p>
<p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%p\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">; printf(&#34;%p\n&#34;, main);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; printf(&#34;%p\n&#34;, *main);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; printf(&#34;%p\n&#34;, &amp;main);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>They are all precisely the same!! The assembly code for all three lines remains unchanged.</p>
<p>To test whether it behaves the same way with other functions as well, let&rsquo;s add another function to the code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">func</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">func</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%p</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">func</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">func:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%p\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; printf(&#34;%p\n&#34;, func);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">func</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; printf(&#34;%p\n&#34;, *func);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">func</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">;printf(&#34;%p\n&#34;, &amp;func);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:</span><span class="no">func</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Still the same!!</p>
<p>If you have never worked with function pointers before, this is just the beginning of things, we can even call the function <code>func</code> using above pointer notations.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">func</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">func</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">&amp;</span><span class="n">func</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">func:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; func();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; (*func)();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; (&amp;func)();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>We can even add arguments to our <code>func</code> function call, just like we do with a normal function&hellip; and the first argument will be stored in <code>edi</code> the second on in <code>esi</code> and so on.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">func</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)(</span><span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="o">&amp;</span><span class="n">func</span><span class="p">)(</span><span class="mi">8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Disassembly:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;%d\n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nl">func:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub</span>     <span class="no">rsp</span><span class="p">,</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">OFFSET</span> <span class="no">FLAT</span><span class="p">:.</span><span class="no">LC0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leave</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; func(5);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; func(6);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; func(7);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">; func(8);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">func</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>That&rsquo;s it for today. In the next article, I&rsquo;ll try to use all our knowledge we have gathered till now to reverse engineer a very simple calculator program.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/3ZZVfvtxywq9dIGZM0/giphy.gif#center" alt=""  />
</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://godbolt.org/">https://godbolt.org/</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://stackoverflow.com/questions/6212665/why-is-eax-zeroed-before-a-call-to-printf">https://stackoverflow.com/questions/6212665/why-is-eax-zeroed-before-a-call-to-printf</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Intro to Re: C : part-2</title>
      <link>https://ayedaemon.github.io/post/2023/03/intro-to-re-part-2/</link>
      <pubDate>Sun, 19 Mar 2023 22:07:39 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2023/03/intro-to-re-part-2/</guid>
      <description>How to reverse engineer a basic C program</description>
      <content:encoded><![CDATA[<p>Reverese engineering is a powerful tool for any software developer. However, as with any tool, it is only as good as the person using it. Understanding reverse engineering and how to use it is essential for both novices and seasoned developers.</p>
<p>According to wikipedia,</p>
<blockquote>
<p>Reverse engineering, also called back engineering, is the process by which a man-made object is deconstructed to reveal its designs, architecture, or to extract knowledge from the object; similar to scientific research, the only difference being that scientific research is about a natural phenomenon.</p>
</blockquote>
<p>Because there will be a lot of new things, I&rsquo;m attempting to keep this article more practical and experimental&hellip;I encourage you to follow along and experiment with your own examples as well.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/109fP7pua6Osgw/giphy.gif#center" alt=""  />
</p>
<p>The following is a very simple C program that starts the <code>main()</code> function and exits by returning a value <code>0</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This source code will be compiled to create an executable binary file. When we disassemble the compiled binary, we get something like this&hellip;</p>
<p>(Note: There are <a href="https://en.wikipedia.org/wiki/Disassembler#Examples_of_disassemblers">many disassemblers</a> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> you can use. Nearly all the disassembled instructions in this blog were produced with <a href="https://godbolt.org/">godbolt</a>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>In this example, function <code>prologue</code> and <code>epilogue</code> are the first two and last two instructions, respectively. These are used to build a frame for a function. This frame contains all of the local variables used or defined in this function.</p>
<p>Whenever a function is created, a new frame is created, all the local variables are stored in respective memory blocks inside this frame and finally the frame is discarded when the function returns.</p>
<p>We&rsquo;ll go into more detail about this later, but for now, just remember that there are <code>prologue</code> and <code>epilogue</code> instructions that mark the beginning and end of a function.</p>
<p>With this out of the picture, the instruction at line 4 appears to be in charge of returning <code>0</code> to the caller function (whoever called <code>main()</code>).</p>
<p>The idea is to use the <code>eax</code> register as a storage area for return values. When a function returns something, it simply stores the value in the <code>eax</code>/<code>rax</code> register so that the caller function can read it later if necessary.</p>
<p>Now we know some background theory, let&rsquo;s try to change the return value and see how our assembly instructions reflect the change.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The assembly instructions for the above code are nearly identical to the previous one, with the exception of the return value at <code>line 4</code>. Now eax register stores the value <code>6</code> instead of <code>0</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>If you are familiar with basic C programming, you know that we can avoid returning value by changing the return type of the function <code>main()</code> from <code>int</code> to <code>void</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{}</span>
</span></span></code></pre></div><p>No return statements here! So we can safely assume that the disassembly for this function should consist only of a <code>prologue</code> and an <code>epilogue</code>, with <strong>no</strong> <code>mov eax 0</code> kind of instructions.</p>
<p>Why?? No <code>return</code> statements in the source code, so no need to store anything in <code>eax</code> register. Save some CPU cycles. Makes sense, right? Let&rsquo;s check!!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>The <code>prologue</code> and <code>epilogue</code> can be seen in the above disassembly, along with a new instruction <code>nop</code> that does nothing. A <code>nop</code> statement in C is a null statement that can be a semicolon (<code>;</code>), an empty block (<code>{}</code>), or any other equivalent statement.</p>
<p>If you&rsquo;re a Pythonista, you&rsquo;re already familiar with the <code>pass</code> statement, which has no effect when executed. This serves as a <code>nop</code> in python language.</p>
<p>In the disassembly, we now know what the <code>prologue</code>, <code>epilogue</code>, and <code>return</code> statement look like. Let’s see what variables look like when disassembled.</p>
<p>Everything in the following code is identical to the previous example; the only statement added here is an <code>int</code> variable definition.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>We have already established that all the local variables for a function are created inside the function frame (which starts with a <code>prologue</code> and ends with an <code>epilogue</code>). With that in mind, let&rsquo;s take a look at the disassembly for this source code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>A new instruction detected - <code>mov     DWORD PTR [rbp-4], 1</code>. This is storing value <code>1</code> at some location pointed by <code>rbp-4</code>. To gain a better understanding of how that works, we&rsquo;ll have to take a detour so that we can debug the binary and see the registers and memory in action.</p>
<p>I&rsquo;ll start <code>gdb</code> with the compiled version of the above source code, and then disassemble the main function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; disas main
</span></span><span class="line"><span class="cl">Dump of assembler code for function main:
</span></span><span class="line"><span class="cl">   0x0000555555555119 &lt;+0&gt;:     push   rbp
</span></span><span class="line"><span class="cl">   0x000055555555511a &lt;+1&gt;:     mov    rbp,rsp
</span></span><span class="line"><span class="cl">=&gt; 0x000055555555511d &lt;+4&gt;:     mov    DWORD PTR [rbp-0x4],0x1
</span></span><span class="line"><span class="cl">   0x0000555555555124 &lt;+11&gt;:    nop
</span></span><span class="line"><span class="cl">   0x0000555555555125 &lt;+12&gt;:    pop    rbp
</span></span><span class="line"><span class="cl">   0x0000555555555126 &lt;+13&gt;:    ret
</span></span><span class="line"><span class="cl">End of assembler dump.
</span></span></code></pre></div><p>In this scenario, I&rsquo;m at the <code>mov DWORD PTR [rbp-0x4],0x1</code> instruction. That means, <code>rip</code> register is pointing to this instruction, which means this will be the next instruction executed by the CPU. We can also confirm this by checking the value stored in <code>rip</code> register.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; p/x $rip
</span></span><span class="line"><span class="cl">$1 = 0x55555555511d
</span></span></code></pre></div><p>See, told ya!</p>
<p><img loading="lazy" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNGZjOTIyNThjNDdmOTFmZDcyMjYxZDE3ZjIxYmU3MmZiNmMxYTBiNCZjdD1n/DT3gYifPXBt5voafS1/giphy.gif#center" alt=""  />
</p>
<p>Now, let&rsquo;s print the value from <code>rbp</code> register to figure out where the <code>0x1</code> will be stored eventually.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; p/x $rbp
</span></span><span class="line"><span class="cl">$2 = 0x7fffffffdbd0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; p/x $rbp-4
</span></span><span class="line"><span class="cl">$3 = 0x7fffffffdbcc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; p/x (int *)($rbp-4)
</span></span><span class="line"><span class="cl">$4 = 0x7fffffffdbcc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; p/x *(int *)($rbp-4)
</span></span><span class="line"><span class="cl">$5 = 0x7fff
</span></span></code></pre></div><p>The last value is the current value at the location pointed by <code>rbp-4</code> memory location. Consider the below mindmap diagram to get a clear picture.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 904 681"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='48' y='372' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='56' y='372' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='56' y='388' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='56' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='452' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='64' y='372' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='64' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='420' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='420' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='88' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='372' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='96' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='420' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='96' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='104' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='104' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='372' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='112' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='112' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='120' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='120' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='128' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='128' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='136' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='144' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='152' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='420' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='420' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='168' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='420' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='176' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='420' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='388' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='420' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='208' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='452' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='216' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='420' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='480' y='436' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='488' y='436' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='496' y='436' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='504' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='512' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='528' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='536' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='544' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='552' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='560' y='436' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='568' y='436' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='576' y='436' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='584' y='436' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='608' y='132' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='608' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='276' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='308' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='340' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='372' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='404' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='452' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='644' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='660' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='616' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='436' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='648' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='84' fill='currentColor' style='font-size:1em'>M</text>
<text text-anchor='middle' x='656' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='436' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='656' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='84' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='664' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='436' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='664' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='84' fill='currentColor' style='font-size:1em'>M</text>
<text text-anchor='middle' x='672' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='672' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='84' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='680' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='680' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='84' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='688' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='688' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='84' fill='currentColor' style='font-size:1em'>Y</text>
<text text-anchor='middle' x='696' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='776' y='132' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='776' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='276' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='308' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='340' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='372' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='404' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='452' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='644' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='660' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='808' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='420' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='824' y='436' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='832' y='292' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='832' y='436' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='840' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='840' y='436' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='848' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='848' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='856' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='864' y='292' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='864' y='436' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='880' y='436' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='888' y='436' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<p>The <code>rbp</code> register holds a memory location, you subtract 4 from the rbp to make enough space for a <code>int</code> type data and then store the value at that location.</p>
<p>After executing the instruction, we&rsquo;ll get <code>0x1</code> in this location.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; si
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; disas main
</span></span><span class="line"><span class="cl">Dump of assembler code for function main:
</span></span><span class="line"><span class="cl">   0x0000555555555119 &lt;+0&gt;:     push   rbp
</span></span><span class="line"><span class="cl">   0x000055555555511a &lt;+1&gt;:     mov    rbp,rsp
</span></span><span class="line"><span class="cl">   0x000055555555511d &lt;+4&gt;:     mov    DWORD PTR [rbp-0x4],0x1
</span></span><span class="line"><span class="cl">=&gt; 0x0000555555555124 &lt;+11&gt;:    nop
</span></span><span class="line"><span class="cl">   0x0000555555555125 &lt;+12&gt;:    pop    rbp
</span></span><span class="line"><span class="cl">   0x0000555555555126 &lt;+13&gt;:    ret
</span></span><span class="line"><span class="cl">End of assembler dump.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; p/x *(int *)($rbp-4)
</span></span><span class="line"><span class="cl">$7 = 0x1
</span></span></code></pre></div>


<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 904 681"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='48' y='372' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='56' y='372' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='56' y='388' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='56' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='56' y='452' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='64' y='372' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='64' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='420' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='88' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='420' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='88' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='372' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='96' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='420' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='96' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='104' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='104' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='372' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='112' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='112' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='120' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='120' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='128' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='128' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='136' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='144' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='420' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='152' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='420' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='420' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='168' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='420' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='176' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='420' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='388' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='388' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='420' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='208' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='452' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='216' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='420' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='480' y='436' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='488' y='436' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='496' y='436' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='504' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='512' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='528' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='536' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='544' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='552' y='436' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='560' y='436' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='568' y='436' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='576' y='436' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='584' y='436' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='608' y='132' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='608' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='276' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='308' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='340' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='372' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='404' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='452' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='608' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='644' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='608' y='660' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='616' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='436' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='648' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='84' fill='currentColor' style='font-size:1em'>M</text>
<text text-anchor='middle' x='656' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='436' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='656' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='656' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='84' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='664' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='436' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='664' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='664' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='84' fill='currentColor' style='font-size:1em'>M</text>
<text text-anchor='middle' x='672' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='672' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='84' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='680' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='680' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='84' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='688' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='688' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='84' fill='currentColor' style='font-size:1em'>Y</text>
<text text-anchor='middle' x='696' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='696' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='704' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='712' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='720' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='728' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='736' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='744' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='752' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='760' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='452' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='768' y='660' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='776' y='132' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='776' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='276' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='308' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='340' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='372' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='404' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='452' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='776' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='644' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='776' y='660' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='808' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='808' y='420' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='824' y='436' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='832' y='292' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='832' y='436' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='840' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='840' y='436' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='848' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='848' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='856' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='864' y='292' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='864' y='436' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='880' y='436' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='888' y='436' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<p>This should give you a little idea of how the references work and where does the <code>0x1</code> is actually stored.</p>
<p>With that out of our plate, let&rsquo;s get back to the original instruction in question - <code>mov     DWORD PTR [rbp-4], 1</code>. This instruction surely stores the value <code>0x1</code> in the location pointed by <code>rbp - 4</code> memory location.</p>
<p>Then there is the same old <code>nop</code> and <code>epilogue</code>. Nothing new here. Let&rsquo;s add more variables to the function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Below is the disassembly for this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-16</span><span class="p">],</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-20</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Each variable is created in sequence and have a space of <code>4</code> bytes to save an <code>int</code> type data in it. <code>Int</code> data types have a size of <code>4</code> bytes, so this makes sense.</p>
<p>Another commonly used data type is <code>char</code>, which requires a smaller size than <code>int</code>, <code>1 byte</code> in total.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Yes, the above program is completely correct from the standpoint of a compiler. When storing data in char types, we don&rsquo;t always need single quotes.</p>
<p>Anyway, the disassembly for this is as follows:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-3</span><span class="p">],</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-5</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>There is now a noticeable difference between this disassembly and the previous one. The <code>DWORD</code> has been changed to <code>BYTE</code> in this case, which means that less memory is required to store this data, as evidenced by the memory locations used for storage - <code>rbp-1,</code> <code>rbp-2</code>, and so on - each of which has only <code>1 byte</code> of storage.</p>
<p>Fun thing, with the help of some computer maths, we can find out that the highest number that can be stored in 1 byte storage location is 127. So if we store any number bigger than this, it&rsquo;ll start shifting to the negative range and then loop back.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">129</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>disassembly for this code:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="p">-</span><span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-3</span><span class="p">],</span> <span class="p">-</span><span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="p">-</span><span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Good, now we also know how <code>int</code> and <code>char</code> looks like in their disassembly output. Let&rsquo;s mix things up a bit to level up and learn something new.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">129</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">131</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>4 <code>char</code> and then 1 <code>int</code>.</p>
<ul>
<li><code>rbp-1</code> for <code>a</code>.</li>
<li><code>rbp-2</code> for <code>b</code>.</li>
<li><code>rbp-3</code> for <code>c</code>.</li>
<li><code>rbp-4</code> for <code>d</code>.</li>
<li><code>rbp-8</code> for <code>e</code>. Because int takes 4 bytes (This can depend on the OS, architecture and compiler you are using).</li>
</ul>
<p>Let&rsquo;s check the disassembly to see if we got this right or not.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="p">-</span><span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-3</span><span class="p">],</span> <span class="p">-</span><span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="p">-</span><span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">131</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Woohooo!!</p>
<p><img loading="lazy" src="https://media.giphy.com/media/xT1Ra6fhiJdvL7A8hi/giphy.gif#center" alt=""  />
</p>
<p>Though there is one thing I want you to notice&hellip; The <code>int</code> value did not follow the same pattern as <code>char</code> values because <code>char</code> is smaller in size and cannot store a very large value, whereas <code>int</code> is comparatively larger and can store the assigned value without any storage issues. As a result, the <code>int</code> value remained unchanged from the source code, while the <code>char</code> values became negative.</p>
<p>Now, let&rsquo;s change the order of the variables and see how it gets interesting.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">131</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">129</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>disassembly for this code:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="p">-</span><span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">131</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-9</span><span class="p">],</span> <span class="p">-</span><span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-10</span><span class="p">],</span> <span class="p">-</span><span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>Well, you can see the size needed for each variable has changed. It&rsquo;s time to be aware of a concept called <a href="https://en.wikipedia.org/wiki/Data_structure_alignment"><strong>Data structure alignment</strong></a>.</p>
<p>According to wikipedia,</p>
<blockquote>
<p>The CPU in modern computer hardware performs reads and writes to memory most efficiently when the data is naturally aligned, which generally means that the data&rsquo;s memory address is a multiple of the data size. For instance, in a 32-bit architecture, the data may be aligned if the data is stored in four consecutive bytes and the first byte lies on a 4-byte boundary.</p>
</blockquote>
<p>Read <a href="https://developer.ibm.com/articles/pa-dalign/">this article</a> <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> to gain better understanding of data alignment and why is it even a concerning thing for us.</p>
<p>For now, just know that usually 64-bit CPUs have a native 4-byte load. That means, it can pick up 4 bytes in a single turn and use them for something.</p>
<p>Let&rsquo;s visualize the memory layout for the variables in above code.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 240 393"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='32' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='196' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='32' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='32' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='228' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='48' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='372' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='56' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='100' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='56' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='228' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='56' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='64' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='100' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='64' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='228' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='64' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='228' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='72' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='132' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='80' y='196' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='80' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='260' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='80' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='80' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='100' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='96' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='228' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='96' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='96' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='4' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='228' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='104' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='100' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='112' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='228' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='112' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='112' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='100' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='120' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='120' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='228' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='120' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='128' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='260' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='356' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='144' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='152' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='152' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='160' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='176' y='196' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='176' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='260' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='192' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='200' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='356' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='208' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='224' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='260' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='372' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<p>The above diagram of memory is aligned in a 4 byte load. The first 2 variables are a <code>BYTE</code> type so the values are places in the first 2 blocks of the first row. Next variable is an <code>INT</code> type, which is equivalent to 4 bytes. But there are no 4 bytes available in the first row, so in order to keep the atomicity, this variable was stored in the next row. <em>(<a href="https://stackoverflow.com/questions/36624881/why-is-integer-assignment-on-a-naturally-aligned-variable-atomic-on-x86">WHY atomicity??</a>)</em></p>
<p>So does it mean that we have that 2 bytes space just lying there?? - YES! you can use it if you want. Take a look at the below source code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">111</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">112</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">131</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">129</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="p">-</span><span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-3</span><span class="p">],</span> <span class="mi">111</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">112</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span> <span class="mi">131</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-9</span><span class="p">],</span> <span class="p">-</span><span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-10</span><span class="p">],</span> <span class="p">-</span><span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>No change in the layout&hellip; variable <code>x</code> and <code>y</code> will fill up the 2 Bytes space that were just lying there to be used.</p>
<p>But if we add 1 more variable <code>z</code>, then the whole thing moves.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">111</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">112</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">Z</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">131</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">129</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">130</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">push</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">rbp</span><span class="p">,</span> <span class="no">rsp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-1</span><span class="p">],</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-2</span><span class="p">],</span> <span class="p">-</span><span class="mi">128</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-3</span><span class="p">],</span> <span class="mi">111</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span> <span class="mi">112</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-5</span><span class="p">],</span> <span class="mi">123</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-12</span><span class="p">],</span> <span class="mi">131</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-13</span><span class="p">],</span> <span class="p">-</span><span class="mi">127</span>
</span></span><span class="line"><span class="cl">        <span class="nf">mov</span>     <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-14</span><span class="p">],</span> <span class="p">-</span><span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pop</span>     <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span></code></pre></div><p>If you are still visualizing the way I displayed above, now we have 3 bytes space in the row 2. This space is added by the compiler and is termed as <strong>padding</strong>. We can not always avoid padding, but a good programmer can arrange the variables in a way to minimize this.</p>
<p>That was a long detour, but definetily worth it. I&rsquo;ll cover more examples in later parts of this series. Till then, ciao!!</p>
<p><img loading="lazy" src="https://media.giphy.com/media/ie6l26rkxYA885tLqo/giphy.gif#center" alt=""  />
</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://en.wikipedia.org/wiki/Disassembler#Examples_of_disassemblers">https://en.wikipedia.org/wiki/Disassembler#Examples_of_disassemblers</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://developer.ibm.com/articles/pa-dalign/">https://developer.ibm.com/articles/pa-dalign/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>Intro to Re: C : part-1</title>
      <link>https://ayedaemon.github.io/post/2022/09/intro-to-re/</link>
      <pubDate>Wed, 21 Sep 2022 01:10:18 +0530</pubDate>
      
      <guid>https://ayedaemon.github.io/post/2022/09/intro-to-re/</guid>
      <description>Basics of assembly and its relation with higher level constucts</description>
      <content:encoded><![CDATA[<h2 id="steps-to-generate-a-binary">Steps to generate a binary</h2>
<p>When we write a program using a language like C, it is not C source code which really gets executed. This C code passes through many steps and finally a binary file is generated out of it. This binary file is what gets executed on any computer.</p>
<p>There are many steps through which a C code is converted into a binary file:-</p>
<ol>
<li>Pre-processing</li>
<li>Compilation</li>
<li>Assemble</li>
<li>Linking</li>
</ol>
<p>Let&rsquo;s follow these steps one by one to understand what they do to the C code and how a binary is generated via this. To get started, we need a C program that we would want to convert into a binary.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="c1">//file: hello_world.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// main function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Hello World&#34;</span><span class="p">);</span>  <span class="c1">// Print &#34;Hello World&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">5</span><span class="p">;</span>               <span class="c1">// Return with 5 return value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>If you are even a bit familiar with C programs, you would understand that the above program will create a <code>main()</code> function, call <code>printf()</code> function to print <code>Hello World</code> string and finally return with a <code>5</code> return value.</p>
<h4 id="pre-processing">Pre-processing</h4>
<p>Let&rsquo;s see what we get after <strong>pre-processing</strong> this C program. With gcc this can be done via below command</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc -E hello_world.c -o hello_world.i
</span></span></code></pre></div><p>This takes the provided C program and does many things to it, few of these are mentioned below.</p>
<ul>
<li>Removes the comments.</li>
<li>Replaces the <code>#include</code> statements with the actual file content. For example, <code>#include&lt;stdio.h&gt;</code> is replaced with <code>stdio.h</code> file contents.</li>
</ul>
<h4 id="compilation">Compilation</h4>
<p>After pre-processing, the generated file is used to generate assembly instructions. These instructions are microprocessor (or CPU) specific. Microprocessor is a computer component that handles all kinds of conditional logic, arithmatic calculations and other logical activities.</p>
<p>You might have heard about few types of micro processor families like intel x86 and ARM.. but there are <a href="https://en.wikipedia.org/wiki/List_of_microprocessor">many more</a>. Unfortunately, each family has their own instruction sets to perform different tasks.</p>
<p>We can convert our <strong>pre-processed</strong> code file to equivalent <strong>assembly</strong> code using <code>gcc</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc -S hello_world.i -o hello_world.s
</span></span></code></pre></div><p>This will provide us with a <code>hello_world.s</code> file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file hello_world.s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.s: assembler source, ASCII text</span>
</span></span></code></pre></div><p>This step produces an assembly language source code for my micro-processor family (intel x86-64). If you want to generate assembly code for other families (also called, architectures), you might want to look into <a href="https://en.wikipedia.org/wiki/Cross_compiler"><strong>cross-compilers</strong></a></p>
<p>This assembly code is what get&rsquo;s executed by the processor. If we look into this file, we will be able to see the assembly code for the C program we wrote.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat hello_world.s
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">        <span class="na">.file</span>   <span class="s">&#34;hello_world.c&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">.text</span>
</span></span><span class="line"><span class="cl">        <span class="na">.section</span>        <span class="no">.rodata</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LC0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.string</span> <span class="s">&#34;Hello World&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">.text</span>
</span></span><span class="line"><span class="cl">        <span class="na">.globl</span>  <span class="no">main</span>
</span></span><span class="line"><span class="cl">        <span class="na">.type</span>   <span class="no">main</span><span class="p">,</span> <span class="na">@function</span>
</span></span><span class="line"><span class="cl"><span class="nl">main:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LFB0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_startproc</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pushq</span>   <span class="nv">%rbp</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_def_cfa_offset</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_offset</span> <span class="mi">6</span><span class="p">,</span> <span class="p">-</span><span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movq</span>    <span class="nv">%rsp</span><span class="p">,</span> <span class="nv">%rbp</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_def_cfa_register</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">        <span class="nf">leaq</span>    <span class="no">.LC0</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span> <span class="nv">%rax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movq</span>    <span class="nv">%rax</span><span class="p">,</span> <span class="nv">%rdi</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movl</span>    <span class="no">$0</span><span class="p">,</span> <span class="nv">%eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">call</span>    <span class="no">printf@PLT</span>
</span></span><span class="line"><span class="cl">        <span class="nf">movl</span>    <span class="no">$5</span><span class="p">,</span> <span class="nv">%eax</span>
</span></span><span class="line"><span class="cl">        <span class="nf">popq</span>    <span class="nv">%rbp</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_def_cfa</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">        <span class="na">.cfi_endproc</span>
</span></span><span class="line"><span class="cl"><span class="nl">.LFE0:</span>
</span></span><span class="line"><span class="cl">        <span class="na">.size</span>   <span class="no">main</span><span class="p">,</span> <span class="no">.-main</span>
</span></span><span class="line"><span class="cl">        <span class="na">.ident</span>  <span class="s">&#34;GCC: (GNU) 12.1.1 20220730&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">.section</span>        <span class="no">.note.GNU-stack</span><span class="p">,</span><span class="s">&#34;&#34;</span><span class="p">,</span><span class="na">@progbits</span>
</span></span></code></pre></div><p>This is what the intermediate code in assembly language looks like. We&rsquo;ll talk more about this in later sections. For now, let&rsquo;s move forward and see how a binary file is created from this assembly code.</p>
<h2 id="assembling-into-binary">Assembling into binary</h2>
<p>We can convert the assembly code to binary file using <code>gcc</code> via the below command:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc -c hello_world.s -o hello_world.o
</span></span></code></pre></div><p>This will generate the binary object file, which can be analyzed with tools like <code>objdump</code> and <code>hexdump</code>. This file is the binary file for the source code we wrote, but we need more than that for the program to actually execute on terminal with <code>./hello_world.o</code>.</p>
<h4 id="linking-the-binary">Linking the binary</h4>
<p>This last step will take your obect file (<code>.o</code> files from last step) and produce either a library or an executable file. It replaces the references to undefined symbols with the correct addresses. There are many more things going in here other than this, so to keep it short and simple - this step will create your executable from your object file by linking it with other required files like standard libraries. Ultimately, this will generate the executable or library which we can use or distribute it.</p>
<p>Using gcc, we can achieve this with:-</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## -v option is just to print the verbose output.</span>
</span></span><span class="line"><span class="cl">gcc -v hello_world.o -o hello_world.out
</span></span></code></pre></div><p>After all these steps, we have our binary file and all other intermediate files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">file *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.c:   C source, ASCII text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.i:   C source, ASCII text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.o:   ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.out: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=c6293fa95c56250957a3babeecd8d18fc463e7cf, for GNU/Linux 4.4.0, with debug_info, not stripped</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># hello_world.s:   assembler source, ASCII text</span>
</span></span></code></pre></div><p>To summarize everything, the C program we write goes through various steps to generate an executable binary file. And this binary file is what executes on our machine&hellip;.or in another words, this binary tells our processors about what job we want them to do.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/oYtVHSxngR3lC/giphy.gif#center" alt=""  />
</p>
<h2 id="reverse-engineering">Reverse Engineering??</h2>
<p>Reverse Engineering is the process of figuring out how something works. This process can be applied to approximately anything even computer programs.</p>
<p>If we are provided with a compiled, assembled and linked binary file, we can apply the process of reverse engineering to understand what that program does. This skill can be useful for many tasks like generating keygens, patches, understanding low-level vulnerabilities, profiling applications, malware analysis, etc..</p>
<p>Since assembly language is the closest human-readable language for any binary, we need to have a good understanding of that to perform good reverse engineering. Obviously this varies with compilers used and architecture for which the binary was compiled&hellip; So we need might need to learn about how different compilers generate assembly code for different micro-processor families.</p>
<p>Most of the times we are provided with the binary file for programs instead of the source code, therefore, we only have assembly representation to work from. However there are tools like ghidra that takes the compiled assembly code and give us a view of what the C code for that binary might look like. This is called <a href="https://en.wikipedia.org/wiki/Decompiler">decompilation</a>.</p>
<h4 id="binary----assembly-assembly----disassembly">binary &lt;&ndash;&gt; assembly (assembly &lt;&ndash;&gt; disassembly)</h4>
<p>At this point, we know about how a C program gets converted to a binary file after the complete compilation process. Let us understand more about the relation between a binary file and it&rsquo;s assembly code.</p>
<p>We have already seen that the intermediate assembly code can be converted to binary file via assemblers (in our case, gcc assembler feature). The inverse can be done via <a href="https://en.wikipedia.org/wiki/Disassembler"><strong>disassemblers</strong></a>.</p>
<p>A disassembler takes the binary file as input and read it&rsquo;s contents and maps the binary values to it&rsquo;s respective assembly instructions.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 376 25"
      >
      <g transform='translate(8,16)'>
<path d='M 112,0 L 128,0' fill='none' stroke='currentColor'></path>
<path d='M 232,0 L 248,0' fill='none' stroke='currentColor'></path>
<polygon points='136.000000,0.000000 124.000000,-5.600000 124.000000,5.600000' fill='currentColor' transform='rotate(0.000000, 128.000000, 0.000000)'></polygon>
<polygon points='256.000000,0.000000 244.000000,-5.600000 244.000000,5.600000' fill='currentColor' transform='rotate(0.000000, 248.000000, 0.000000)'></polygon>
<text text-anchor='middle' x='0' y='4' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='8' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='16' y='4' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='24' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='40' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='56' y='4' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='64' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='72' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='80' y='4' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='88' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='144' y='4' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='152' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='160' y='4' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='336' y='4' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='4' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='352' y='4' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='360' y='4' fill='currentColor' style='font-size:1em'>e</text>
</g>

    </svg>
  
</div>
<p>There are many disassemblers we can use like:-</p>
<ul>
<li><a href="https://www.man7.org/linux/man-pages/man1/objdump.1.html">objdump</a></li>
<li><a href="https://ghidra-sre.org/">ghidra</a></li>
<li><a href="https://rada.re/n/radare2.html">radare2</a></li>
<li><a href="https://sourceware.org/gdb/">gdb</a></li>
<li><a href="https://www.hopperapp.com/">hopper</a></li>
<li>and <a href="https://en.wikipedia.org/wiki/Disassembler#Examples_of_disassemblers">many more</a></li>
</ul>
<p>Let&rsquo;s try to disassemble our <code>hello_world.out</code> binary and see what it provides us.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">objdump --disassemble  hello_world.out <span class="p">|</span> wc -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 122</span>
</span></span></code></pre></div><p>Objdump provides a lot of output for the disassembly of a simple &ldquo;Hello Wold&rdquo; program. This is because we linked the <code>hello_world.o</code> file to obtain a <code>hello_world.out</code> file. This new file has a lot of things that helps this to run on the machine with <code>./hello_world.out</code> command.</p>
<p>If we check the unlined version of our binary, we&rsquo;ll get a lot less output.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">objdump --disassemble  hello_world.o <span class="p">|</span> wc -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Looking at the disassembled binary</span>
</span></span><span class="line"><span class="cl">objdump --disassemble  hello_world.o
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 0000000000000000 &lt;main&gt;:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    0:   55                      push   %rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    1:   48 89 e5                mov    %rsp,%rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    4:   48 8d 05 00 00 00 00    lea    0x0(%rip),%rax        # b &lt;main+0xb&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    b:   48 89 c7                mov    %rax,%rdi</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    e:   b8 00 00 00 00          mov    $0x0,%eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   13:   e8 00 00 00 00          call   18 &lt;main+0x18&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   18:   b8 05 00 00 00          mov    $0x5,%eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   1d:   5d                      pop    %rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   1e:   c3                      ret</span>
</span></span></code></pre></div><p>The same results can be obtained from our linked binary, if we only ask <code>objdump</code> to disassemble <code>main()</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">objdump --disassemble<span class="o">=</span>main hello_world.out
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 0000000000001139 &lt;main&gt;:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1139:       55                      push   %rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     113a:       48 89 e5                mov    %rsp,%rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     113d:       48 8d 05 c0 0e 00 00    lea    0xec0(%rip),%rax        # 2004 &lt;_IO_stdin_used+0x4&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1144:       48 89 c7                mov    %rax,%rdi</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1147:       b8 00 00 00 00          mov    $0x0,%eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     114c:       e8 df fe ff ff          call   1030 &lt;printf@plt&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1151:       b8 05 00 00 00          mov    $0x5,%eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1156:       5d                      pop    %rbp</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     1157:       c3                      ret</span>
</span></span></code></pre></div><p>Ofcourse, few things are different like the numbers in first column (these numbers are offset values, we don&rsquo;t need to understand them right now)&hellip;. But if we focus only on the <em>second column</em> and <em>third column</em> which are <a href="https://en.wikipedia.org/wiki/Opcode"><strong>hexa-decimal values or opcodes</strong></a> and <strong>assembly code/representation</strong> respectively.</p>
<p>The main difference between a <code>.o</code> and <code>.out</code> file is that the <code>.o</code> file is not yet linked to any platoform dependent libraries. Here is a <a href="https://stackoverflow.com/questions/58245469/o-vs-out-in-c">good stackoverflow thread</a> about the same topic.</p>
<p>The assembly code has a syntax structure, which is a good point to start understanding how they work. Each line in the above output contains 1 assembly instruction &hellip; and every instruction is composed of either 1, 2 or 3 keywords. These can be represented in below syntax.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## Syntax by Intel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">| Keyword1     | Keyword2   | Keyword3   |
</span></span><span class="line"><span class="cl">|--------------|------------|------------|
</span></span><span class="line"><span class="cl">| OPCODE       | destination| source     |
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    or 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">## Syntax by AT&amp;T
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">| Keyword1     | Keyword2  | Keyword3    |
</span></span><span class="line"><span class="cl">|--------------|-----------|-------------|
</span></span><span class="line"><span class="cl">| OPCODE       | source    | destination |
</span></span></code></pre></div><p>There are few other differences between these 2 syntaxes..but this does not change anything in logic or working of the binary. You can think of them as different kinds of representations for the same thing. Read more from <a href="https://web.mit.edu/rhel-doc/3/rhel-as-en-3/i386-syntax.html">here: AT&amp;T Syntax versus Intel Syntax</a> and <a href="https://stackoverflow.com/questions/8549427/nasm-intel-versus-att-syntax-what-are-the-advantages#8550917">here: StackOverflow - NASM (Intel) versus AT&amp;T Syntax: what are the advantages?</a>. I prefer to use <strong>Intel</strong> syntax and will be using that throughout this article.</p>
<p>By default, <code>objdump</code> provides <em>AT&amp;T</em> syntax but you can explicitely ask it to provide the <em>intel</em> syntax using <code>--disassembler-options=intel</code> flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">objdump --disassemble<span class="o">=</span>main --disassembler-options<span class="o">=</span>intel hello_world.out
</span></span></code></pre></div><p>output</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0000000000001139 &lt;main&gt;:
</span></span><span class="line"><span class="cl">    1139:       55                      push   rbp
</span></span><span class="line"><span class="cl">    113a:       48 89 e5                mov    rbp,rsp
</span></span><span class="line"><span class="cl">    113d:       48 8d 05 c0 0e 00 00    lea    rax,[rip+0xec0]        # 2004 &lt;_IO_stdin_used+0x4&gt;
</span></span><span class="line"><span class="cl">    1144:       48 89 c7                mov    rdi,rax
</span></span><span class="line"><span class="cl">    1147:       b8 00 00 00 00          mov    eax,0x0
</span></span><span class="line"><span class="cl">    114c:       e8 df fe ff ff          call   1030 &lt;printf@plt&gt;
</span></span><span class="line"><span class="cl">    1151:       b8 05 00 00 00          mov    eax,0x5
</span></span><span class="line"><span class="cl">    1156:       5d                      pop    rbp
</span></span><span class="line"><span class="cl">    1157:       c3                      ret
</span></span></code></pre></div><p>The purpose of higher level languages like C is that we don&rsquo;t have to deal with all this assembly code for all things. To effectively use assembly there are a lot of things we need to understand and think continously according to them. With higher level languages, we can write the code more easily and then pass that code to compiler, and that will generate a assembly code and binary file for us to use&hellip;</p>
<h4 id="heap-stack-and-registers">Heap, Stack and Registers</h4>
<p>Every C process (<a href="https://www.geeksforgeeks.org/difference-between-program-and-process/">not program</a>) use many things to work, 4 of them are - Heap, Stack, Registers and Instructions. We have just understood about the instructions in previous section, now let us start with others.</p>
<p><strong>Heap</strong> is one of the memory alocation strategy used for dynamic storage allocations, ie, allocating memory at run time. The actual working of the heap is a bit complex and is out of scope for this article. For now, keep in mind that any calls to <code>malloc</code>, <code>calloc</code> or any other similar kind of function will allocate memory in heap. All objects which have dynamic storage duration are suitable for heap.</p>
<p><strong>Registers</strong> are small storage areas in the processors, which are used by instructions to store multiple values. They can store anything upto their size limits. Different architectures have different size of registers ranging from 8 bit to 64 bit registers. There are even 128, 256, and 512-bit registers. <a href="https://stackoverflow.com/questions/52932539/what-are-the-128-bit-to-512-bit-registers-used-for">Here is a stackoverflow thread</a> for the same.</p>
<p>Back in early days (1972), Intel added few 8-bit general purpose registers to their microprocessors&hellip;general purpose registers are used for general purposes like storing return values, temporary calculation results, etc..</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 112 169"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='16' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='16' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='68' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='100' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='132' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='96' y='52' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='96' y='84' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='96' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='96' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>┤</text>
</g>

    </svg>
  
</div>
<p>Later these 8-bit registers were updated with 16-bit registers&hellip; This was logically partitioned into two 8-bit registers, maybe to back-support the old systems/softwares that used needed 8 bit registers to work, Anyways, the new registers looked something like this&hellip;</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 512 201"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='48' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='48' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='48' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='48' y='180' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='80' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='88' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='68' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='100' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='132' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='164' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='88' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='96' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='68' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='96' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='100' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='132' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='164' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='96' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>┼</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='180' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='152' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='168' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='100' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='164' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='168' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='100' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='176' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='180' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='336' y='52' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='336' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='336' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='336' y='180' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='68' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='408' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='132' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='408' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='408' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='68' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='416' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='416' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='416' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='424' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='432' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='488' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='116' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='52' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='84' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='496' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='116' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='148' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='180' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<p>These 16-bit registers were partitioned into 2 sections, higher address (H) and lower address (L).</p>
<p>Following that, few years later, 16-bit registers were extended to support 32 bit softwares, adding an <code>E</code> prefix. And after that adding a <code>R</code> prefix for 64 bit registers.</p>
<p>Diagram below shows how these registers are mapped to support previous designs/architectures.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 664 425"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='8' y='340' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='8' y='372' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='8' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='8' y='404' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='16' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='16' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='16' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='24' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='32' y='388' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='32' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='40' y='388' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='40' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='388' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='48' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='388' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='56' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='388' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='64' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='388' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='80' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='388' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='88' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='388' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='96' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='104' y='388' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='104' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='388' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='112' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='388' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='120' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='388' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='136' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='388' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='144' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='388' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='152' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='388' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='160' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='388' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='168' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='176' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='388' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='184' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='388' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='200' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='388' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='388' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='216' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='388' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='388' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='240' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='388' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='256' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='388' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='388' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='272' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='388' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='388' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='288' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='340' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='304' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='340' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='312' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='228' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='328' y='260' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='328' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='328' y='340' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='328' y='372' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='328' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='404' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='336' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='340' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='344' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='340' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='352' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='340' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='340' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='376' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='340' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='384' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='340' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='392' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='340' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='400' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='340' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='408' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='456' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='228' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='464' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='228' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='480' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='196' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='488' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='388' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='488' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='496' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='496' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='388' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='496' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='388' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='504' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='228' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='512' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='228' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='520' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='180' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='528' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='228' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='528' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='180' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='536' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='228' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='536' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='544' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='228' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='544' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='132' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='552' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='52' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='560' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='84' fill='currentColor' style='font-size:1em'>└</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='560' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='568' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='132' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='568' y='164' fill='currentColor' style='font-size:1em'>┬</text>
<text text-anchor='middle' x='568' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='568' y='196' fill='currentColor' style='font-size:1em'>┴</text>
<text text-anchor='middle' x='568' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='576' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='584' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='20' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='592' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='132' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='592' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='600' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='68' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='600' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='132' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='600' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='608' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='132' fill='currentColor' style='font-size:1em'>X</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='180' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='608' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='616' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='132' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='616' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='180' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='616' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='340' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='20' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='640' y='52' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='640' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='640' y='84' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='640' y='132' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='640' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='228' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='640' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='340' fill='currentColor' style='font-size:1em'>►</text>
<text text-anchor='middle' x='640' y='372' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='648' y='164' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='648' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='648' y='196' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='648' y='260' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='648' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='648' y='292' fill='currentColor' style='font-size:1em'>┘</text>
<text text-anchor='middle' x='648' y='372' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='648' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='648' y='404' fill='currentColor' style='font-size:1em'>┘</text>
</g>

    </svg>
  
</div>
<p>Nowadays, 64-bit and 32-bit systems are very common and can be easily found. Knowing this is very important to reverse engineer arithmatic and logic calculations from any disassembly code.</p>
<p>Apart from these general register, there are 3 special purpose registers - <code>ebp</code>, <code>esp</code> and <code>eip</code>. These registers are generally used to point to different memory locations of the stack. There are some times when we need to store the values of these registers on to the stack (Another kind of memory area used by processes). We&rsquo;ll see some of those cases as we go further.</p>
<p><strong>Stack</strong> is a data structure in memory which operates with 2 operations - <code>push</code> and <code>pop</code>. <em>Push</em> adds an element to the top of the stack and <code>pop</code> removes the top element of the stack.</p>
<p>Each element on the stack has an assigned stack address which can be used to refer any location on the stack. The stack is upside down - means that the stack grows towards the lower memory addresses.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 592 537"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='72' y='516' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='80' y='516' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='88' y='516' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='104' y='516' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='112' y='516' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='516' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='516' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='136' y='260' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='136' y='516' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='144' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='372' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='144' y='516' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='516' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='160' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='168' y='260' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='168' y='372' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='176' y='372' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='184' y='260' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='192' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='372' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='212' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='200' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='200' y='308' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='200' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='260' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='208' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='216' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='372' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='224' y='324' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='420' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='232' y='260' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='372' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='256' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='196' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='256' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='308' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='256' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='420' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='256' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='256' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='280' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='288' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='244' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='288' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='356' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='288' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='296' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='244' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='296' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='356' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='296' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='244' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='304' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='356' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='304' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='244' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='312' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='356' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='312' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='356' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='328' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='84' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='196' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='420' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='368' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='196' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='368' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='308' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='368' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='420' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='368' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='456' y='484' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='496' y='212' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='496' y='244' fill='currentColor' style='font-size:1em'>G</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='496' y='308' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='504' y='212' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='504' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='504' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='512' y='244' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='512' y='276' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='512' y='308' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='520' y='212' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='520' y='244' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='520' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='212' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='528' y='244' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='528' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='528' y='308' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='536' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='536' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='544' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='544' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='552' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='560' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='568' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='576' y='308' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<p>Whenever a function is called it creates its stack frame, and all the local variables for that function will be stored in that function&rsquo;s stack frame. This introduces the need to track 2 values for the current stack frame.</p>
<ol>
<li>What is the base of the stack frame? Where did the stack frame start?</li>
<li>What is the top most location of the stack frame? How much the stack has grown?</li>
</ol>
<p>These are tracked by 2 special purpose registers - <code>rbp</code> (64-bit base pointer register) and <code>rsp</code> (64-bit stack pointer register) respectively.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 472 553"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='24' y='532' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='532' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='40' y='532' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='56' y='532' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='64' y='532' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='532' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='532' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='532' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='532' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='104' y='532' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='120' y='244' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='128' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='128' y='356' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='128' y='468' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='136' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='136' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='136' y='468' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='144' y='244' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='144' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='152' y='356' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='152' y='468' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='160' y='468' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='168' y='244' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='176' y='468' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='196' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='184' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='292' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='184' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='468' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='244' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='420' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='192' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='516' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='200' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='200' y='468' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='208' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='180' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='208' y='308' fill='currentColor' style='font-size:1em'>▲</text>
<text text-anchor='middle' x='208' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='208' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>▼</text>
<text text-anchor='middle' x='208' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='224' y='468' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='180' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='240' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='292' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='240' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='404' fill='currentColor' style='font-size:1em'>├</text>
<text text-anchor='middle' x='240' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='264' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='228' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='340' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='272' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='452' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='280' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='280' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='228' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='340' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='280' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='452' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='288' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='288' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='228' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='340' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='288' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='452' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='296' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='228' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='340' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='452' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='304' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='228' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='340' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='312' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='452' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='320' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='180' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='68' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='352' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='352' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='352' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='404' fill='currentColor' style='font-size:1em'>┤</text>
<text text-anchor='middle' x='352' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='376' y='404' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='376' y='484' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='384' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='484' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='484' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='484' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='484' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='404' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='484' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='440' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='448' y='404' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='448' y='484' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='456' y='404' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='456' y='484' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>Let&rsquo;s take another example to understand how this would work for a regular C program.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">func2</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="kt">int</span> <span class="n">e</span><span class="p">,</span> <span class="kt">int</span> <span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">g</span><span class="p">,</span> <span class="kt">int</span> <span class="n">h</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">e</span> <span class="o">+</span> <span class="n">f</span> <span class="o">+</span> <span class="n">g</span> <span class="o">+</span> <span class="n">h</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">ch</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">func1</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span>  <span class="o">=</span> <span class="nf">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">func1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This is roughly what the execution flow of the above program will look like&hellip;</p>
<ol>
<li><code>main()</code> calls <code>func1()</code> function without any arguments.</li>
<li><code>func1()</code> function allocates some memory for <code>int x</code> and then calls <code>func2()</code> functions with a single integer type argument.</li>
<li><code>func2()</code> function creates some local variables - both with hardcoded value and using passed arguments.</li>
<li>And then returns a variable back to <code>func1()</code>.</li>
<li>Finally the control is passed back to <code>main()</code>.</li>
</ol>
<p>If you visualise the stack just before the <code>main()</code> function is loaded on stack.. the stack will be something like this:-</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 504 137"
      >
      <g transform='translate(8,16)'>
<circle cx='200' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='248' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='248' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>#</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>#</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>B</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='32' y='100' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='40' y='84' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='40' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='48' y='100' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='56' y='100' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='84' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='64' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='72' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='80' y='100' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='88' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='96' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='104' y='100' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='112' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='112' y='100' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='120' y='100' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='100' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='52' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='344' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='344' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='344' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='376' y='52' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='376' y='100' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='384' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='52' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='100' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='456' y='100' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='464' y='52' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='464' y='100' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='472' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='472' y='100' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>After this, the <code>main()</code> function loads its variables on the stack.. this will cause the return address to be loaded on to the stack, which will be used once the <code>main()</code> function has completed it&rsquo;s execution&hellip; This is the address which tells where to go back once the <code>main()</code> function returns. Visually the stack will look something like this.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 592 105"
      >
      <g transform='translate(8,16)'>
<circle cx='184' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='88' y='52' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='112' y='52' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='168' y='4' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='176' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='68' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='208' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='216' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='248' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='68' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='264' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='68' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='288' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='296' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='4' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='4' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='328' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='352' y='68' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='360' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='440' y='68' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='448' y='68' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='472' y='68' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='480' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='68' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='68' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='560' y='68' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='568' y='68' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>Notice that the <code>rbp</code> and <code>rsp</code> are also moved&hellip; <code>rsp</code> will move where the stack&rsquo;s top is&hellip; and <code>rbp</code> will point to the base of the current stack frame. This is what the loading of a function looks like. This is called <a href="https://en.wikipedia.org/wiki/Function_prologue_and_epilogue#Prologue"><strong>Prologue</strong></a></p>
<p>Now the <code>rip</code> (64-bit instruction pointer) will point to <code>main()</code> function&rsquo;s code block and will execute those instructions one by one. This will push more values to stack as required&hellip; not all things are needed to be added to stack. We only push those values to stack which we need to save for later use and then pop when it is no longer required.</p>
<p>Looking at the disassembly of <code>main()</code> function will help us to understand more what will be added to stack.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">0000000000001153</span> <span class="err">&lt;</span><span class="nf">main</span><span class="err">&gt;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">1153:</span>       <span class="err">55</span>                      <span class="nf">push</span>   <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">1154:</span>       <span class="err">48</span> <span class="err">89</span> <span class="nf">e5</span>                <span class="no">mov</span>    <span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span>
</span></span><span class="line"><span class="cl">    <span class="err">1157:</span>       <span class="nf">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="mi">0x0</span>
</span></span><span class="line"><span class="cl">    <span class="err">115</span><span class="nl">c:</span>       <span class="nf">e8</span> <span class="no">da</span> <span class="no">ff</span> <span class="no">ff</span> <span class="no">ff</span>          <span class="no">call</span>   <span class="mh">113b</span> <span class="p">&lt;</span><span class="no">func1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="err">1161:</span>       <span class="nf">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="mi">0x0</span>
</span></span><span class="line"><span class="cl">    <span class="err">1166:</span>       <span class="err">5</span><span class="nf">d</span>                      <span class="no">pop</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">1167:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p>Here, the above 2 lines make what we call <strong>Prologue</strong>. This pushes previous <code>rbp</code> to stack (stores returning point) and then updates the <code>rbp</code> with current <code>rsp</code> (stack pointer) value.</p>
<p>then it moves <code>0x00</code> to <code>eax</code> register&hellip; Purpose of this is to reset <code>eax</code> register as <code>0</code> so that when the <code>func1</code> returns, we are sure that it is not a garbage value. <em>Remember:- <code>eax</code> is another general purpose register that is used by called functions to save the return value. This then can be read by the caller function to know what that function returned.</em></p>
<p>After reseting <code>eax</code>, it <code>call</code>s <code>func1()</code> function&hellip; this will transfer the control to <code>func1()</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">000000000000116</span><span class="nf">a</span> <span class="err">&lt;</span><span class="no">func1</span><span class="err">&gt;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">a:</span>       <span class="err">55</span>                      <span class="nf">push</span>   <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">b:</span>       <span class="err">48</span> <span class="err">89</span> <span class="nf">e5</span>                <span class="no">mov</span>    <span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">e:</span>       <span class="err">48</span> <span class="err">83</span> <span class="nf">ec</span> <span class="mi">10</span>             <span class="no">sub</span>    <span class="no">rsp</span><span class="p">,</span><span class="mi">0x10</span>
</span></span><span class="line"><span class="cl">    <span class="err">1172:</span>       <span class="err">6</span><span class="nf">a</span> <span class="mi">08</span>                   <span class="no">push</span>   <span class="mi">0x8</span>
</span></span><span class="line"><span class="cl">    <span class="err">1174:</span>       <span class="err">6</span><span class="nf">a</span> <span class="mi">07</span>                   <span class="no">push</span>   <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl">    <span class="err">1176:</span>       <span class="err">41</span> <span class="nf">b9</span> <span class="mi">06</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       <span class="no">mov</span>    <span class="no">r9d</span><span class="p">,</span><span class="mi">0x6</span>
</span></span><span class="line"><span class="cl">    <span class="err">117</span><span class="nl">c:</span>       <span class="err">41</span> <span class="nf">b8</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       <span class="no">mov</span>    <span class="no">r8d</span><span class="p">,</span><span class="mi">0x5</span>
</span></span><span class="line"><span class="cl">    <span class="err">1182:</span>       <span class="nf">b9</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">ecx</span><span class="p">,</span><span class="mi">0x4</span>
</span></span><span class="line"><span class="cl">    <span class="err">1187:</span>       <span class="nf">ba</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">edx</span><span class="p">,</span><span class="mi">0x3</span>
</span></span><span class="line"><span class="cl">    <span class="err">118</span><span class="nl">c:</span>       <span class="nf">be</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">esi</span><span class="p">,</span><span class="mi">0x2</span>
</span></span><span class="line"><span class="cl">    <span class="err">1191:</span>       <span class="nf">bf</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">edi</span><span class="p">,</span><span class="mi">0x1</span>
</span></span><span class="line"><span class="cl">    <span class="err">1196:</span>       <span class="nf">e8</span> <span class="mi">7</span><span class="no">e</span> <span class="no">ff</span> <span class="no">ff</span> <span class="no">ff</span>          <span class="no">call</span>   <span class="mh">1119</span> <span class="p">&lt;</span><span class="no">func2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="err">119</span><span class="nl">b:</span>       <span class="err">48</span> <span class="err">83</span> <span class="nf">c4</span> <span class="mi">10</span>             <span class="no">add</span>    <span class="no">rsp</span><span class="p">,</span><span class="mi">0x10</span>
</span></span><span class="line"><span class="cl">    <span class="err">119</span><span class="nl">f:</span>       <span class="err">89</span> <span class="err">45</span> <span class="nf">fc</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a2:</span>       <span class="err">90</span>                      <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a3:</span>       <span class="nf">c9</span>                      <span class="no">leave</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a4:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p><code>func1()</code> will then store the previous (main function&rsquo;s) <code>rbp</code> value to stack.. and update the new base pointer with stack pointer&rsquo;s value. At this point our stack will look something like below:-</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 552 201"
      >
      <g transform='translate(8,16)'>
<circle cx='56' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='56' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='72' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='72' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='88' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='88' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='104' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='104' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='32' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='80' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='80' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='88' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='96' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='112' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='112' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='120' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='120' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='128' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='408' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='528' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='536' y='148' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>Now after the prologue instructions, the instruction pointer (<code>rip</code>) is at instruction <code>113f</code> &ndash;&gt; <code>sub    rsp,0x10</code>. This subtracts <code>0x10</code> from <code>rsp</code> that will increase the gap betweem <code>rbp</code> and <code>rsp</code> resulting in some memory space in the stack frame. This does not overwrite the stack values, but this will create a sense of cleaning the messed up stack.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 632 377"
      >
      <g transform='translate(8,16)'>
<path d='M 568,160 L 568,176' fill='none' stroke='currentColor'></path>
<path d='M 568,176 L 568,192' fill='none' stroke='currentColor'></path>
<path d='M 568,192 L 568,208' fill='none' stroke='currentColor'></path>
<path d='M 568,208 L 568,224' fill='none' stroke='currentColor'></path>
<circle cx='184' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='232' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='48' y='276' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='56' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='64' y='276' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='80' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='276' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='88' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='96' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='96' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='104' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='160' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='192' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='200' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='248' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='336' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='384' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='424' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='424' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='440' y='228' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='520' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='528' y='228' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='536' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='536' y='228' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='592' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='600' y='196' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='608' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='616' y='196' fill='currentColor' style='font-size:1em'>0</text>
</g>

    </svg>
  
</div>
<p>This allocated space is now used to create local variables for the function <code>func1()</code>&hellip; For our case, that will be <code>int x</code>. Integers use only 4 bytes of space for themselves, but <code>gcc</code> by default allocates memory in 16-bytes chunk. That is the reason for <code>rsp</code> to move <code>0x10</code> (16) bytes downwards. We can change this behaviour by explicitely passign  <code>-mpreferred-stack-boundary=n</code> flag to <code>gcc</code>. Read more about this <a href="https://stackoverflow.com/questions/1061818/stack-allocation-padding-and-alignment">here: Stack allocation, padding, and alignment</a></p>
<p>After the memory is allocated on stack for local variables, it is time to call func2 with all the arguments. According to the calling convention defined for x86 assembly instructions, whenever a function is called, it&rsquo;s arguments are first loaded into predefined registers in specific positional order. But due to limitations of general purpose registers, only first 6 arguments are loaded to registers and the rest are pushed to stack.</p>
<p>For this case, there are in total 8 arguments&hellip; out of which 6 will be stored in the general purpose registers and the rest 2 will be pushed to stack.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 600 377"
      >
      <g transform='translate(8,16)'>
<path d='M 536,160 L 536,176' fill='none' stroke='currentColor'></path>
<path d='M 536,176 L 536,192' fill='none' stroke='currentColor'></path>
<path d='M 536,192 L 536,208' fill='none' stroke='currentColor'></path>
<circle cx='152' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='152' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='168' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='168' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='0' y='276' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='8' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='8' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='16' y='276' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='276' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='40' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='40' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='48' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='152' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='168' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='192' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='248' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='392' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='408' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='408' y='276' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='416' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='432' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='440' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='448' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='456' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='464' y='276' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='480' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='504' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='512' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='528' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='536' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='560' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='568' y='196' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='576' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='584' y='196' fill='currentColor' style='font-size:1em'>0</text>
</g>

    </svg>
  
</div>
<p>When more values are pushed to stack, the stack pointer moves more towards lower addresses and the stack frame grows. Here these 2 values are added to stack and then the function is called&hellip;. this will cause the return address to be pushed to stack too (So that control can come back to this location.)</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 608 377"
      >
      <g transform='translate(8,16)'>
<path d='M 544,160 L 544,176' fill='none' stroke='currentColor'></path>
<path d='M 544,176 L 544,192' fill='none' stroke='currentColor'></path>
<path d='M 544,192 L 544,208' fill='none' stroke='currentColor'></path>
<circle cx='160' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='160' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='192' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='192' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='8' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='16' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='24' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='24' y='276' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='32' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='40' y='276' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='48' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='56' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='276' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='64' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='168' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='176' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='200' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='200' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='288' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='288' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='304' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='336' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='360' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='368' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='308' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='416' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='416' y='308' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='432' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='440' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='448' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='456' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='464' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='472' y='308' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='504' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='512' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='308' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='520' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='528' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='536' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='544' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='568' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='576' y='196' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='584' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='592' y='196' fill='currentColor' style='font-size:1em'>0</text>
</g>

    </svg>
  
</div>
<p>After this, the instruction pointer starts pointing towards the instructions of the <code>func2</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">0000000000001119</span> <span class="err">&lt;</span><span class="nf">func2</span><span class="err">&gt;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">1119:</span>       <span class="err">55</span>                      <span class="nf">push</span>   <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">111</span><span class="nl">a:</span>       <span class="err">48</span> <span class="err">89</span> <span class="nf">e5</span>                <span class="no">mov</span>    <span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span>
</span></span><span class="line"><span class="cl">    <span class="err">111</span><span class="nl">d:</span>       <span class="err">89</span> <span class="err">7</span><span class="nf">d</span> <span class="no">ec</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x14</span><span class="p">],</span><span class="no">edi</span>
</span></span><span class="line"><span class="cl">    <span class="err">1120:</span>       <span class="err">89</span> <span class="err">75</span> <span class="nf">e8</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x18</span><span class="p">],</span><span class="no">esi</span>
</span></span><span class="line"><span class="cl">    <span class="err">1123:</span>       <span class="err">89</span> <span class="err">55</span> <span class="nf">e4</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x1c</span><span class="p">],</span><span class="no">edx</span>
</span></span><span class="line"><span class="cl">    <span class="err">1126:</span>       <span class="err">89</span> <span class="err">4</span><span class="nf">d</span> <span class="no">e0</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x20</span><span class="p">],</span><span class="no">ecx</span>
</span></span><span class="line"><span class="cl">    <span class="err">1129:</span>       <span class="err">44</span> <span class="err">89</span> <span class="err">45</span> <span class="nf">dc</span>             <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x24</span><span class="p">],</span><span class="no">r8d</span>
</span></span><span class="line"><span class="cl">    <span class="err">112</span><span class="nl">d:</span>       <span class="err">44</span> <span class="err">89</span> <span class="err">4</span><span class="nf">d</span> <span class="no">d8</span>             <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x28</span><span class="p">],</span><span class="no">r9d</span>
</span></span><span class="line"><span class="cl">    <span class="err">1131:</span>       <span class="nf">c7</span> <span class="mi">45</span> <span class="no">f8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>    <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x8</span><span class="p">],</span><span class="mi">0x0</span>
</span></span><span class="line"><span class="cl">    <span class="err">1138:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">55</span> <span class="no">ec</span>                <span class="no">mov</span>    <span class="no">edx</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x14</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">113</span><span class="nl">b:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e8</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x18</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">113</span><span class="nl">e:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">1140:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e4</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x1c</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1143:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">1145:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e0</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1148:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">a:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">dc</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">d:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">f:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">d8</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1152:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">1154:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="mi">10</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0x10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1157:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">1159:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="mi">18</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0x18</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">115</span><span class="nl">c:</span>       <span class="err">01</span> <span class="nf">d0</span>                   <span class="no">add</span>    <span class="no">eax</span><span class="p">,</span><span class="no">edx</span>
</span></span><span class="line"><span class="cl">    <span class="err">115</span><span class="nl">e:</span>       <span class="err">89</span> <span class="err">45</span> <span class="nf">fc</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">1161:</span>       <span class="nf">c6</span> <span class="mi">45</span> <span class="no">f7</span> <span class="mi">41</span>             <span class="no">mov</span>    <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x9</span><span class="p">],</span><span class="mi">0x41</span>
</span></span><span class="line"><span class="cl">    <span class="err">1165:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">fc</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1168:</span>       <span class="err">5</span><span class="nf">d</span>                      <span class="no">pop</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">1169:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p>This is the biggest function we have seen so far&hellip; We already know the <em>prologue</em> that covers the first 2 instructions of this assembly code. Let&rsquo;s read and try to understand further instructions. Before starting that, let&rsquo;s see how our stack looks like after this function&rsquo;s prologue.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 672 361"
      >
      <g transform='translate(8,16)'>
<path d='M 440,160 L 440,176' fill='none' stroke='currentColor'></path>
<path d='M 440,176 L 440,192' fill='none' stroke='currentColor'></path>
<circle cx='168' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='168' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='184' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='200' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='216' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='48' y='260' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='260' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='228' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='228' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='176' y='260' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='176' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='184' y='228' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='184' y='260' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='184' y='292' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='208' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='408' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='416' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='432' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='432' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='440' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='180' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='180' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='472' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='480' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='568' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='608' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='640' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='648' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='656' y='292' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>It is a good idea to visualize how the stack will look after this function has been loaded and all the required memory is allocated to it.</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 848 665"
      >
      <g transform='translate(8,16)'>
<path d='M 520,160 L 520,176' fill='none' stroke='currentColor'></path>
<path d='M 520,176 L 520,192' fill='none' stroke='currentColor'></path>
<path d='M 528,464 L 528,480' fill='none' stroke='currentColor'></path>
<path d='M 528,480 L 528,496' fill='none' stroke='currentColor'></path>
<path d='M 528,496 L 528,512' fill='none' stroke='currentColor'></path>
<path d='M 528,512 L 528,528' fill='none' stroke='currentColor'></path>
<path d='M 528,528 L 528,544' fill='none' stroke='currentColor'></path>
<path d='M 528,544 L 528,560' fill='none' stroke='currentColor'></path>
<circle cx='248' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='248' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='264' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='264' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='280' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='280' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='296' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='296' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='0' y='644' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='8' y='644' fill='currentColor' style='font-size:1em'>O</text>
<text text-anchor='middle' x='16' y='644' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='32' y='644' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>I</text>
<text text-anchor='middle' x='40' y='644' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>G</text>
<text text-anchor='middle' x='48' y='644' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>H</text>
<text text-anchor='middle' x='56' y='644' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='128' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='388' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='452' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='128' y='564' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='324' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='356' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='388' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='452' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='564' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='144' y='324' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='388' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='144' y='564' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='160' y='324' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='160' y='388' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='160' y='452' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='160' y='564' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='176' y='324' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='388' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='452' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='324' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='184' y='356' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='184' y='388' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='184' y='452' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='184' y='564' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='192' y='324' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='388' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='452' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='192' y='564' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='200' y='324' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='200' y='388' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='200' y='452' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='564' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='224' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='228' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='228' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='260' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='228' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='264' y='260' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='288' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='292' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='376' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='440' y='292' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='448' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='456' y='292' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='292' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='488' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='488' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='580' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='292' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='504' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='580' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='580' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='148' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='580' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='528' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='528' y='580' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='536' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='180' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='544' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='180' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='552' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='516' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='560' y='180' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='516' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='568' y='180' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='568' y='516' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='576' y='516' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='584' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='584' y='516' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='592' y='292' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='600' y='292' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='600' y='516' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='608' y='516' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='616' y='516' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='624' y='516' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='632' y='516' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='640' y='516' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='648' y='516' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='656' y='516' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='664' y='516' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='680' y='516' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='688' y='516' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='696' y='516' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='712' y='516' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='720' y='516' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='728' y='516' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='736' y='516' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='744' y='516' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='752' y='516' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='768' y='516' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='776' y='516' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='784' y='516' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='792' y='516' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='800' y='516' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='808' y='516' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='816' y='516' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='824' y='516' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='832' y='516' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<p>Now we can understand easily which variables are stored where on the stack. The previously passed positional arguments are loaded to stack after the local variables.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">111</span><span class="nl">d:</span>       <span class="err">89</span> <span class="err">7</span><span class="nf">d</span> <span class="no">ec</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x14</span><span class="p">],</span><span class="no">edi</span>         <span class="c1">; 0x1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">1120:</span>       <span class="err">89</span> <span class="err">75</span> <span class="nf">e8</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x18</span><span class="p">],</span><span class="no">esi</span>         <span class="c1">; 0x2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">1123:</span>       <span class="err">89</span> <span class="err">55</span> <span class="nf">e4</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x1c</span><span class="p">],</span><span class="no">edx</span>         <span class="c1">; 0x3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">1126:</span>       <span class="err">89</span> <span class="err">4</span><span class="nf">d</span> <span class="no">e0</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x20</span><span class="p">],</span><span class="no">ecx</span>         <span class="c1">; 0x4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">1129:</span>       <span class="err">44</span> <span class="err">89</span> <span class="err">45</span> <span class="nf">dc</span>             <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x24</span><span class="p">],</span><span class="no">r8d</span>         <span class="c1">; 0x5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">112</span><span class="nl">d:</span>       <span class="err">44</span> <span class="err">89</span> <span class="err">4</span><span class="nf">d</span> <span class="no">d8</span>             <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x28</span><span class="p">],</span><span class="no">r9d</span>         <span class="c1">; 0x6
</span></span></span></code></pre></div><p>These locations are in continous order with 4-bytes of memory space for each integer. This is the optimization done by <code>gcc</code> because it knows what will be the size of the passed arguments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">1131:</span>       <span class="nf">c7</span> <span class="mi">45</span> <span class="no">f8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>    <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x8</span><span class="p">],</span><span class="mi">0x0</span>
</span></span></code></pre></div><p>Then, <code>0x0</code> is stored to <code>rbp-0x8</code>. This will be one of our local variables. Then it adds all the passed arguments and save that to another local variable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">    <span class="err">1138:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">55</span> <span class="no">ec</span>                <span class="no">mov</span>    <span class="no">edx</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x14</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">113</span><span class="nl">b:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e8</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x18</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">113</span><span class="nl">e:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = 0x1 + 0x2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">1140:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e4</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x1c</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1143:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = var_edx + 0x3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">1145:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">e0</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1148:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = var_edx + 0x4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">a:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">dc</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">d:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = var_edx + 0x5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">114</span><span class="nl">f:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">d8</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1152:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = var_edx + 0x6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">1154:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="mi">10</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0x10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">1157:</span>       <span class="err">01</span> <span class="nf">c2</span>                   <span class="no">add</span>    <span class="no">edx</span><span class="p">,</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_edx = var_edx + 0x7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">1159:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="mi">18</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">0x18</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="err">115</span><span class="nl">c:</span>       <span class="err">01</span> <span class="nf">d0</span>                   <span class="no">add</span>    <span class="no">eax</span><span class="p">,</span><span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="c1">; var_eax = var_edx + 0x8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="err">115</span><span class="nl">e:</span>       <span class="err">89</span> <span class="err">45</span> <span class="nf">fc</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="c1">; int sum = var_eax
</span></span></span></code></pre></div><p>Once all the arguments are added it stores that to another local variable. Another point to note here is that the first 6 arguments were stored to stack from general purpose registers and the rest 2 arguments (that were already on stack) were directly referenced from the stack&hellip; These values were added to stack before the previous function return value so they are referenced by <code>rbp+0x10</code> and <code>rbp+18</code>.</p>
<p>Visually this part of the stack will look something like this&hellip;</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 496 169"
      >
      <g transform='translate(8,16)'>
<text text-anchor='middle' x='0' y='52' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='0' y='84' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='0' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='8' y='52' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='8' y='84' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='32' y='52' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='32' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='32' y='116' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='32' y='148' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='84' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='72' y='52' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='72' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='72' y='116' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='104' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='128' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='128' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='144' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='400' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='472' y='132' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='480' y='132' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>Now comes the third local variable, <code>char ch='A'</code>&hellip; This is the next instruction in our disassembly</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">  <span class="err">1161:</span>       <span class="nf">c6</span> <span class="mi">45</span> <span class="no">f7</span> <span class="mi">41</span>             <span class="no">mov</span>    <span class="no">BYTE</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x9</span><span class="p">],</span><span class="mi">0x41</span>   <span class="c1">; 0x41 = 65 = A
</span></span></span></code></pre></div><p>Now we can take a look again to the stack and understand what memory locations are for what purposes&hellip;</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 920 681"
      >
      <g transform='translate(8,16)'>
<path d='M 592,176 L 592,192' fill='none' stroke='currentColor'></path>
<path d='M 592,192 L 592,208' fill='none' stroke='currentColor'></path>
<path d='M 600,480 L 600,496' fill='none' stroke='currentColor'></path>
<path d='M 600,496 L 600,512' fill='none' stroke='currentColor'></path>
<path d='M 600,512 L 600,528' fill='none' stroke='currentColor'></path>
<path d='M 600,528 L 600,544' fill='none' stroke='currentColor'></path>
<path d='M 600,544 L 600,560' fill='none' stroke='currentColor'></path>
<path d='M 600,560 L 600,576' fill='none' stroke='currentColor'></path>
<path d='M 600,576 L 600,592' fill='none' stroke='currentColor'></path>
<path d='M 600,592 L 600,608' fill='none' stroke='currentColor'></path>
<circle cx='320' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='320' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='336' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='336' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='352' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='352' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='368' cy='64' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='368' cy='96' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='40' y='372' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='48' y='340' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='48' y='372' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='48' y='404' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='56' y='340' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='56' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='56' y='404' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='64' y='340' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='372' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='64' y='404' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='72' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='72' y='404' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='80' y='340' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='80' y='372' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='80' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='340' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='88' y='372' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='404' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='660' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='96' y='660' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='104' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='104' y='340' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='104' y='372' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='104' y='404' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='104' y='660' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='112' y='36' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='112' y='340' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='112' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='112' y='404' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='36' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='120' y='340' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='372' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='404' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='120' y='660' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='128' y='36' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='128' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='128' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='128' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='128' y='660' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='136' y='340' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='136' y='372' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='136' y='404' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='136' y='660' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='144' y='660' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='152' y='340' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='152' y='372' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='152' y='404' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='340' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='176' y='340' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='176' y='372' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='176' y='404' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='192' y='340' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='372' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='404' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='468' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='628' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='340' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='200' y='372' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='200' y='404' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='200' y='468' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='200' y='628' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='208' y='340' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='372' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='468' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='208' y='628' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='224' y='340' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='224' y='372' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='224' y='404' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='224' y='468' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='224' y='628' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='240' y='340' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='372' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='404' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='468' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='628' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='340' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='248' y='372' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='248' y='404' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='248' y='468' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='248' y='628' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='256' y='340' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='372' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='404' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='468' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='256' y='628' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='264' y='340' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='372' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='264' y='404' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='264' y='468' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='628' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='296' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='276' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='320' y='468' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='500' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='532' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='596' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='628' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='328' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='276' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='340' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='328' y='372' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='328' y='404' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='328' y='468' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='500' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='532' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='564' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='596' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='328' y='628' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='336' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='336' y='276' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='340' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='336' y='468' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='336' y='500' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='336' y='532' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='336' y='564' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='336' y='596' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='336' y='628' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='344' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='344' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='352' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='360' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='376' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='384' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='384' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='384' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='408' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='416' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='308' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='432' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='440' y='308' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='448' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='448' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='456' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='132' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='464' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='472' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='472' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='480' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='164' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='480' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='488' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='488' y='308' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='496' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='308' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='504' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='504' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='512' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='512' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='512' y='308' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='520' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='520' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='520' y='308' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='528' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='528' y='132' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='528' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='536' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='536' y='308' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='544' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='36' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='36' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='560' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='308' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='324' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='340' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='356' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='372' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='388' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='404' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='420' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='436' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='452' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='468' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='484' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='500' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='516' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='532' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='548' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='564' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='580' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='596' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='612' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='560' y='628' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='568' y='164' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='568' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='568' y='468' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='568' y='628' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='576' y='164' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='576' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='576' y='324' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='576' y='468' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='576' y='628' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='584' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='584' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='468' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='584' y='628' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='592' y='164' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='592' y='228' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='592' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='468' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='592' y='628' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='600' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='600' y='468' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='600' y='628' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='608' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='616' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='196' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='624' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='624' y='532' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='632' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='632' y='324' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='632' y='532' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='640' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='640' y='532' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='648' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='656' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='656' y='532' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='664' y='324' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='672' y='324' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='672' y='532' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='680' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='688' y='532' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='696' y='532' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='704' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='712' y='532' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='720' y='532' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='728' y='532' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='736' y='532' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='752' y='532' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='760' y='532' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='768' y='532' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='784' y='532' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='792' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='800' y='532' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='808' y='532' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='816' y='532' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='824' y='532' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='840' y='532' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='848' y='532' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='856' y='532' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='864' y='532' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='872' y='532' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='880' y='532' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='888' y='532' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='896' y='532' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='904' y='532' fill='currentColor' style='font-size:1em'>s</text>
</g>

    </svg>
  
</div>
<p>Then we set <code>eax</code> to the value we want to return back to the caller function <code>func1()</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">    <span class="err">1165:</span>       <span class="err">8</span><span class="nf">b</span> <span class="mi">45</span> <span class="no">fc</span>                <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">]</span>
</span></span></code></pre></div><p>And finally, we pop the <code>rbp</code> from stack and move to the instruction in the previous function from where we left the execution. This is called <a href="https://en.wikipedia.org/wiki/Function_prologue_and_epilogue#Epilogue"><strong>Epilogue</strong></a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">    <span class="err">1168:</span>       <span class="err">5</span><span class="nf">d</span>                      <span class="no">pop</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">1169:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p>After this, the stack will look something like as shown below:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 608 313"
      >
      <g transform='translate(8,16)'>
<path d='M 544,144 L 544,160' fill='none' stroke='currentColor'></path>
<path d='M 544,160 L 544,176' fill='none' stroke='currentColor'></path>
<path d='M 544,176 L 544,192' fill='none' stroke='currentColor'></path>
<circle cx='160' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='160' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='176' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='192' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='192' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='208' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='24' y='260' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='32' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='32' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='40' y='260' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='56' y='260' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='64' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='72' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='72' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='136' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='136' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='160' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='160' y='228' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='160' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='228' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='168' y='260' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='176' y='228' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='176' y='260' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='368' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='400' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='180' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='196' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='212' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='228' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='244' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='260' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='276' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='408' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='416' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='424' y='260' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='432' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='432' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='440' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='448' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='456' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='464' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='148' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='472' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='472' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='480' y='260' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='496' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='496' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='148' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='504' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='504' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='512' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='512' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='520' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='260' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='528' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='536' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='544' y='212' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='568' y='180' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='576' y='180' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='584' y='180' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='592' y='180' fill='currentColor' style='font-size:1em'>0</text>
</g>

    </svg>
  
</div>
<p>And in disassembly code, Instruction pointer will be pointing to the next instruction after <code>func2()</code> function call.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">000000000000116</span><span class="nf">a</span> <span class="err">&lt;</span><span class="no">func1</span><span class="err">&gt;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">a:</span>       <span class="err">55</span>                      <span class="nf">push</span>   <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">b:</span>       <span class="err">48</span> <span class="err">89</span> <span class="nf">e5</span>                <span class="no">mov</span>    <span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span>
</span></span><span class="line"><span class="cl">    <span class="err">116</span><span class="nl">e:</span>       <span class="err">48</span> <span class="err">83</span> <span class="nf">ec</span> <span class="mi">10</span>             <span class="no">sub</span>    <span class="no">rsp</span><span class="p">,</span><span class="mi">0x10</span>
</span></span><span class="line"><span class="cl">    <span class="err">1172:</span>       <span class="err">6</span><span class="nf">a</span> <span class="mi">08</span>                   <span class="no">push</span>   <span class="mi">0x8</span>
</span></span><span class="line"><span class="cl">    <span class="err">1174:</span>       <span class="err">6</span><span class="nf">a</span> <span class="mi">07</span>                   <span class="no">push</span>   <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl">    <span class="err">1176:</span>       <span class="err">41</span> <span class="nf">b9</span> <span class="mi">06</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       <span class="no">mov</span>    <span class="no">r9d</span><span class="p">,</span><span class="mi">0x6</span>
</span></span><span class="line"><span class="cl">    <span class="err">117</span><span class="nl">c:</span>       <span class="err">41</span> <span class="nf">b8</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       <span class="no">mov</span>    <span class="no">r8d</span><span class="p">,</span><span class="mi">0x5</span>
</span></span><span class="line"><span class="cl">    <span class="err">1182:</span>       <span class="nf">b9</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">ecx</span><span class="p">,</span><span class="mi">0x4</span>
</span></span><span class="line"><span class="cl">    <span class="err">1187:</span>       <span class="nf">ba</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">edx</span><span class="p">,</span><span class="mi">0x3</span>
</span></span><span class="line"><span class="cl">    <span class="err">118</span><span class="nl">c:</span>       <span class="nf">be</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">esi</span><span class="p">,</span><span class="mi">0x2</span>
</span></span><span class="line"><span class="cl">    <span class="err">1191:</span>       <span class="nf">bf</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">edi</span><span class="p">,</span><span class="mi">0x1</span>
</span></span><span class="line"><span class="cl">    <span class="err">1196:</span>       <span class="nf">e8</span> <span class="mi">7</span><span class="no">e</span> <span class="no">ff</span> <span class="no">ff</span> <span class="no">ff</span>          <span class="no">call</span>   <span class="mh">1119</span> <span class="p">&lt;</span><span class="no">func2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="err">119</span><span class="nl">b:</span>       <span class="err">48</span> <span class="err">83</span> <span class="nf">c4</span> <span class="mi">10</span>             <span class="no">add</span>    <span class="no">rsp</span><span class="p">,</span><span class="mi">0x10</span>                         <span class="err">&lt;</span><span class="p">---</span> <span class="no">instruction</span> <span class="no">pointer</span>
</span></span><span class="line"><span class="cl">    <span class="err">119</span><span class="nl">f:</span>       <span class="err">89</span> <span class="err">45</span> <span class="nf">fc</span>                <span class="no">mov</span>    <span class="no">DWORD</span> <span class="no">PTR</span> <span class="p">[</span><span class="no">rbp-0x4</span><span class="p">],</span><span class="no">eax</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a2:</span>       <span class="err">90</span>                      <span class="nf">nop</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a3:</span>       <span class="nf">c9</span>                      <span class="no">leave</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a4:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p>This will then increase the stack pointer by <code>0x10</code> and save return value to a local variable at <code>rbp-0x4</code> location&hellip;and then exit. This is <em>epilogue</em> for <code>func1()</code> function. And after <code>leave</code> and <code>ret</code> instructions the stack will look like as shown below:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 648 169"
      >
      <g transform='translate(8,16)'>
<circle cx='256' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='256' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='272' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='272' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='288' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='288' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='304' cy='48' r='6' stroke='currentColor' fill='currentColor'></circle>
<circle cx='304' cy='80' r='6' stroke='currentColor' fill='currentColor'></circle>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='40' y='148' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='72' y='148' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='80' y='20' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='80' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='88' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>┌</text>
<text text-anchor='middle' x='232' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='232' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='312' y='116' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='320' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='328' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='328' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='336' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='344' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='352' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='360' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='408' y='116' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='416' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='424' y='116' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='432' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='448' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='456' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='464' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='472' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='480' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='488' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='496' y='20' fill='currentColor' style='font-size:1em'>┐</text>
<text text-anchor='middle' x='496' y='36' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='52' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='84' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='100' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='116' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>│</text>
<text text-anchor='middle' x='536' y='20' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='536' y='132' fill='currentColor' style='font-size:1em'>◄</text>
<text text-anchor='middle' x='544' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='544' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='552' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='568' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='576' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='20' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='592' y='132' fill='currentColor' style='font-size:1em'>─</text>
<text text-anchor='middle' x='616' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='616' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='624' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='624' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='632' y='20' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>p</text>
</g>

    </svg>
  
</div>
<p>And instruction pointer will be pointing to the next instruction in <code>main()</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000000011</span><span class="nf">a5</span> <span class="err">&lt;</span><span class="no">main</span><span class="err">&gt;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a5:</span>       <span class="err">55</span>                      <span class="nf">push</span>   <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a6:</span>       <span class="err">48</span> <span class="err">89</span> <span class="nf">e5</span>                <span class="no">mov</span>    <span class="no">rbp</span><span class="p">,</span><span class="no">rsp</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">a9:</span>       <span class="nf">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="mi">0x0</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">ae:</span>       <span class="nf">e8</span> <span class="no">b7</span> <span class="no">ff</span> <span class="no">ff</span> <span class="no">ff</span>          <span class="no">call</span>   <span class="mh">116a</span> <span class="p">&lt;</span><span class="no">func1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">b3:</span>       <span class="nf">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>          <span class="no">mov</span>    <span class="no">eax</span><span class="p">,</span><span class="mi">0x0</span>           <span class="err">&lt;</span><span class="p">---</span> <span class="no">instruction</span> <span class="no">pointer</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">b8:</span>       <span class="err">5</span><span class="nf">d</span>                      <span class="no">pop</span>    <span class="no">rbp</span>
</span></span><span class="line"><span class="cl">    <span class="err">11</span><span class="nl">b9:</span>       <span class="nf">c3</span>                      <span class="no">ret</span>
</span></span></code></pre></div><p>This instruction will simply set the return value for this function as <code>0x0</code> and then will pop <code>rbp</code> from stack. This will collapse the <code>main()</code> function&rsquo;s stack frame and in the next instruction it&rsquo;ll return the control to whatever function called the <code>main()</code> function.</p>
<p><img loading="lazy" src="https://media.giphy.com/media/giVvDFs5deYrKCKpD4/giphy.gif#center" alt=""  />
</p>
<h2 id="some-most-common-instructions">Some most common instructions</h2>
<p>Most of the times, you&rsquo;ll see similar instructions being executed like <code>push</code>, <code>pop</code>, <code>ret</code>, <code>mov</code>, <code>add</code>, <code>sub</code>, etc.. Let&rsquo;s understand some of those which we will be seeing most of the times.</p>
<ol>
<li>
<p><code>push</code> : This simply adds the value to the top of the stack and then decrements the stack pointer. (Decrementing stack pointer means growing the stack, since stack is upside down and grows towards lower addresses)</p>
</li>
<li>
<p><code>pop</code> : Opposite to <strong>push</strong> instruction, this removes the top of the stack and increments the stack pointer.</p>
</li>
<li>
<p><code>mov</code> : This is used to move some values from one location to another. This instruction is quite versatile and can move the values from/to register, stack memory locations, etc&hellip; For example,</p>
</li>
</ol>
<ul>
<li>
<p><code>mov rax, 0x10</code> will move <code>0x10</code> constant value to <code>rax</code> register.</p>
</li>
<li>
<p><code>mov rdi, rax</code> will move the <code>rax</code> register value to <code>rdi</code> register.</p>
</li>
<li>
<p><code>mov rdi, [rax]</code> will move the value pointer by <code>rax</code> to <code>rdi</code> register. You can think of this as dereference pointer in C.</p>
</li>
<li>
<p><code>mov [rbp-0x8], rax</code> will move the value from <code>rax</code> register to memory location poined by <code>rbp-0x08</code>.</p>
</li>
</ul>
<ol start="4">
<li><code>add</code> and <code>sub</code> : adds and substracts one value from another value. For example,</li>
</ol>
<ul>
<li><code>add rax, 0x10</code> will add <code>0x10</code> to value at <code>rax</code> register. And the result will be stored in <code>rax</code> register.</li>
<li><code>sub rax, 0x10</code> wil subtract <code>0x10</code> from value at <code>rax</code> register. And the result will be stored in <code>rax</code> register.</li>
</ul>
<ol start="5">
<li>
<p><code>lea</code> : this Loads Effective Address (lea) to any destination. This is used to copy the address of the memory location to a register/stack. For example, <code>lea eax, rbp-0x8</code> will load the address of <code>rbp-0x8</code> into <code>eax</code> register.</p>
</li>
<li>
<p><code>cmp</code> : This (compare instruction) is equivalent to <strong>sub</strong> instruction, just instead of saving the result into the first argument, it updates a flag. If the value is less then 0 then the flag is set to 1 else 0. For example, <code>cmp 1, 3</code> will result in <code>-2</code> and this will set the flag to be 1.</p>
</li>
<li>
<p><code>jmp</code> : Compare instructions are usually followed by jump instructions. This will check the above set flag and jump to the address specified in the argument accordingly. There are many types of jump instructions like jump equal (<code>je</code>), jump not equal (<code>je</code>), jump greater (<code>jg</code>), jump less (<code>jl</code>), etc.. This instruction actually manipulates the instruction pointer to make the jump. If the condation matches then it&rsquo;ll take the jump by setting the instruction pointer to the memory location from the argument, else it&rsquo;ll change the instruction pointer to point to the next statement.</p>
</li>
<li>
<p><code>call</code> : This instruction calls a function. This is equivalent to <code>push eip</code> (save the next instruction on stack) followed by <code>jmp func</code>.</p>
</li>
<li>
<p><code>leave/ret</code> : This is called at the end of every function. This destroys the current stack frame by incrementing the stack pointer or by moving the stack pointer(<code>rsp</code>) to the same location pointer by base pointer (<code>rbp</code>) and then poping the base pointer. This will make the previous return address the top of the stack which will be used by <code>ret</code> to return to that address by setting <code>eip</code> to that address and eventually pop the return address from the stack.</p>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>You&rsquo;re all set! This all could be a lot to take in all at once. But atleast you now have a rudimentary grasp of how a C code is compiled and how everything functions at the low level. I hope you now have enough information and self-assurance to begin your adventures into reverse engineering.</p>
<p>Have fun!! ✌️</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
